{"config":{"lang":["en","zh"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Code Converter Phase 1 - Technical Design Document","text":"<p>\u529f\u80fd: Booking Code Converter (Code2Code) \u7248\u672c: Phase 1 \u6700\u5f8c\u66f4\u65b0: 2025-01-06</p>"},{"location":"#_1","title":"\ud83c\udfaf \u529f\u80fd\u6982\u8ff0","text":"<p>Code Converter \u8b93\u7528\u6236\u53ef\u4ee5\u5c07\u7af6\u54c1\u7684 Booking Code \u8f49\u63db\u70ba Fcom \u7684 Share Code\uff0c\u4e26\u76f4\u63a5\u8f09\u5165\u5230 Betslip \u9032\u884c\u6295\u6ce8\u3002</p>"},{"location":"#_2","title":"\u6838\u5fc3\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    actor User\n    participant App\n    participant BE as Backend\n\n    User-&gt;&gt;App: \u8f38\u5165\u7af6\u54c1 Booking Code\n    App-&gt;&gt;BE: POST /orders/converter/code\n    BE--&gt;&gt;App: \u8fd4\u56de Share Code\n    App-&gt;&gt;BE: GET /orders/share/{shareCode}\n    BE--&gt;&gt;App: \u8fd4\u56de Betslip \u8cc7\u6599\n    App--&gt;&gt;User: \u986f\u793a Betslip</code></pre>"},{"location":"#_3","title":"\ud83d\udcda \u6587\u4ef6\u5c0e\u89bd","text":""},{"location":"#_4","title":"\u5feb\u901f\u958b\u59cb","text":"\u7ae0\u7bc0 \u8aaa\u660e Overview \u529f\u80fd\u6982\u8ff0\u3001\u5fa9\u7528\u7b56\u7565\u3001\u5be6\u4f5c\u512a\u5148\u7d1a Sprint Plan 5 \u5929\u958b\u767c\u8a08\u5283\u8207 Jira Tickets"},{"location":"#_5","title":"\u67b6\u69cb\u8a2d\u8a08","text":"\u7ae0\u7bc0 \u8aaa\u660e \u5b8c\u6574\u6d41\u7a0b\u5e8f\u5217\u5716 \u7aef\u5230\u7aef\u7684\u670d\u52d9\u6d41\u7a0b Clean Architecture \u5206\u5c64\u67b6\u69cb\u5716 \u6a21\u7d44\u8077\u8cac \u5404\u6a21\u7d44\u7684\u8077\u8cac\u5b9a\u7fa9"},{"location":"#view-layer","title":"View Layer","text":"\u7ae0\u7bc0 \u8aaa\u660e View \u5be6\u4f5c SwiftUI View \u5be6\u4f5c\u7d30\u7bc0 \u8a2d\u8a08\u898f\u683c Figma \u8a2d\u8a08\u898f\u683c\uff08\u984f\u8272\u3001\u5b57\u578b\u3001\u9593\u8ddd\uff09 State \u2194 Figma \u5c0d\u7167 State \u8207 Figma Node \u5c0d\u7167\u8868"},{"location":"#domain-layer","title":"Domain Layer","text":"\u7ae0\u7bc0 \u8aaa\u660e Domain Model Domain \u6a21\u578b\u5b9a\u7fa9 TCA State &amp; Action TCA Feature \u5b9a\u7fa9 UseCase I/O UseCase \u8f38\u5165\u8f38\u51fa\u6a21\u578b"},{"location":"#data-layer","title":"Data Layer","text":"\u7ae0\u7bc0 \u8aaa\u660e API \u898f\u683c API Endpoints \u898f\u683c DTO Mapping DTO \u8207 Domain Model \u6620\u5c04"},{"location":"#_6","title":"\u5176\u4ed6","text":"\u7ae0\u7bc0 \u8aaa\u660e Error Handling \u932f\u8aa4\u8655\u7406\u7b56\u7565 Test Scenarios \u6e2c\u8a66\u60c5\u5883\u8207\u7bc4\u4f8b Risks &amp; Questions \u98a8\u96aa\u8a55\u4f30\u8207\u5f85\u78ba\u8a8d\u4e8b\u9805"},{"location":"#_7","title":"\ud83c\udfd7\ufe0f \u67b6\u69cb\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        UI Layer                             \u2502\n\u2502  LoadCodeWidgetView \u2502 BookieSelectorSheet \u2502 PartialErrorToast \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Domain Layer (TCA)                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  LoadCodeWidget.Feature (\u64f4\u5c55\u81ea LoadBookingCodeSection) \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                 \u2502                     \u2502                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 LoadProviderConfigUseCase \u2502  \u2502 ConvertBookingCodeUseCase \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                  \u2502                    \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Data &amp; Infrastructure                      \u2502\n\u2502  CodeConverterRepository \u2502 CodeConverterClient \u2502 API        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#_8","title":"\ud83d\udcc5 \u958b\u767c\u6642\u7a0b","text":"Phase \u5167\u5bb9 \u6642\u7a0b Phase 1.1 \u64f4\u5c55\u73fe\u6709\u5143\u4ef6 Day 1-2 Phase 1.2 \u65b0\u589e Data Layer Day 2-3 Phase 1.3 \u66ff\u63db\u5165\u53e3\u9ede Day 4 Phase 1.4 \u6e05\u7406 &amp; \u6e2c\u8a66 Day 5"},{"location":"#_9","title":"\ud83d\udd17 \u76f8\u95dc\u9023\u7d50","text":"<ul> <li>Epic: FOOTBALL-9161</li> <li>Figma: Code-Converter</li> <li>PRD: \u53c3\u898b <code>/PRDs/01_PRD/01_06/</code></li> </ul>"},{"location":"00_Overview/","title":"00_Overview","text":"<p>\u672c\u7ae0\u7bc0\u8aaa\u660e Code Converter Phase 1 (Code2Code) \u529f\u80fd\u7684\u6574\u9ad4\u76ee\u6a19\u3001\u7bc4\u570d\u8207\u50f9\u503c\u4e3b\u5f35\u3002</p>"},{"location":"00_Overview/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_overview.md \u529f\u80fd\u6982\u8ff0\u3001\u76ee\u6a19\u7528\u6236\u3001\u6838\u5fc3\u6d41\u7a0b\u3001\u8cc7\u6599\u4f86\u6e90"},{"location":"00_Overview/01_overview/","title":"Code Converter Phase 1 - TDD Overview","text":""},{"location":"00_Overview/01_overview/#_1","title":"\u529f\u80fd\u6982\u8ff0","text":"<p>Code Converter \u662f\u4e00\u500b\u8b93\u7528\u6236\u5c07\u5176\u4ed6\u535a\u5f69\u516c\u53f8\uff08Bookie\uff09\u7684 Booking Code \u8f49\u63db\u70ba Fcom Booking Code \u7684\u529f\u80fd\u3002Phase 1 \u5be6\u4f5c Code2Code \u8f49\u63db\uff0c\u652f\u63f4\u7528\u6236\u624b\u52d5\u8f38\u5165\u7af6\u722d\u5c0d\u624b\u7684 Booking Code \u4e26\u8f49\u63db\u3002</p>"},{"location":"00_Overview/01_overview/#_2","title":"\u6838\u5fc3\u9700\u6c42","text":"\u9700\u6c42 \u8aaa\u660e \u8f38\u5165 \u7528\u6236\u9078\u64c7 Bookie + \u8f38\u5165 Booking Code \u8f49\u63db \u8abf\u7528\u5f8c\u7aef API \u9032\u884c Code2Code \u8f49\u63db \u8f38\u51fa \u751f\u6210 Fcom ShareCode\uff0c\u5c0e\u822a\u81f3 Betslip \u932f\u8aa4\u8655\u7406 Code Not Found\u3001Partial Failure\u3001All Failed"},{"location":"00_Overview/01_overview/#_3","title":"\u5165\u53e3\u9ede","text":"\u4f4d\u7f6e \u73fe\u6709\u5be6\u4f5c \u66ff\u63db\u70ba \u9996\u9801 Widget <code>LoadBookingCodeSectionView</code> <code>LoadCodeWidgetView</code>\uff08\u539f\u5730\u64f4\u5c55\uff09 Code Center Load Code Tab <code>LoadCodeViewWrapper</code> \u2192 <code>LoadCodeViewController</code> (UIKit) <code>LoadCodeWidgetView</code> (SwiftUI) \u9996\u9801 Betslip (Empty) \u65e2\u6709\u7a7a\u72c0\u614b \u5d4c\u5165 <code>LoadCodeWidgetView</code>"},{"location":"00_Overview/01_overview/#_4","title":"\u5fa9\u7528\u7b56\u7565\uff08\u6838\u5fc3\u8a2d\u8a08\u6c7a\u7b56\uff09","text":""},{"location":"00_Overview/01_overview/#loadbookingcodesectionview","title":"\u6700\u5927\u5316\u5fa9\u7528 LoadBookingCodeSectionView","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u5fa9\u7528\u7b56\u7565                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2705 \u64f4\u5c55\u73fe\u6709 View/Feature \u7d50\u69cb                                       \u2502\n\u2502  \u2705 \u4fdd\u6301\u539f\u6709 API \u5411\u5f8c\u76f8\u5bb9                                            \u2502\n\u2502  \u2705 \u65b0\u529f\u80fd\u4ee5 optional flag (enableCodeConverter) \u63a7\u5236                \u2502\n\u2502  \u2705 \u5b50\u5143\u4ef6\u64f4\u5c55\u800c\u975e\u91cd\u5beb                                               \u2502\n\u2502  \u2705 \u6f38\u9032\u5f0f\u66ff\u63db LoadCodeViewController                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"00_Overview/01_overview/#_5","title":"\u5143\u4ef6\u5c0d\u7167\u8868","text":"\u73fe\u6709\u5143\u4ef6 \u64f4\u5c55\u70ba \u8b8a\u66f4\u985e\u578b <code>LoadBookingCodeSectionView</code> <code>LoadCodeWidgetView</code> \u64f4\u5c55 <code>CountryDropdownView</code> <code>BookieDropdownView</code> \u64f4\u5c55 <code>BookingCodeInputView</code> <code>BookingCodeInputView</code> \u64f4\u5c55\uff08\u589e\u52a0\u72c0\u614b\uff09 <code>LoadBookingCodeSection.Feature</code> <code>LoadCodeWidget.Feature</code> \u64f4\u5c55 - <code>BookieSelectorSheet</code> \u65b0\u589e (SwiftUI)"},{"location":"00_Overview/01_overview/#ui-6","title":"UI \u72c0\u614b\u5c0d\u7167\uff086 \u7a2e\u72c0\u614b\uff09","text":"\u72c0\u614b \u8f38\u5165\u6846\u908a\u6846 \u6e05\u9664\u6309\u9215 Load \u6309\u9215 \u63d0\u793a\u6587\u5b57 Default \u7121 \u96b1\u85cf \u7070\u8272\u7981\u7528 \u7121 Focus \u7da0\u8272 \u96b1\u85cf \u7070\u8272\u7981\u7528 \u7121 Typing \u7da0\u8272 \u986f\u793a \u2297 \u7da0\u8272\u555f\u7528 \u7121 Filled \u7121 \u986f\u793a \u2297 \u7da0\u8272\u555f\u7528 \u7121 Loading \u7121 \u96b1\u85cf Spinner \"Conversion may take up to 10 seconds...\" Error \u7d05\u8272 \u986f\u793a \u2297 \u7da0\u8272\u555f\u7528 \u7d05\u8272\u932f\u8aa4\u8a0a\u606f"},{"location":"00_Overview/01_overview/#_6","title":"\u6280\u8853\u67b6\u69cb","text":""},{"location":"00_Overview/01_overview/#clean-architecture","title":"Clean Architecture \u5206\u5c64","text":"<pre><code>UI Layer (SwiftUI)\n    \u2514\u2500\u2500 LoadCodeWidgetView, BookieSelectorSheet\n\nDomain Layer (TCA)\n    \u251c\u2500\u2500 Feature: LoadCodeWidget.Feature\n    \u2514\u2500\u2500 UseCase: LoadProviderConfigUseCase, ConvertBookingCodeUseCase\n\nDomain Model\n    \u2514\u2500\u2500 ProviderConfig, SelectedBookie, ConvertResult, WidgetInputState\n\nData &amp; Infrastructure Layer\n    \u251c\u2500\u2500 Repository: CodeConverterRepository\n    \u251c\u2500\u2500 Client: CodeConverterClient\n    \u2514\u2500\u2500 API: CodeConverterAPI\n</code></pre>"},{"location":"00_Overview/01_overview/#api-endpoints","title":"API Endpoints","text":"API \u7528\u9014 <code>GET /orders/converter/config/providerCountries</code> \u53d6\u5f97 Provider Config <code>POST /orders/converter/code</code> Code2Code \u8f49\u63db <code>GET /bookingCode/{shareCode}/liabilities</code> Liabilities \u6aa2\u67e5\uff08\u65e2\u6709\uff09"},{"location":"00_Overview/01_overview/#_7","title":"\u5be6\u4f5c\u512a\u5148\u7d1a","text":""},{"location":"00_Overview/01_overview/#phase-11","title":"Phase 1.1: \u64f4\u5c55\u73fe\u6709\u5143\u4ef6","text":"<ol> <li>\u64f4\u5c55 <code>LoadBookingCodeSection.State/Action/Feature</code></li> <li>\u64f4\u5c55 <code>BookingCodeInputView</code>\uff08\u589e\u52a0 6 \u7a2e\u72c0\u614b\uff09</li> <li>\u64f4\u5c55 <code>CountryDropdownView</code> \u2192 <code>BookieDropdownView</code></li> <li>\u65b0\u589e <code>BookieSelectorSheet</code> (SwiftUI)</li> </ol>"},{"location":"00_Overview/01_overview/#phase-12-data-layer","title":"Phase 1.2: \u65b0\u589e Data Layer","text":"<ol> <li>\u5b9a\u7fa9 Domain Models</li> <li>\u5be6\u4f5c <code>CodeConverterRepository</code></li> <li>\u5be6\u4f5c <code>CodeConverterClient</code></li> <li>\u5be6\u4f5c <code>LoadProviderConfigUseCase</code></li> <li>\u5be6\u4f5c <code>ConvertBookingCodeUseCase</code></li> </ol>"},{"location":"00_Overview/01_overview/#phase-13","title":"Phase 1.3: \u66ff\u63db\u5165\u53e3\u9ede","text":"<ol> <li>\u9996\u9801 Widget\uff1a\u8a2d\u7f6e <code>enableCodeConverter = true</code></li> <li>Code Center\uff1a\u7528 <code>LoadCodeWidgetView</code> \u66ff\u63db <code>LoadCodeViewWrapper</code></li> <li>Betslip Empty\uff1a\u5d4c\u5165 <code>LoadCodeWidgetView</code></li> </ol>"},{"location":"00_Overview/01_overview/#phase-14","title":"Phase 1.4: \u6e05\u7406","text":"<ol> <li>\u79fb\u9664 <code>LoadCodeViewController</code></li> <li>\u79fb\u9664 <code>LoadCodeViewController.xib</code></li> <li>\u79fb\u9664 <code>LoadCodeViewWrapper</code></li> </ol>"},{"location":"00_Overview/01_overview/#_8","title":"\u6e2c\u8a66\u7b56\u7565","text":"\u6e2c\u8a66\u985e\u578b \u7bc4\u570d \u512a\u5148\u7d1a Unit Test Domain Models, UseCases P0 TCA TestStore Feature State/Action P0 Integration Test API Client P1 UI Test \u95dc\u9375\u7528\u6236\u6d41\u7a0b P1"},{"location":"00_Overview/01_overview/#_9","title":"\u98a8\u96aa\u8207\u5f85\u78ba\u8a8d","text":"\u98a8\u96aa \u5f71\u97ff \u7de9\u89e3\u63aa\u65bd \u539f\u6709\u908f\u8f2f\u76f8\u5bb9\u6027 LoadCodeManager \u65e2\u6709\u547c\u53eb\u53ef\u80fd\u53d7\u5f71\u97ff \u4fdd\u6301 enableCodeConverter = false \u6642\u5b8c\u5168\u76f8\u5bb9 API \u56de\u50b3\u683c\u5f0f\u8b8a\u66f4 DTO \u6620\u5c04\u5931\u6557 \u8207\u5f8c\u7aef\u78ba\u8a8d\u5b8c\u6574 Response \u7d50\u69cb Betslip \u5c0e\u822a\u908f\u8f2f \u90e8\u5206\u5931\u6557\u6642\u7684 Betslip \u8f09\u5165 \u78ba\u8a8d shareCode \u662f\u5426\u53ea\u5305\u542b\u6210\u529f\u7684 selections \u6548\u80fd\uff08\u9577\u6642\u9593\u8f49\u63db\uff09 Loading \u72c0\u614b\u6700\u9577 10 \u79d2 \u986f\u793a\u63d0\u793a\u6587\u5b57\u63d0\u9192\u7528\u6236"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/","title":"01_Integrated Service-Level Sequence Diagram","text":"<p>\u672c\u7ae0\u7bc0\u5448\u73fe Code Converter Phase 1 \u7684\u6574\u5408\u5e8f\u5217\u5716\uff0c\u5c55\u793a\u5b8c\u6574\u7684 Code2Code \u8f49\u63db\u6d41\u7a0b\u3002</p>"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_full_integration_flow.md \u5b8c\u6574\u7684 Code2Code \u8f49\u63db\u6d41\u7a0b\uff08Service Level\uff09"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/","title":"Code2Code \u5b8c\u6574\u6574\u5408\u6d41\u7a0b","text":""},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#flow","title":"Flow \u8cc7\u8a0a","text":"\u6b04\u4f4d \u503c feature CodeConverter flow_id CC-ISSD-001 flow_type Full flow_name Code2Code \u5b8c\u6574\u6574\u5408\u6d41\u7a0b"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#_1","title":"\u6d41\u7a0b\u8aaa\u660e","text":"\u968e\u6bb5 \u8aaa\u660e 1. \u521d\u59cb\u5316\u968e\u6bb5 1. Widget \u986f\u793a\u9810\u8a2d\u72c0\u614b2. \u4f7f\u7528\u8005\u9ede\u64ca Bookie Dropdown3. \u7cfb\u7d71\u53d6\u5f97 Provider Config 2. \u9078\u64c7 Bookie 1. \u958b\u555f Bookie Selector Sheet2. \u9078\u64c7 Provider \u548c Country3. \u95dc\u9589 Sheet \u4e26\u66f4\u65b0 Widget 3. \u8f38\u5165 Booking Code 1. Focus \u8f38\u5165\u68462. \u8f38\u5165 Booking Code3. \u555f\u7528 Load \u6309\u9215 4. \u8f49\u63db\u6d41\u7a0b 1. \u547c\u53eb Convert API2. \u6aa2\u67e5 Liabilities3. \u53d6\u5f97 Betslip Data4. \u8f09\u5165 Betslip"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#_2","title":"\u6574\u5408\u5e8f\u5217\u5716","text":"<pre><code>sequenceDiagram\n    actor User\n\n    box rgb(207,232,255) UI Layer\n        participant Widget as LoadCodeWidget\n        participant Sheet as BookieSelectorSheet\n        participant Betslip as Betslip\n    end\n\n    box rgb(255,250,205) Domain Layer\n        participant Feature as LoadCodeWidgetFeature\n        participant ConvertUC as ConvertBookingCodeUseCase\n        participant ConfigUC as LoadProviderConfigUseCase\n    end\n\n    box rgb(240,240,240) Data and Infrastructure Layer\n        participant Repo as CodeConverterRepository\n        participant Client as CodeConverterClient\n        participant API as CodeConverterAPI\n        participant BetslipRepo as BetslipRepository\n        participant BetslipClient as BetslipClient\n        participant BetslipAPI as BetslipAPI\n    end\n\n    Note over User,Widget: \u4f7f\u7528\u8005\u9032\u5165\u9996\u9801\u6216 Code Center\n\n    %% 1. \u521d\u59cb\u5316 - \u53d6\u5f97 Provider Config\n    User-&gt;&gt;Widget: \u9ede\u64ca Bookie Dropdown\n    Widget-&gt;&gt;Feature: .bookieDropdownTapped\n    Feature-&gt;&gt;ConfigUC: execute()\n    ConfigUC-&gt;&gt;Repo: getProviderCountryConfig()\n    Repo-&gt;&gt;Client: fetchProviderCountries()\n    Client-&gt;&gt;API: GET /orders/converter/config/providerCountries\n    API--&gt;&gt;Client: ProviderCountryConfigDTO\n    Client--&gt;&gt;Repo: ProviderCountryConfigDTO\n    Repo--&gt;&gt;ConfigUC: [ProviderConfig]\n    ConfigUC--&gt;&gt;Feature: LoadProviderConfigOutput\n    Feature-&gt;&gt;Widget: \u66f4\u65b0 State\n    Widget-&gt;&gt;Sheet: \u958b\u555f Bottom Sheet\n\n    %% 2. \u9078\u64c7 Bookie\n    Note over User,Sheet: \u4f7f\u7528\u8005\u9078\u64c7 Bookie \u548c Country\n    User-&gt;&gt;Sheet: \u9078\u64c7 Provider\n\n    alt \u55ae\u4e00\u570b\u5bb6 Provider\n        Note over Sheet: Country \u81ea\u52d5\u9078\u5b9a\n    else \u591a\u570b\u5bb6 Provider\n        Sheet-&gt;&gt;User: \u986f\u793a Country \u5217\u8868\n        User-&gt;&gt;Sheet: \u9078\u64c7 Country\n    end\n\n    User-&gt;&gt;Sheet: \u9ede\u64ca Submit\n    Sheet--&gt;&gt;Widget: {provider, country}\n    Widget-&gt;&gt;Feature: .bookieSelected(provider, country)\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u986f\u793a\u5df2\u9078 Provider\n\n    %% 3. \u8f38\u5165 Booking Code\n    User-&gt;&gt;Widget: \u9ede\u64ca\u8f38\u5165\u6846\n    Widget-&gt;&gt;Feature: .inputFocused\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Focus \u72c0\u614b\n    User-&gt;&gt;Widget: \u8f38\u5165 Booking Code\n    Widget-&gt;&gt;Feature: .bookingCodeChanged(code)\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Typing/Filled \u72c0\u614b\n\n    %% 4. \u8f49\u63db\u6d41\u7a0b\n    User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n    Widget-&gt;&gt;Feature: .loadButtonTapped\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Loading \u72c0\u614b\n    Feature-&gt;&gt;ConvertUC: execute(provider, country, bookingCode)\n\n    ConvertUC-&gt;&gt;Repo: convertCode(provider, country, bookingCode)\n    Repo-&gt;&gt;Client: convertCode(request)\n    Client-&gt;&gt;API: POST /orders/converter/code\n\n    alt Convert API Success\n        API--&gt;&gt;Client: Code2CodeVO {shareCode, successCnt, failCnt}\n        Client--&gt;&gt;Repo: Code2CodeVO\n        Repo--&gt;&gt;ConvertUC: ConvertResult\n\n        %% 5. Check Liabilities (\u65e2\u6709\u6d41\u7a0b)\n        Note over ConvertUC,BetslipAPI: Check Liabilities \u65e2\u6709\u6d41\u7a0b\n        ConvertUC-&gt;&gt;BetslipRepo: checkLiabilities(shareCode)\n        BetslipRepo-&gt;&gt;BetslipClient: getLiabilities(shareCode)\n        BetslipClient-&gt;&gt;BetslipAPI: GET /bookingCode/{shareCode}/liabilities\n        BetslipAPI--&gt;&gt;BetslipClient: LiabilitiesDTO\n        BetslipClient--&gt;&gt;BetslipRepo: LiabilitiesDTO\n        BetslipRepo--&gt;&gt;ConvertUC: Liabilities\n\n        %% 6. Get Betslip Data (\u65e2\u6709\u6d41\u7a0b)\n        Note over ConvertUC,BetslipAPI: Get Betslip Data \u65e2\u6709\u6d41\u7a0b\n        ConvertUC-&gt;&gt;BetslipRepo: getBetslipData(shareCode)\n        BetslipRepo-&gt;&gt;BetslipClient: getShareOrder(shareCode)\n        BetslipClient-&gt;&gt;BetslipAPI: GET /orders/share/{shareCode}\n        BetslipAPI--&gt;&gt;BetslipClient: BetslipDataDTO\n        BetslipClient--&gt;&gt;BetslipRepo: BetslipDataDTO\n        BetslipRepo--&gt;&gt;ConvertUC: BetslipData\n\n        ConvertUC--&gt;&gt;Feature: ConvertBookingCodeOutput\n        Feature-&gt;&gt;Betslip: \u8f09\u5165 selections\n        Betslip-&gt;&gt;User: \u986f\u793a Betslip\n\n        opt failCnt &gt; 0\n            Note over Betslip: \u90e8\u5206\u8f49\u63db\u5931\u6557\n            Betslip-&gt;&gt;User: \u986f\u793a Toast X selections failed to convert\n        end\n\n    else Convert API Error\n        API--&gt;&gt;Client: error response\n        Client--&gt;&gt;Repo: error\n        Repo--&gt;&gt;ConvertUC: error\n        ConvertUC--&gt;&gt;Feature: error\n        Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Error \u72c0\u614b\n        Widget-&gt;&gt;User: \u986f\u793a\u932f\u8aa4\u8a0a\u606f\n    end</code></pre>"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#api","title":"API \u8abf\u7528\u9806\u5e8f","text":"\u9806\u5e8f API Method \u8aaa\u660e 1 <code>/orders/converter/config/providerCountries</code> <code>GET</code> \u53d6\u5f97 Provider Country \u8a2d\u5b9a 2 <code>/orders/converter/code</code> <code>POST</code> \u8f49\u63db Booking Code 3 <code>/bookingCode/{shareCode}/liabilities</code> <code>GET</code> \u6aa2\u67e5 Liabilities\uff08\u65e2\u6709\uff09 4 <code>/orders/share/{shareCode}</code> <code>GET</code> \u53d6\u5f97 Betslip Data\uff08\u65e2\u6709\uff09"},{"location":"02_Architecture/","title":"02_Architecture","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter Phase 1 \u7684 Clean Architecture \u5206\u5c64\u7d50\u69cb\u8207\u4f9d\u8cf4\u65b9\u5411\u3002</p>"},{"location":"02_Architecture/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_clean_architecture_diagram.md Clean Architecture \u5206\u5c64\u5716\u8207\u4f9d\u8cf4\u8aaa\u660e"},{"location":"02_Architecture/01_clean_architecture_diagram/","title":"Clean Architecture \u5206\u5c64\u5716","text":""},{"location":"02_Architecture/01_clean_architecture_diagram/#_1","title":"\u67b6\u69cb\u7e3d\u89bd","text":"<pre><code>flowchart TB\n    subgraph UI[\"UI Layer (SwiftUI)\"]\n        direction TB\n        LCW[LoadCodeWidgetView&lt;br/&gt;\u64f4\u5c55\u81ea LoadBookingCodeSectionView]\n        BSS[BookieSelectorSheet&lt;br/&gt;\u65b0\u589e SwiftUI]\n        Toast[PartialErrorToast]\n    end\n\n    subgraph Domain[\"Domain Layer (TCA)\"]\n        direction TB\n        subgraph Feature[\"Feature (Thin Reducer)\"]\n            LCF[LoadCodeWidget.Feature&lt;br/&gt;\u64f4\u5c55\u81ea LoadBookingCodeSection.Feature]\n        end\n        subgraph UseCase[\"UseCase (Business Logic)\"]\n            LPC[LoadProviderConfigUseCase]\n            CBC[ConvertBookingCodeUseCase]\n        end\n    end\n\n    subgraph DomainModel[\"Domain Model Layer\"]\n        direction TB\n        PC[ProviderConfig]\n        CR[ConvertResult]\n        WS[WidgetInputState]\n    end\n\n    subgraph Data[\"Data &amp; Infrastructure Layer\"]\n        direction TB\n        CCR[CodeConverterRepository]\n        CCC[CodeConverterClient]\n        CCA[CodeConverterAPI]\n        BR[BetslipRepository \u65e2\u6709]\n        BC[BetslipClient \u65e2\u6709]\n        BA[BetslipAPI \u65e2\u6709]\n    end\n\n    UI --&gt; Domain\n    Domain --&gt; DomainModel\n    Domain --&gt; Data\n    Data --&gt; DomainModel</code></pre>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_2","title":"\u5fa9\u7528\u7b56\u7565\uff08\u6838\u5fc3\uff09","text":""},{"location":"02_Architecture/01_clean_architecture_diagram/#loadbookingcodesectionview","title":"\u6700\u5927\u5316\u5fa9\u7528 LoadBookingCodeSectionView","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    LoadCodeWidgetView\uff08\u65b0\uff09                          \u2502\n\u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502    \u2502  \u64f4\u5c55\u81ea LoadBookingCodeSectionView \u7684\u7d50\u69cb                      \u2502 \u2502\n\u2502    \u2502                                                              \u2502 \u2502\n\u2502    \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502    \u2502  \u2502 BookieDropdown  \u2502  \u2502 BookingCodeInput                  \u2502  \u2502 \u2502\n\u2502    \u2502  \u2502 (\u64f4\u5c55\u81ea         \u2502  \u2502 (\u64f4\u5c55\u81ea BookingCodeInputView)      \u2502  \u2502 \u2502\n\u2502    \u2502  \u2502 CountryDropdown)\u2502  \u2502                                   \u2502  \u2502 \u2502\n\u2502    \u2502  \u2502                 \u2502  \u2502 + Error \u72c0\u614b\uff08\u7d05\u6846\uff09               \u2502  \u2502 \u2502\n\u2502    \u2502  \u2502 + Bookie \u540d\u7a31   \u2502  \u2502 + \u6e05\u9664\u6309\u9215 \u2297                      \u2502  \u2502 \u2502\n\u2502    \u2502  \u2502 + Country       \u2502  \u2502 + Loading \u63d0\u793a\u6587\u5b57                 \u2502  \u2502 \u2502\n\u2502    \u2502  \u2502 + \u9ede\u64ca\u958b\u555f Sheet\u2502  \u2502 + Load \u6309\u9215\u72c0\u614b                   \u2502  \u2502 \u2502\n\u2502    \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502 \u2502\n\u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                     \u2502\n\u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502    \u2502  BookieSelectorSheet\uff08\u65b0\u589e SwiftUI\uff09                          \u2502 \u2502\n\u2502    \u2502  - Bottom Sheet                                              \u2502 \u2502\n\u2502    \u2502  - \u96d9\u6b04\u9078\u64c7\u5668\uff08Bookie + Country\uff09                             \u2502 \u2502\n\u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_3","title":"\u5165\u53e3\u9ede\u8207\u66ff\u63db\u8a08\u756b","text":"\u5165\u53e3\u9ede \u73fe\u6709\u5be6\u4f5c \u66ff\u63db\u70ba \u9996\u9801 Widget <code>LoadBookingCodeSectionView</code> <code>LoadCodeWidgetView</code>\uff08\u539f\u5730\u64f4\u5c55\uff09 Code Center Load Code Tab <code>LoadCodeViewWrapper</code> \u2192 <code>LoadCodeViewController</code> (UIKit) <code>LoadCodeWidgetView</code> (SwiftUI) \u9996\u9801 Betslip (Empty) \u7121 / \u65e2\u6709\u7a7a\u72c0\u614b \u5d4c\u5165 <code>LoadCodeWidgetView</code>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_4","title":"\u4f9d\u8cf4\u65b9\u5411","text":"<p>\u56b4\u683c\u9075\u5faa\u55ae\u5411\u4f9d\u8cf4\uff1a</p> <pre><code>UI \u2192 Feature \u2192 UseCase \u2192 Repository \u2192 Client \u2192 API\n</code></pre>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_5","title":"\u5143\u4ef6\u8b8a\u66f4\u6e05\u55ae","text":""},{"location":"02_Architecture/01_clean_architecture_diagram/#_6","title":"\u64f4\u5c55\u7684\u5143\u4ef6\uff08\u6700\u5c0f\u6539\u52d5\uff09","text":"\u5143\u4ef6 \u8b8a\u66f4\u985e\u578b \u8aaa\u660e <code>LoadBookingCodeSectionView</code> \u64f4\u5c55 \u2192 <code>LoadCodeWidgetView</code>\uff0c\u589e\u52a0\u66f4\u591a\u72c0\u614b <code>CountryDropdownView</code> \u64f4\u5c55 \u2192 <code>BookieDropdownView</code>\uff0c\u986f\u793a Bookie + Country <code>BookingCodeInputView</code> \u64f4\u5c55 \u589e\u52a0 Error \u72c0\u614b\u3001\u6e05\u9664\u6309\u9215\u3001Loading \u63d0\u793a <code>LoadBookingCodeSection.Feature</code> \u64f4\u5c55 \u2192 <code>LoadCodeWidget.Feature</code>\uff0c\u589e\u52a0 Provider Config + Convert API"},{"location":"02_Architecture/01_clean_architecture_diagram/#_7","title":"\u65b0\u589e\u7684\u5143\u4ef6","text":"\u5143\u4ef6 \u985e\u578b \u8aaa\u660e <code>BookieSelectorSheet</code> SwiftUI View \u96d9\u6b04\u9078\u64c7\u5668 Bottom Sheet <code>LoadProviderConfigUseCase</code> UseCase \u53d6\u5f97 Provider Config <code>ConvertBookingCodeUseCase</code> UseCase Code2Code \u8f49\u63db <code>CodeConverterRepository</code> Repository Code Converter \u8cc7\u6599\u5b58\u53d6 <code>CodeConverterClient</code> Client HTTP \u901a\u8a0a"},{"location":"02_Architecture/01_clean_architecture_diagram/#_8","title":"\u5ee2\u68c4\u7684\u5143\u4ef6","text":"\u5143\u4ef6 \u539f\u56e0 <code>LoadCodeViewController</code> \u88ab <code>LoadCodeWidgetView</code> (SwiftUI) \u66ff\u63db <code>LoadCodeViewController.xib</code> \u96a8 ViewController \u4e00\u8d77\u5ee2\u68c4 <code>LoadCodeViewWrapper</code> \u4e0d\u518d\u9700\u8981 UIKit \u6a4b\u63a5"},{"location":"02_Architecture/01_clean_architecture_diagram/#_9","title":"\u6a21\u7d44\u5206\u7d44","text":"<pre><code>LoadCodeWidget/  (\u64f4\u5c55\u81ea LoadBookingCode/)\n\u251c\u2500\u2500 View/\n\u2502   \u251c\u2500\u2500 LoadCodeWidgetView.swift          (\u64f4\u5c55\u81ea LoadBookingCodeSectionView)\n\u2502   \u251c\u2500\u2500 BookieDropdownView.swift          (\u64f4\u5c55\u81ea CountryDropdownView)\n\u2502   \u251c\u2500\u2500 BookingCodeInputView.swift        (\u64f4\u5c55\uff0c\u589e\u52a0\u72c0\u614b)\n\u2502   \u2514\u2500\u2500 BookieSelectorSheet.swift         (\u65b0\u589e)\n\u251c\u2500\u2500 Feature/\n\u2502   \u2514\u2500\u2500 LoadCodeWidget+Feature.swift      (\u64f4\u5c55\u81ea LoadBookingCodeSection+Feature)\n\u251c\u2500\u2500 UseCase/\n\u2502   \u251c\u2500\u2500 LoadProviderConfigUseCase.swift   (\u65b0\u589e)\n\u2502   \u2514\u2500\u2500 ConvertBookingCodeUseCase.swift   (\u65b0\u589e)\n\u251c\u2500\u2500 Domain/\n\u2502   \u251c\u2500\u2500 ProviderConfig.swift              (\u65b0\u589e)\n\u2502   \u251c\u2500\u2500 ConvertResult.swift               (\u65b0\u589e)\n\u2502   \u2514\u2500\u2500 WidgetInputState.swift            (\u65b0\u589e)\n\u251c\u2500\u2500 Repository/\n\u2502   \u2514\u2500\u2500 CodeConverterRepository.swift     (\u65b0\u589e)\n\u251c\u2500\u2500 Client/\n\u2502   \u2514\u2500\u2500 CodeConverterClient.swift         (\u65b0\u589e)\n\u2514\u2500\u2500 API/\n    \u2514\u2500\u2500 CodeConverterAPI.swift            (\u65b0\u589e)\n</code></pre>"},{"location":"03_Module%20Responsibility/","title":"03_Module Responsibility","text":"<p>\u672c\u7ae0\u7bc0\u5217\u51fa\u6240\u6709\u6a21\u7d44\u53ca\u5176\u8077\u8cac\u3002</p>"},{"location":"03_Module%20Responsibility/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_module_responsibility.md \u6240\u6709\u6a21\u7d44\u7684\u8077\u8cac\u5b9a\u7fa9\u8868\u683c"},{"location":"03_Module%20Responsibility/01_module_responsibility/","title":"Module Responsibility","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#_1","title":"\u5fa9\u7528\u7b56\u7565\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         \u5fa9\u7528\u512a\u5148\u7d1a                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  1. \u6700\u5927\u5fa9\u7528\uff1a\u64f4\u5c55\u73fe\u6709 LoadBookingCodeSectionView \u7d50\u69cb                   \u2502\n\u2502  2. \u6700\u5c0f\u6539\u52d5\uff1a\u4fdd\u6301\u73fe\u6709 API \u76f8\u5bb9\u6027\uff0c\u65b0\u589e\u529f\u80fd\u4ee5 optional \u65b9\u5f0f\u52a0\u5165           \u2502\n\u2502  3. \u6f38\u9032\u5f0f\u66ff\u63db\uff1a\u5148\u64f4\u5c55\uff0c\u518d\u9010\u6b65\u66ff\u63db LoadCodeViewController                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#view-modulesui-layer","title":"View Modules\uff08UI Layer\uff09","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#view","title":"\u64f4\u5c55\u7684 View","text":"View \u540d\u7a31 \u539f\u6a94\u6848 \u8b8a\u66f4\u985e\u578b \u8aaa\u660e LoadCodeWidgetView <code>LoadBookingCodeSectionView.swift</code> \u64f4\u5c55 1. \u589e\u52a0 <code>inputState</code> \u652f\u63f4 6 \u7a2e\u72c0\u614b2. \u589e\u52a0 Error \u8a0a\u606f\u986f\u793a3. \u589e\u52a0 Loading \u63d0\u793a\u6587\u5b57 BookieDropdownView <code>CountryDropdownView</code> (private) \u64f4\u5c55 1. \u986f\u793a Bookie \u540d\u7a31 + Country2. \u9ede\u64ca\u958b\u555f <code>BookieSelectorSheet</code>3. \u652f\u63f4\u9577\u540d\u7a31\u622a\u65b7 BookingCodeInputView <code>BookingCodeInputView</code> (private) \u64f4\u5c55 1. \u589e\u52a0 Error \u72c0\u614b\uff08\u7d05\u8272\u908a\u6846\uff092. \u589e\u52a0\u6e05\u9664\u6309\u9215 \u22973. Load \u6309\u9215\u7da0\u8272/\u7070\u8272\u72c0\u614b"},{"location":"03_Module%20Responsibility/01_module_responsibility/#view_1","title":"\u65b0\u589e\u7684 View","text":"View \u540d\u7a31 \u6846\u67b6 \u8077\u8cac BookieSelectorSheet SwiftUI 1. Bottom Sheet \u5bb9\u56682. \u96d9\u6b04\u9078\u64c7\u5668\uff08Bookie + Country\uff093. \u8655\u7406\u9078\u64c7\u908f\u8f2f\uff08\u55ae\u570b\u5bb6\u81ea\u52d5\u95dc\u9589\u3001\u591a\u570b\u5bb6\u9700\u9078\u64c7\uff09 PartialErrorToast SwiftUI 1. \u986f\u793a\u300cX selections failed to convert\u300d\u8b66\u544a"},{"location":"03_Module%20Responsibility/01_module_responsibility/#feature-modulesdomain-layer","title":"Feature Modules\uff08Domain Layer\uff09","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#feature","title":"\u64f4\u5c55\u7684 Feature","text":"\u6a21\u7d44\u540d\u7a31 \u539f\u6a94\u6848 \u8b8a\u66f4\u985e\u578b \u4f7f\u7528\u7684 UseCase LoadCodeWidget.Feature <code>LoadBookingCodeSection+Feature.swift</code> \u64f4\u5c55 1. LoadProviderConfigUseCase\uff08\u65b0\u589e\uff092. ConvertBookingCodeUseCase\uff08\u65b0\u589e\uff093. \u65e2\u6709\u7684 loadBookingCode \u908f\u8f2f"},{"location":"03_Module%20Responsibility/01_module_responsibility/#state-loadbookingcodesectionstate","title":"State \u8b8a\u66f4\uff08\u64f4\u5c55\u81ea LoadBookingCodeSection.State\uff09","text":"\u5c6c\u6027 \u985e\u578b \u539f\u6709/\u65b0\u589e \u8aaa\u660e <code>bookingCode</code> String \u2705 \u539f\u6709 \u8f38\u5165\u7684 Booking Code <code>selectedCountry</code> Region \u26a0\ufe0f \u6539\u70ba Optional \u9700\u8207 Bookie \u914d\u5408 <code>isLoading</code> Bool \u2705 \u539f\u6709 Loading \u72c0\u614b <code>contentState</code> SectionContentState \u2705 \u539f\u6709 Section \u72c0\u614b <code>availableCountries</code> [Region] \u26a0\ufe0f \u52d5\u614b\u5316 \u7531 API \u6c7a\u5b9a <code>selectedBookie</code> SelectedBookie? \ud83c\udd95 \u65b0\u589e \u5df2\u9078\u64c7\u7684 Bookie <code>providerConfigs</code> [ProviderConfig] \ud83c\udd95 \u65b0\u589e Provider \u8a2d\u5b9a\u5217\u8868 <code>inputState</code> WidgetInputState \ud83c\udd95 \u65b0\u589e Widget \u8f38\u5165\u72c0\u614b <code>isBookieSelectorPresented</code> Bool \ud83c\udd95 \u65b0\u589e Sheet \u986f\u793a\u72c0\u614b <code>errorMessage</code> String? \ud83c\udd95 \u65b0\u589e \u932f\u8aa4\u8a0a\u606f"},{"location":"03_Module%20Responsibility/01_module_responsibility/#action-loadbookingcodesectionaction","title":"Action \u8b8a\u66f4\uff08\u64f4\u5c55\u81ea LoadBookingCodeSection.Action\uff09","text":"Action \u539f\u6709/\u65b0\u589e \u8aaa\u660e <code>.onAppear</code> \u2705 \u539f\u6709 \u9801\u9762\u51fa\u73fe <code>.bookingCodeChanged(String)</code> \u2705 \u539f\u6709 \u8f38\u5165\u8b8a\u66f4 <code>.countrySelected(Region)</code> \u2705 \u539f\u6709 \u9078\u64c7\u570b\u5bb6 <code>.loadBookingCode</code> \u2705 \u539f\u6709 \u8f09\u5165 Booking Code <code>.bookieDropdownTapped</code> \ud83c\udd95 \u65b0\u589e \u9ede\u64ca Bookie Dropdown <code>.bookieSelected(provider, country)</code> \ud83c\udd95 \u65b0\u589e \u9078\u64c7 Bookie <code>.bookieSelectorDismissed</code> \ud83c\udd95 \u65b0\u589e \u95dc\u9589 Sheet <code>.inputFocused</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u805a\u7126 <code>.inputBlurred</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u5931\u7126 <code>.clearButtonTapped</code> \ud83c\udd95 \u65b0\u589e \u6e05\u9664\u6309\u9215 <code>.providerConfigLoaded(Result)</code> \ud83c\udd95 \u65b0\u589e Config \u8f09\u5165\u5b8c\u6210 <code>.convertCodeCompleted(Result)</code> \ud83c\udd95 \u65b0\u589e \u8f49\u63db\u5b8c\u6210"},{"location":"03_Module%20Responsibility/01_module_responsibility/#usecase-modules","title":"UseCase Modules\uff08\u65b0\u589e\uff09","text":"UseCase \u540d\u7a31 \u5c64\u7d1a \u8077\u8cac Input Model Output Model \u4f7f\u7528\u7684 Repository LoadProviderConfigUseCase Domain Layer \u53d6\u5f97 Provider Country \u8a2d\u5b9a \u7121\u53c3\u6578 <code>[ProviderConfig]</code> CodeConverterRepository ConvertBookingCodeUseCase Domain Layer 1. \u57f7\u884c Code2Code \u8f49\u63db2. \u6574\u5408 Liabilities \u6aa2\u67e53. \u53d6\u5f97 Betslip Data <code>ConvertBookingCodeInput</code> <code>ConvertBookingCodeOutput</code> 1. CodeConverterRepository2. BetslipRepository\uff08\u65e2\u6709\uff09"},{"location":"03_Module%20Responsibility/01_module_responsibility/#repository-modules","title":"Repository Modules","text":"Repository \u540d\u7a31 \u72c0\u614b \u8077\u8cac \u4f7f\u7528\u7684 Client CodeConverterRepository \ud83c\udd95 \u65b0\u589e 1. \u53d6\u5f97 Provider Config2. \u57f7\u884c Code2Code \u8f49\u63db3. DTO \u2192 Domain Model \u8f49\u63db CodeConverterClient BetslipRepository \u2705 \u65e2\u6709\u5fa9\u7528 1. Liabilities \u6aa2\u67e52. Betslip Data \u53d6\u5f97 BetslipClient"},{"location":"03_Module%20Responsibility/01_module_responsibility/#client-modules","title":"Client Modules","text":"Client \u540d\u7a31 \u72c0\u614b \u6280\u8853 \u4f7f\u7528\u7684 API CodeConverterClient \ud83c\udd95 \u65b0\u589e HTTP CodeConverterAPI BetslipClient \u2705 \u65e2\u6709\u5fa9\u7528 HTTP BetslipAPI"},{"location":"03_Module%20Responsibility/01_module_responsibility/#api-modules","title":"API Modules","text":"API \u540d\u7a31 \u72c0\u614b Endpoints CodeConverterAPI \ud83c\udd95 \u65b0\u589e 1. <code>GET /orders/converter/config/providerCountries</code>2. <code>POST /orders/converter/code</code> BetslipAPI \u2705 \u65e2\u6709\u5fa9\u7528 1. <code>GET /bookingCode/{shareCode}/liabilities</code>2. <code>GET /orders/share/{shareCode}</code>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#_2","title":"\u66ff\u63db\u8a08\u756b","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#phase-1-loadbookingcodesectionview","title":"Phase 1: \u64f4\u5c55 LoadBookingCodeSectionView","text":"<pre><code>// \u4fdd\u6301\u5411\u5f8c\u76f8\u5bb9\uff0c\u65b0\u529f\u80fd\u4ee5 optional \u65b9\u5f0f\u52a0\u5165\nstruct LoadCodeWidgetView: View {\n    let store: StoreOf&lt;LoadCodeWidget.Feature&gt;\n\n    // \u65b0\u589e\uff1a\u662f\u5426\u555f\u7528 Code Converter \u529f\u80fd\n    var enableCodeConverter: Bool = true\n\n    var body: some View {\n        // \u57fa\u672c\u7d50\u69cb\u8207\u539f\u672c\u76f8\u540c\n        // \u6839\u64da enableCodeConverter \u6c7a\u5b9a\u986f\u793a Bookie Dropdown \u9084\u662f Country Dropdown\n    }\n}\n</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#phase-2-loadcodeviewcontroller","title":"Phase 2: \u66ff\u63db LoadCodeViewController","text":"\u5165\u53e3\u9ede \u8b8a\u66f4 Code Center <code>LoadCodeViewWrapper</code> \u2192 \u76f4\u63a5\u4f7f\u7528 <code>LoadCodeWidgetView</code> \u9996\u9801 Widget \u539f\u5730\u66ff\u63db\uff0c\u7121\u9700\u6539\u52d5\u7236\u5c64 Betslip Empty \u65b0\u589e\u5d4c\u5165 <code>LoadCodeWidgetView</code>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#phase-3","title":"Phase 3: \u79fb\u9664\u820a\u7a0b\u5f0f\u78bc","text":"<pre><code>\u522a\u9664\uff1a\n- LoadCodeViewController.swift\n- LoadCodeViewController.xib\n- LoadCodeViewWrapper.swift\n</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#_3","title":"\u6a21\u7d44\u4f9d\u8cf4\u95dc\u4fc2","text":"<pre><code>graph TD\n    LCW[LoadCodeWidgetView] --&gt; LCF[LoadCodeWidget.Feature]\n    BSS[BookieSelectorSheet] --&gt; LCF\n    LCF --&gt; LPCU[LoadProviderConfigUseCase]\n    LCF --&gt; CBCU[ConvertBookingCodeUseCase]\n    LCF --&gt; LCM[LoadCodeManager \u65e2\u6709]\n    LPCU --&gt; CCR[CodeConverterRepository]\n    CBCU --&gt; CCR\n    CBCU --&gt; BR[BetslipRepository \u65e2\u6709]\n    CCR --&gt; CCC[CodeConverterClient]\n    BR --&gt; BC[BetslipClient \u65e2\u6709]\n    CCC --&gt; CCA[CodeConverterAPI]\n    BC --&gt; BA[BetslipAPI \u65e2\u6709]</code></pre>"},{"location":"04_Domain%20Model/","title":"04_Domain Model","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter Phase 1 \u7684 Domain Models\uff0c\u5305\u542b Entity \u548c Value Object\u3002</p>"},{"location":"04_Domain%20Model/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_domain_model.md Entity \u548c Value Object \u5b9a\u7fa9 02_domain_model_uml.md Domain Model UML \u95dc\u4fc2\u5716"},{"location":"04_Domain%20Model/01_domain_model/","title":"Domain Model","text":""},{"location":"04_Domain%20Model/01_domain_model/#_1","title":"\u6a21\u578b\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         Domain Models                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  ProviderConfig        Provider \u8a2d\u5b9a\uff08\u4f86\u81ea API\uff09                 \u2502\n\u2502  SelectedBookie        \u5df2\u9078\u64c7\u7684 Bookie\uff08UI State\uff09              \u2502\n\u2502  ConvertResult         \u8f49\u63db\u7d50\u679c\uff08\u4f86\u81ea API\uff09                      \u2502\n\u2502  WidgetInputState      Widget \u8f38\u5165\u72c0\u614b\uff086 \u7a2e\u72c0\u614b\uff09               \u2502\n\u2502  CountryCode           \u570b\u5bb6\u4ee3\u78bc\uff08Value Object\uff09                  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                     \u65e2\u6709\u5fa9\u7528\u7684 Models                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Region                \u73fe\u6709\u570b\u5bb6/\u5730\u5340 enum                        \u2502\n\u2502  LoadCodeModel.CodeResult  \u73fe\u6709\u8f09\u5165\u7d50\u679c                          \u2502\n\u2502  EventDetailOutcomeElement \u73fe\u6709\u9078\u9805\u5143\u7d20                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#domain-models","title":"\u65b0\u589e\u7684 Domain Models","text":""},{"location":"04_Domain%20Model/01_domain_model/#providerconfig","title":"ProviderConfig","text":"<p>\u5c0d\u61c9 API: <code>GET /orders/converter/config/providerCountries</code></p> <pre><code>/// Provider \u8a2d\u5b9a\uff08\u4f86\u81ea API\uff09\nstruct ProviderConfig: Equatable, Identifiable {\n    let id: String  // \u4f7f\u7528 provider \u4f5c\u70ba id\n    let provider: String\n    let name: String\n    let countries: [CountryCode]\n\n    /// \u8f49\u63db\u70ba Region \u5217\u8868\uff08\u5411\u5f8c\u76f8\u5bb9\u7528\uff09\n    var regions: [Region] {\n        countries.compactMap { Region.from(countryCode: $0) }\n    }\n\n    /// \u662f\u5426\u53ea\u6709\u55ae\u4e00\u570b\u5bb6\n    var isSingleCountry: Bool {\n        countries.count == 1\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#countrycode","title":"CountryCode","text":"<pre><code>/// \u570b\u5bb6\u4ee3\u78bc Value Object\nenum CountryCode: String, Equatable, CaseIterable {\n    case nigeria = \"NG\"\n    case ghana = \"GH\"\n    case kenya = \"KE\"\n    case tanzania = \"TZ\"\n    case uganda = \"UG\"\n    case zambia = \"ZM\"\n    case ethiopia = \"ET\"\n    case cameroon = \"CM\"\n    case senegal = \"SN\"\n    case ivoryCoast = \"CI\"\n\n    /// \u570b\u5bb6\u540d\u7a31\uff08\u986f\u793a\u7528\uff09\n    var displayName: String {\n        switch self {\n        case .nigeria: return \"Nigeria\"\n        case .ghana: return \"Ghana\"\n        case .kenya: return \"Kenya\"\n        case .tanzania: return \"Tanzania\"\n        case .uganda: return \"Uganda\"\n        case .zambia: return \"Zambia\"\n        case .ethiopia: return \"Ethiopia\"\n        case .cameroon: return \"Cameroon\"\n        case .senegal: return \"Senegal\"\n        case .ivoryCoast: return \"Ivory Coast\"\n        }\n    }\n\n    /// \u570b\u65d7 Emoji\uff08\u53ef\u9078\uff09\n    var flag: String {\n        switch self {\n        case .nigeria: return \"\ud83c\uddf3\ud83c\uddec\"\n        case .ghana: return \"\ud83c\uddec\ud83c\udded\"\n        case .kenya: return \"\ud83c\uddf0\ud83c\uddea\"\n        case .tanzania: return \"\ud83c\uddf9\ud83c\uddff\"\n        case .uganda: return \"\ud83c\uddfa\ud83c\uddec\"\n        case .zambia: return \"\ud83c\uddff\ud83c\uddf2\"\n        case .ethiopia: return \"\ud83c\uddea\ud83c\uddf9\"\n        case .cameroon: return \"\ud83c\udde8\ud83c\uddf2\"\n        case .senegal: return \"\ud83c\uddf8\ud83c\uddf3\"\n        case .ivoryCoast: return \"\ud83c\udde8\ud83c\uddee\"\n        }\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#selectedbookie","title":"SelectedBookie","text":"<pre><code>/// \u5df2\u9078\u64c7\u7684 Bookie\uff08UI State \u7528\uff09\nstruct SelectedBookie: Equatable {\n    let provider: String    // e.g. \"bet9ja\"\n    let name: String        // e.g. \"Bet9ja\"\n    let country: CountryCode\n\n    /// \u986f\u793a\u6587\u5b57\uff08\u7528\u65bc Dropdown\uff09\n    var displayText: String {\n        \"\\(name) \\(country.rawValue)\"  // e.g. \"Bet9ja NG\"\n    }\n\n    /// \u77ed\u986f\u793a\uff08\u540d\u7a31\u592a\u9577\u6642\u7528\uff09\n    var shortDisplayText: String {\n        let maxLength = 12\n        if name.count &gt; maxLength {\n            return \"\\(name.prefix(maxLength))\u2026 \\(country.rawValue)\"\n        }\n        return displayText\n    }\n\n    /// \u5f9e ProviderConfig + CountryCode \u5efa\u7acb\n    init(provider: String, name: String, country: CountryCode) {\n        self.provider = provider\n        self.name = name\n        self.country = country\n    }\n\n    /// \u5f9e ProviderConfig \u5efa\u7acb\uff08\u4f7f\u7528\u7b2c\u4e00\u500b\u570b\u5bb6\uff09\n    init?(from config: ProviderConfig) {\n        guard let firstCountry = config.countries.first else { return nil }\n        self.provider = config.provider\n        self.name = config.name\n        self.country = firstCountry\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#widgetinputstate","title":"WidgetInputState","text":"<p>\u5c0d\u61c9 Figma \u8a2d\u8a08\u7684 6 \u7a2e UI \u72c0\u614b</p> <pre><code>/// Widget \u8f38\u5165\u72c0\u614b\nenum WidgetInputState: Equatable {\n    /// \u9810\u8a2d\u72c0\u614b\uff1a\u7121\u8f38\u5165\u3001\u7121\u805a\u7126\n    case `default`\n\n    /// \u805a\u7126\u72c0\u614b\uff1a\u8f38\u5165\u6846\u6709\u7da0\u8272\u908a\u6846\n    case focus\n\n    /// \u8f38\u5165\u4e2d\uff1a\u6709\u6587\u5b57\u3001\u6709\u6e05\u9664\u6309\u9215\u3001Load \u6309\u9215\u70ba\u7da0\u8272\n    case typing\n\n    /// \u5df2\u586b\u5beb\uff1a\u6709\u6587\u5b57\u3001\u7121\u805a\u7126\n    case filled\n\n    /// \u8f09\u5165\u4e2d\uff1a\u986f\u793a Spinner + \u63d0\u793a\u6587\u5b57\n    case loading\n\n    /// \u932f\u8aa4\u72c0\u614b\uff1a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f\n    case error(message: String)\n\n    // MARK: - Computed Properties\n\n    /// \u8f38\u5165\u6846\u662f\u5426\u986f\u793a\u7da0\u8272\u908a\u6846\n    var showFocusBorder: Bool {\n        switch self {\n        case .focus, .typing: return true\n        default: return false\n        }\n    }\n\n    /// \u8f38\u5165\u6846\u662f\u5426\u986f\u793a\u7d05\u8272\u908a\u6846\n    var showErrorBorder: Bool {\n        if case .error = self { return true }\n        return false\n    }\n\n    /// \u662f\u5426\u986f\u793a\u6e05\u9664\u6309\u9215\n    var showClearButton: Bool {\n        switch self {\n        case .typing, .filled, .error: return true\n        default: return false\n        }\n    }\n\n    /// Load \u6309\u9215\u662f\u5426\u555f\u7528\n    var isLoadButtonEnabled: Bool {\n        switch self {\n        case .typing, .filled: return true\n        default: return false\n        }\n    }\n\n    /// \u662f\u5426\u70ba\u932f\u8aa4\u72c0\u614b\n    var isError: Bool {\n        if case .error = self { return true }\n        return false\n    }\n\n    /// \u53d6\u5f97\u932f\u8aa4\u8a0a\u606f\n    var errorMessage: String? {\n        if case let .error(message) = self { return message }\n        return nil\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#convertresult","title":"ConvertResult","text":"<p>\u5c0d\u61c9 API: <code>POST /orders/converter/code</code></p> <pre><code>/// \u8f49\u63db\u7d50\u679c\uff08\u4f86\u81ea API\uff09\nstruct ConvertResult: Equatable {\n    let shareCode: String\n    let selections: [Selection]\n\n    /// \u5931\u6557\u6578\u91cf\n    var failCnt: Int {\n        selections.filter { $0.isFailed }.count\n    }\n\n    /// \u6210\u529f\u6578\u91cf\n    var successCnt: Int {\n        selections.filter { !$0.isFailed }.count\n    }\n\n    /// \u662f\u5426\u90e8\u5206\u5931\u6557\n    var hasPartialFailure: Bool {\n        failCnt &gt; 0 &amp;&amp; successCnt &gt; 0\n    }\n\n    /// \u662f\u5426\u5168\u90e8\u5931\u6557\n    var isAllFailed: Bool {\n        failCnt == selections.count\n    }\n}\n\nextension ConvertResult {\n    /// \u55ae\u4e00\u9078\u9805\n    struct Selection: Equatable {\n        let eventId: String\n        let sportId: Int\n        let marketId: Int\n        let selectionId: Int\n        let odds: Double\n        let specialBetValue: String?\n        let isFailed: Bool\n        let failReason: String?\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#models","title":"\u65e2\u6709\u5fa9\u7528\u7684 Models","text":""},{"location":"04_Domain%20Model/01_domain_model/#region","title":"Region\uff08\u64f4\u5c55\uff09","text":"<pre><code>extension Region {\n    /// \u5f9e CountryCode \u5efa\u7acb\n    static func from(countryCode: CountryCode) -&gt; Region? {\n        switch countryCode {\n        case .nigeria: return .nigeria\n        case .ghana: return .ghana\n        // ... \u5176\u4ed6 mapping\n        default: return nil\n        }\n    }\n\n    /// \u8f49\u63db\u70ba CountryCode\n    var countryCode: CountryCode? {\n        switch self {\n        case .nigeria: return .nigeria\n        case .ghana: return .ghana\n        // ... \u5176\u4ed6 mapping\n        default: return nil\n        }\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#dto-domain-model","title":"DTO \u2192 Domain Model \u8f49\u63db","text":""},{"location":"04_Domain%20Model/01_domain_model/#providercountrydto-providerconfig","title":"ProviderCountryDTO \u2192 ProviderConfig","text":"<pre><code>/// API Response DTO\nstruct ProviderCountryDTO: Decodable {\n    let provider: String\n    let name: String\n    let countries: [String]\n}\n\nextension ProviderConfig {\n    init(from dto: ProviderCountryDTO) {\n        self.id = dto.provider\n        self.provider = dto.provider\n        self.name = dto.name\n        self.countries = dto.countries.compactMap { CountryCode(rawValue: $0) }\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#codeconverterresponsedto-convertresult","title":"CodeConverterResponseDTO \u2192 ConvertResult","text":"<pre><code>/// API Response DTO\nstruct CodeConverterResponseDTO: Decodable {\n    let shareCode: String\n    let selections: [SelectionDTO]\n}\n\nstruct SelectionDTO: Decodable {\n    let eventId: String\n    let sportId: Int\n    let marketId: Int\n    let selectionId: Int\n    let odds: Double\n    let specialBetValue: String?\n    let isFailed: Bool\n    let failReason: String?\n}\n\nextension ConvertResult {\n    init(from dto: CodeConverterResponseDTO) {\n        self.shareCode = dto.shareCode\n        self.selections = dto.selections.map { Selection(from: $0) }\n    }\n}\n\nextension ConvertResult.Selection {\n    init(from dto: SelectionDTO) {\n        self.eventId = dto.eventId\n        self.sportId = dto.sportId\n        self.marketId = dto.marketId\n        self.selectionId = dto.selectionId\n        self.odds = dto.odds\n        self.specialBetValue = dto.specialBetValue\n        self.isFailed = dto.isFailed\n        self.failReason = dto.failReason\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/02_domain_model_uml/","title":"Domain Model UML","text":""},{"location":"04_Domain%20Model/02_domain_model_uml/#_1","title":"\u985e\u5225\u5716","text":"<pre><code>classDiagram\n    class ProviderConfig {\n        +String provider\n        +String name\n        +CountryCode[] countries\n        +isSingleCountry() Bool\n        +isAllCountries() Bool\n    }\n\n    class CountryCode {\n        &lt;&lt;enumeration&gt;&gt;\n        all\n        nigeria\n        kenya\n        uganda\n        ghana\n        zambia\n        tanzania\n        +displayName() String\n    }\n\n    class ConvertResult {\n        +String shareCode\n        +Int successCnt\n        +Int failCnt\n        +isFullSuccess() Bool\n        +isPartialSuccess() Bool\n        +isFullFailure() Bool\n    }\n\n    class WidgetInputState {\n        &lt;&lt;enumeration&gt;&gt;\n        default\n        focus\n        typing\n        filled\n        loading\n        error\n        +isLoadButtonEnabled() Bool\n    }\n\n    class SelectedBookie {\n        +String provider\n        +String name\n        +CountryCode country\n        +displayText() String\n    }\n\n    ProviderConfig \"1\" *-- \"1..*\" CountryCode : contains\n    SelectedBookie \"1\" -- \"1\" CountryCode : uses</code></pre>"},{"location":"04_Domain%20Model/02_domain_model_uml/#_2","title":"\u95dc\u4fc2\u8aaa\u660e","text":"\u95dc\u4fc2 \u8a9e\u610f\u5316\u95dc\u4fc2 \u6a19\u6e96 UML \u8aaa\u660e \u5be6\u4f5c\u65b9\u5f0f \u65b9\u5411 ProviderConfig \u2192 CountryCode contains Composition (*--) ProviderConfig \u5305\u542b\u591a\u500b CountryCode Array property ProviderConfig \u2192 CountryCode SelectedBookie \u2192 CountryCode uses Association (--) SelectedBookie \u4f7f\u7528\u4e00\u500b CountryCode Property SelectedBookie \u2192 CountryCode"},{"location":"04_Domain%20Model/02_domain_model_uml/#_3","title":"\u72c0\u614b\u5716","text":""},{"location":"04_Domain%20Model/02_domain_model_uml/#widgetinputstate","title":"WidgetInputState \u72c0\u614b\u8f49\u63db","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Default\n    Default --&gt; Focus : \u9ede\u64ca\u8f38\u5165\u6846\n    Focus --&gt; Typing : \u958b\u59cb\u8f38\u5165\n    Focus --&gt; Default : \u5931\u53bb\u7126\u9ede\u4e14\u7121\u8f38\u5165\n    Typing --&gt; Filled : \u8f38\u5165\u5b8c\u6210\n    Typing --&gt; Focus : \u6e05\u7a7a\u8f38\u5165\n    Filled --&gt; Loading : \u9ede\u64ca Load\n    Filled --&gt; Typing : \u7e7c\u7e8c\u7de8\u8f2f\n    Loading --&gt; Error : API \u5931\u6557\n    Loading --&gt; [*] : API \u6210\u529f \u8f09\u5165 Betslip\n    Error --&gt; Typing : \u4fee\u6539\u8f38\u5165\n    Error --&gt; Loading : \u91cd\u65b0 Load</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/","title":"View Implementation: \u5fa9\u7528\u7b56\u7565\u8a73\u89e3","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#_1","title":"\u5fa9\u7528\u7b56\u7565\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   LoadCodeWidgetView \u5fa9\u7528\u7b56\u7565                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u6838\u5fc3\u539f\u5247\uff1a\u6700\u5927\u5316\u5fa9\u7528 LoadBookingCodeSectionView \u7684\u7d50\u69cb               \u2502\n\u2502                                                                        \u2502\n\u2502  1. \u4fdd\u6301\u539f\u6709 API \u76f8\u5bb9\u6027\uff08\u4e0d\u7834\u58de\u73fe\u6709\u547c\u53eb\u65b9\uff09                           \u2502\n\u2502  2. \u65b0\u529f\u80fd\u4ee5 optional flag \u65b9\u5f0f\u52a0\u5165                                   \u2502\n\u2502  3. \u64f4\u5c55\u5b50\u5143\u4ef6\u800c\u975e\u91cd\u5beb                                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#vs","title":"\u73fe\u6709 vs \u65b0\u589e\u5c0d\u7167","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#loadbookingcodesectionview-loadcodewidgetview","title":"LoadBookingCodeSectionView \u2192 LoadCodeWidgetView","text":"<pre><code>// \u73fe\u6709\nstruct LoadBookingCodeSectionView: View {\n    let store: StoreOf&lt;LoadBookingCodeSection.Feature&gt;\n    @FocusState private var isTextFieldFocused: Bool\n\n    var body: some View {\n        VStack(spacing: 0) {\n            HStack(spacing: 8) {\n                CountryDropdownView(...)      // \u2190 \u5fa9\u7528\uff0c\u64f4\u5c55\u70ba BookieDropdown\n                BookingCodeInputView(...)     // \u2190 \u5fa9\u7528\uff0c\u589e\u52a0\u72c0\u614b\n            }\n        }\n    }\n}\n\n// \u65b0\u589e\uff08\u64f4\u5c55\uff09\nstruct LoadCodeWidgetView: View {\n    let store: StoreOf&lt;LoadCodeWidget.Feature&gt;\n    @FocusState private var isTextFieldFocused: Bool\n\n    var body: some View {\n        WithPerceptionTracking {\n            VStack(spacing: 0) {\n                // \u4e3b\u8981\u8f38\u5165\u5340\n                HStack(spacing: 8) {\n                    BookieDropdownView(...)     // \u2190 \u64f4\u5c55\u81ea CountryDropdownView\n                    BookingCodeInputView(...)   // \u2190 \u64f4\u5c55\uff0c\u589e\u52a0\u72c0\u614b\n                }\n\n                // \u65b0\u589e\uff1aLoading \u63d0\u793a\u6587\u5b57\n                if let hintText = store.loadingHintText {\n                    LoadingHintView(text: hintText)\n                }\n\n                // \u65b0\u589e\uff1a\u932f\u8aa4\u8a0a\u606f\n                if let errorMessage = store.errorMessage {\n                    ErrorMessageView(message: errorMessage)\n                }\n            }\n            .sheet(isPresented: $store.isBookieSelectorPresented.sending(\\.bookieSelectorDismissed)) {\n                BookieSelectorSheet(...)       // \u2190 \u65b0\u589e\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#_2","title":"\u5b50\u5143\u4ef6\u8b8a\u66f4\u8a73\u89e3","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#1-countrydropdownview-bookiedropdownview","title":"1. CountryDropdownView \u2192 BookieDropdownView","text":"\u5c6c\u6027 \u539f\u6709 \u65b0\u589e \u986f\u793a\u6587\u5b57 <code>selectedCountry.description</code> <code>selectedBookie.displayText</code> \u9ede\u64ca\u884c\u70ba Menu \u9078\u64c7 \u958b\u555f Sheet \u7bad\u982d\u5716\u793a chevron.down chevron.down <pre><code>// \u539f\u6709\nprivate struct CountryDropdownView: View {\n    let selectedCountry: Region\n    let availableCountries: [Region]\n    let onSelection: (Region) -&gt; Void\n\n    var body: some View {\n        Menu {\n            ForEach(availableCountries, id: \\.self) { country in\n                Button(country.description) {\n                    onSelection(country)\n                }\n            }\n        } label: {\n            HStack(spacing: 8) {\n                Text(selectedCountry.description)\n                Spacer()\n                Image(systemName: \"chevron.down\")\n            }\n        }\n    }\n}\n\n// \u65b0\u589e\uff08\u64f4\u5c55\uff09\nprivate struct BookieDropdownView: View {\n    let selectedBookie: SelectedBookie?\n    let enableCodeConverter: Bool\n    let selectedCountry: Region  // \u5411\u5f8c\u76f8\u5bb9\n    let onTap: () -&gt; Void\n\n    var body: some View {\n        Button(action: onTap) {\n            HStack(spacing: 8) {\n                // \u6839\u64da enableCodeConverter \u6c7a\u5b9a\u986f\u793a\u5167\u5bb9\n                if enableCodeConverter, let bookie = selectedBookie {\n                    // \u65b0\u529f\u80fd\uff1a\u986f\u793a Bookie + Country\n                    VStack(alignment: .leading, spacing: 2) {\n                        Text(bookie.name)\n                            .font(.system(size: 12))\n                            .lineLimit(1)\n                        Text(bookie.country.displayName)\n                            .font(.system(size: 10))\n                            .foregroundColor(.secondary)\n                    }\n                } else {\n                    // \u5411\u5f8c\u76f8\u5bb9\uff1a\u53ea\u986f\u793a Country\n                    Text(selectedCountry.description)\n                        .font(.system(size: 12))\n                }\n\n                Spacer()\n\n                Image(systemName: \"chevron.down\")\n                    .font(.system(size: 10))\n                    .foregroundColor(.secondary)\n            }\n            .padding(.horizontal, 12)\n            .padding(.vertical, 10)\n        }\n        .frame(maxWidth: .infinity, maxHeight: .infinity)\n        .background(\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color.backgroundType1Secondary)\n        )\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#2-bookingcodeinputview","title":"2. BookingCodeInputView \u64f4\u5c55","text":"\u529f\u80fd \u539f\u6709 \u65b0\u589e Focus \u7da0\u8272\u908a\u6846 \u2705 \u2705 Loading Spinner \u2705 \u2705 Error \u7d05\u8272\u908a\u6846 \u274c \u2705 \u6e05\u9664\u6309\u9215 \u2297 \u274c \u2705 Load \u6309\u9215\u984f\u8272 \u56fa\u5b9a \u52d5\u614b\uff08\u7da0/\u7070\uff09 <pre><code>// \u64f4\u5c55\u5f8c\nprivate struct BookingCodeInputView: View {\n    let bookingCode: String\n    let inputState: WidgetInputState\n    var isTextFieldFocused: FocusState&lt;Bool&gt;.Binding\n    let onTextChange: (String) -&gt; Void\n    let onSubmit: () -&gt; Void\n    let onClear: () -&gt; Void\n    let onFocus: () -&gt; Void\n    let onBlur: () -&gt; Void\n\n    var body: some View {\n        ZStack {\n            // \u80cc\u666f\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color.backgroundType1Secondary)\n\n            HStack(spacing: 8) {\n                // \u8f38\u5165\u6846\n                TextField(\"Booking Code\", text: .init(\n                    get: { bookingCode },\n                    set: { onTextChange($0) }\n                ))\n                .font(.system(size: 14))\n                .textFieldStyle(PlainTextFieldStyle())\n                .focused(isTextFieldFocused)\n                .tint(.brandSecondary)\n                .onSubmit {\n                    onSubmit()\n                    isTextFieldFocused.wrappedValue = false\n                }\n                .onChange(of: isTextFieldFocused.wrappedValue) { newValue in\n                    if newValue {\n                        onFocus()\n                    } else {\n                        onBlur()\n                    }\n                }\n                .submitLabel(.done)\n                .textInputAutocapitalization(.never)\n                .autocorrectionDisabled()\n                .padding(.leading, 16)\n\n                Spacer(minLength: 0)\n\n                // \u6e05\u9664\u6309\u9215\uff08\u65b0\u589e\uff09\n                if inputState.showClearButton {\n                    Button(action: onClear) {\n                        Image(systemName: \"xmark.circle.fill\")\n                            .foregroundColor(.gray)\n                    }\n                }\n\n                // Load \u6309\u9215 / Spinner\n                if inputState == .loading {\n                    ProgressView()\n                        .scaleEffect(0.8)\n                        .padding(.trailing, 8)\n                } else {\n                    Button(action: onSubmit) {\n                        Text(\"Load\")\n                            .font(.system(size: 14, weight: .semibold))\n                            .foregroundColor(inputState.isLoadButtonEnabled ? .black : .gray)\n                            .padding(.horizontal, 16)\n                            .padding(.vertical, 8)\n                            .background(\n                                RoundedRectangle(cornerRadius: 6)\n                                    .fill(inputState.isLoadButtonEnabled ? Color.brandSecondary : Color.gray.opacity(0.3))\n                            )\n                    }\n                    .disabled(!inputState.isLoadButtonEnabled)\n                    .padding(.trailing, 8)\n                }\n            }\n        }\n        // \u908a\u6846\u984f\u8272\uff08\u6839\u64da\u72c0\u614b\uff09\n        .overlay(\n            RoundedRectangle(cornerRadius: 10)\n                .stroke(borderColor, lineWidth: 2)\n        )\n    }\n\n    private var borderColor: Color {\n        if inputState.showErrorBorder {\n            return .red\n        } else if inputState.showFocusBorder {\n            return .brandSecondary\n        }\n        return .clear\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#3","title":"3. \u65b0\u589e\u5143\u4ef6","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#loadinghintview","title":"LoadingHintView","text":"<pre><code>private struct LoadingHintView: View {\n    let text: String\n\n    var body: some View {\n        Text(text)\n            .font(.system(size: 12))\n            .foregroundColor(.secondary)\n            .multilineTextAlignment(.leading)\n            .padding(.top, 8)\n            .padding(.horizontal, 8)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#errormessageview","title":"ErrorMessageView","text":"<pre><code>private struct ErrorMessageView: View {\n    let message: String\n\n    var body: some View {\n        Text(message)\n            .font(.system(size: 12))\n            .foregroundColor(.red)\n            .multilineTextAlignment(.leading)\n            .padding(.top, 8)\n            .padding(.horizontal, 8)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#_3","title":"\u5411\u5f8c\u76f8\u5bb9\u6027\u4fdd\u8b49","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#1-feature","title":"1. Feature \u521d\u59cb\u5316\u76f8\u5bb9","text":"<pre><code>// \u539f\u6709\u547c\u53eb\u65b9\u5f0f\u4ecd\u7136\u6709\u6548\nlet store = Store(initialState: LoadCodeWidget.State()) {\n    LoadCodeWidget.Feature()\n}\n\n// \u65b0\u529f\u80fd\u547c\u53eb\u65b9\u5f0f\nlet store = Store(initialState: LoadCodeWidget.State(enableCodeConverter: true)) {\n    LoadCodeWidget.Feature()\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#2-state","title":"2. State \u9810\u8a2d\u503c","text":"<p>\u6240\u6709\u65b0\u589e\u5c6c\u6027\u90fd\u6709\u5408\u7406\u7684\u9810\u8a2d\u503c\uff0c\u4e0d\u5f71\u97ff\u539f\u6709\u908f\u8f2f\uff1a</p> <pre><code>extension LoadCodeWidget.State {\n    init(\n        // \u539f\u6709\uff08\u4fdd\u6301\u9810\u8a2d\uff09\n        bookingCode: String = \"\",\n        selectedCountry: Region = .current,\n        isLoading: Bool = false,\n        contentState: SectionContentState = .loaded,\n        availableCountries: [Region] = [.ghana, .nigeria],\n\n        // \u65b0\u589e\uff08\u9810\u8a2d\u95dc\u9589\uff09\n        enableCodeConverter: Bool = false,  // \u2190 \u9810\u8a2d\u95dc\u9589\uff01\n        selectedBookie: SelectedBookie? = nil,\n        providerConfigs: [ProviderConfig] = [],\n        inputState: WidgetInputState = .default,\n        isBookieSelectorPresented: Bool = false,\n        errorMessage: String? = nil,\n        convertResult: ConvertResult? = nil\n    )\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/01_view_implementation/#3_1","title":"3. \u6f38\u9032\u5f0f\u9077\u79fb","text":"\u5165\u53e3\u9ede Phase 1 Phase 2 Phase 3 \u9996\u9801 Widget <code>enableCodeConverter = true</code> \u5b8c\u6210 \u5b8c\u6210 Code Center \u66ab\u7528\u820a\u5143\u4ef6 \u66ff\u63db\u70ba\u65b0\u5143\u4ef6 \u79fb\u9664\u820a\u5143\u4ef6 Betslip \u66ab\u7528\u820a\u5143\u4ef6 \u66ff\u63db\u70ba\u65b0\u5143\u4ef6 \u79fb\u9664\u820a\u5143\u4ef6"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/","title":"View Design Specs\uff08Figma \u8a2d\u8a08\u898f\u683c\uff09","text":"<p>\u4f86\u6e90\uff1aFigma File Key <code>SvcTlADMZ7gUPIa7nN2hT1</code> \u53c3\u8003\uff1a<code>Phase1_Design_Specs.md</code>, <code>Figma_Nodes_Phase1.md</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_1","title":"\ud83d\udccb \u76ee\u9304","text":"<ol> <li>Design Tokens</li> <li>Load Code Widget</li> <li>Bookie Selector Bottom Sheet</li> <li>Toast Message (Partial Error)</li> <li>Icons</li> <li>\u97ff\u61c9\u5f0f\u898f\u5247</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#design-tokens","title":"\ud83c\udfa8 Design Tokens","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#colors","title":"\u984f\u8272 (Colors)","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#brand","title":"\u54c1\u724c\u8272 (Brand)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c SwiftUI \u7528\u9014 <code>brand/brand_secondary</code> <code>#9ff611</code> <code>.brandSecondary</code> CTA \u6309\u9215\u3001\u9078\u4e2d\u72c0\u614b\u3001Focus \u908a\u6846 <code>brand/brand_secondary_disable</code> <code>#343247</code> - \u7981\u7528\u72c0\u614b\u6309\u9215\u80cc\u666f <code>brand/brand_tertiary</code> <code>#100e26</code> - \u6df1\u8272\u80cc\u666f\u3001Bottom Sheet \u80cc\u666f"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#background","title":"\u80cc\u666f\u8272 (Background)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c SwiftUI \u7528\u9014 <code>background_type1_primary</code> <code>#1c1a31</code> <code>.backgroundType1Primary</code> \u4e3b\u80cc\u666f <code>background_type1_secondary</code> <code>#100e26</code> <code>.backgroundType1Secondary</code> \u8f38\u5165\u6846\u80cc\u666f\u3001Dropdown \u80cc\u666f <code>background_type1_tertiary</code> <code>#28263c</code> <code>.backgroundType1Tertiary</code> Widget \u5916\u6846\u80cc\u666f"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#text","title":"\u6587\u5b57\u8272 (Text)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c \u7528\u9014 <code>text_type1_primary</code> <code>#e7e7e9</code> \u4e3b\u8981\u6587\u5b57\uff08\u8f38\u5165\u7684 Booking Code\uff09 <code>text_type1_secondary</code> <code>#878693</code> \u6b21\u8981\u6587\u5b57\uff08Placeholder\u3001\u6a19\u7c64\uff09 <code>text_type1_tertiary</code> <code>#ffffff</code> \u767d\u8272\u6587\u5b57\uff08Bookie \u9078\u9805\uff09 <code>text_disable_type1_primary</code> <code>#9c9bab</code> \u7981\u7528\u72c0\u614b\u6587\u5b57"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#warning","title":"\u8b66\u544a/\u932f\u8aa4 (Warning)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c \u7528\u9014 <code>warning_primary</code> <code>#fb4d3d</code> \u932f\u8aa4\u908a\u6846\u3001\u932f\u8aa4\u6587\u5b57\u3001Toast \u80cc\u666f"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#typography","title":"\u5b57\u578b (Typography)","text":"\u6a23\u5f0f\u540d\u7a31 Font Weight Size Line Height \u7528\u9014 <code>Body/B1_M</code> Roboto Medium (500) 14px 20px \u4e2d\u578b\u6309\u9215\u3001\u6a19\u7c64 <code>Body/B1_B</code> Roboto Bold (700) 14px auto Bookie \u9078\u9805\u6587\u5b57 <code>Body/B2_M</code> Roboto Medium (500) 12px 16px Load \u6309\u9215 <code>Body/B2_R</code> Roboto Regular (400) 12px auto \u932f\u8aa4\u8a0a\u606f\u3001\u63d0\u793a\u6587\u5b57 <p>SwiftUI \u5c0d\u7167\uff1a</p> <pre><code>// Body/B1_M (14px Medium)\n.font(.system(size: 14, weight: .medium))\n\n// Body/B2_M (12px Medium) - Load \u6309\u9215\n.font(.system(size: 12, weight: .medium))\n\n// Body/B2_R (12px Regular) - \u932f\u8aa4\u8a0a\u606f\n.font(.system(size: 12, weight: .regular))\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#border-radius","title":"\u5713\u89d2 (Border Radius)","text":"\u5143\u4ef6 \u503c SwiftUI Widget \u5916\u6846 <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code> \u8f38\u5165\u6846 <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code> Load \u6309\u9215 <code>2px</code> <code>RoundedRectangle(cornerRadius: 2)</code> Bottom Sheet \u9802\u90e8 <code>10px</code> <code>.cornerRadius(10, corners: [.topLeft, .topRight])</code> Bookie \u9078\u9805\u6309\u9215 <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code> Toast Message <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#spacing","title":"\u9593\u8ddd (Spacing)","text":"\u5143\u4ef6 \u5c6c\u6027 \u503c SwiftUI Widget \u5916\u6846 padding <code>8px</code> <code>.padding(8)</code> Widget \u5916\u6846 gap <code>8px</code> <code>HStack(spacing: 8)</code> \u8f38\u5165\u6846 padding <code>12px 14px</code> <code>.padding(.horizontal, 14).padding(.vertical, 12)</code> Load \u6309\u9215 padding <code>12px</code> <code>.padding(12)</code> Load \u6309\u9215 height <code>28px</code> <code>.frame(height: 28)</code> Bookie Dropdown width <code>104px</code> <code>.frame(width: 104)</code> Bookie Dropdown height <code>44px</code> <code>.frame(height: 44)</code> Input Container height <code>44px</code> <code>.frame(height: 44)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#shadows","title":"\u9670\u5f71 (Shadows)","text":"\u5143\u4ef6 \u503c SwiftUI Toast Message <code>0px 4px 12px rgba(28, 26, 49, 0.25)</code> <code>.shadow(color: Color(hex: \"#1c1a31\").opacity(0.25), radius: 12, x: 0, y: 4)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#load-code-widget","title":"\ud83e\udde9 Load Code Widget","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_2","title":"\u5143\u4ef6\u7d50\u69cb","text":"<pre><code>Load Code Widget (\u5916\u6846)                    \u2190 10px \u5713\u89d2, #28263c \u80cc\u666f, 8px padding\n\u251c\u2500\u2500 Bookie Dropdown (\u5de6\u5074)                \u2190 104px \u00d7 44px, #100e26 \u80cc\u666f\n\u2502   \u251c\u2500\u2500 Bookie \u540d\u7a31 (\u5982 \"F.com\")          \u2190 #e7e7e9, 14px Medium\n\u2502   \u251c\u2500\u2500 Country \u540d\u7a31 (\u5982 \"NG\")            \u2190 #878693, 12px Regular\n\u2502   \u2514\u2500\u2500 \u4e0b\u62c9\u7bad\u982d icon                      \u2190 12px, #ffffff\n\u2514\u2500\u2500 Input Container (\u53f3\u5074)                \u2190 flex: 1, 44px \u9ad8, #100e26 \u80cc\u666f\n    \u251c\u2500\u2500 Placeholder / \u8f38\u5165\u6587\u5b57             \u2190 #878693 (placeholder) / #e7e7e9 (\u8f38\u5165)\n    \u251c\u2500\u2500 \u6e05\u9664\u6309\u9215 (Typing/Filled/Error)     \u2190 20px, #878693\n    \u2514\u2500\u2500 Load \u6309\u9215                          \u2190 28px \u9ad8, 2px \u5713\u89d2\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#6-figma-node-id","title":"6 \u7a2e\u72c0\u614b - Figma Node ID \u5c0d\u7167","text":"\u72c0\u614b Figma Node ID \u8f38\u5165\u6846\u908a\u6846 Load \u6309\u9215 \u984d\u5916\u5143\u7d20 Default <code>26769:88873</code> \u7121 \u7070\u8272 <code>#343247</code> - Focus <code>26769:88868</code> \u7da0\u8272 <code>#9ff611</code> 1px \u7070\u8272 <code>#343247</code> \u7da0\u8272\u6e38\u6a19 Typing <code>26769:88869</code> \u7da0\u8272 <code>#9ff611</code> 1px \u7da0\u8272 <code>#9ff611</code> \u6e05\u9664\u6309\u9215 \u2297 Filled <code>26769:88870</code> \u7121 \u7da0\u8272 <code>#9ff611</code> \u6e05\u9664\u6309\u9215 \u2297 Loading <code>26769:88872</code> \u7121 \u7070\u8272 + Spinner Loading \u63d0\u793a\u6587\u5b57 Error <code>26769:88871</code> \u7d05\u8272 <code>#fb4d3d</code> 1px \u7da0\u8272 <code>#9ff611</code> \u932f\u8aa4\u8a0a\u606f\uff08\u7d05\u8272\uff09"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#default","title":"Default \u72c0\u614b","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 F.com     \u25bc  \u2502  \u2502 Booking Code              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502 NG           \u2502  \u2502                           \u2502 Load \u2502  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u5916\u6846\nRoundedRectangle(cornerRadius: 10)\n    .fill(Color(hex: \"#28263c\"))  // background_type1_tertiary\n\n// Load \u6309\u9215 (\u7981\u7528)\nText(\"Load\")\n    .font(.system(size: 12, weight: .medium))\n    .foregroundColor(Color(hex: \"#9c9bab\"))  // text_disable_type1_primary\n    .padding(.horizontal, 12)\n    .frame(height: 28)\n    .background(\n        RoundedRectangle(cornerRadius: 2)\n            .fill(Color(hex: \"#343247\"))  // brand_secondary_disable\n    )\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#focus","title":"Focus \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - Input Container\uff1a<code>border: 1px solid #9ff611</code> - \u6e38\u6a19\uff1a<code>#9ff611</code>, 1px \u00d7 14px</p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u8f38\u5165\u6846\u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color(hex: \"#9ff611\"), lineWidth: 1)\n)\n\n// TextField \u6e38\u6a19\u984f\u8272\n.tint(Color(hex: \"#9ff611\"))\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#typing","title":"Typing \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - \u4fdd\u6301\u7da0\u8272\u908a\u6846 - \u986f\u793a\u6e05\u9664\u6309\u9215 \u2297\uff0820px\uff0c#878693\uff09 - Load \u6309\u9215\u8b8a\u70ba\u7da0\u8272\u555f\u7528</p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u6e05\u9664\u6309\u9215\nButton(action: onClear) {\n    Image(systemName: \"xmark.circle.fill\")\n        .resizable()\n        .frame(width: 20, height: 20)\n        .foregroundColor(Color(hex: \"#878693\"))\n}\n\n// Load \u6309\u9215 (\u555f\u7528)\nText(\"Load\")\n    .font(.system(size: 12, weight: .medium))\n    .foregroundColor(Color(hex: \"#100e26\"))  // brand_tertiary\n    .padding(.horizontal, 12)\n    .frame(height: 28)\n    .background(\n        RoundedRectangle(cornerRadius: 2)\n            .fill(Color(hex: \"#9ff611\"))  // brand_secondary\n    )\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#loading","title":"Loading \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - \u79fb\u9664\u908a\u6846 - Load \u6309\u9215\u8b8a\u70ba Loading Spinner - \u986f\u793a\u63d0\u793a\u6587\u5b57</p> <p>\u63d0\u793a\u6587\u5b57\uff1a <pre><code>\"Conversion may take up to 10 seconds, please stay here and wait for the result.\"\n</code></pre></p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// Loading Spinner\nProgressView()\n    .progressViewStyle(CircularProgressViewStyle(tint: Color.white))\n    .scaleEffect(0.8)\n\n// \u63d0\u793a\u6587\u5b57\nText(\"Conversion may take up to 10 seconds, please stay here and wait for the result.\")\n    .font(.system(size: 12, weight: .regular))\n    .foregroundColor(Color(hex: \"#e7e7e9\"))\n    .padding(.top, 8)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#error","title":"Error \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - Input Container\uff1a<code>border: 1px solid #fb4d3d</code>\uff08\u7d05\u8272\uff09 - \u986f\u793a\u932f\u8aa4\u6587\u5b57\uff08\u7d05\u8272\uff09 - \u4fdd\u6301\u6e05\u9664\u6309\u9215 - Load \u6309\u9215\u4fdd\u6301\u7da0\u8272\uff08\u53ef\u91cd\u8a66\uff09</p> <p>\u932f\u8aa4\u6587\u5b57\uff1a <pre><code>\"We couldn't find this booking code on [BookieName]. Please check and try again.\"\n</code></pre></p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u7d05\u8272\u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color(hex: \"#fb4d3d\"), lineWidth: 1)\n)\n\n// \u932f\u8aa4\u6587\u5b57\nText(errorMessage)\n    .font(.system(size: 12, weight: .regular))\n    .foregroundColor(Color(hex: \"#fb4d3d\"))\n    .padding(.top, 8)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#bookie-selector-bottom-sheet","title":"\ud83d\udcf1 Bookie Selector Bottom Sheet","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#figma-node-ids","title":"Figma Node IDs","text":"\u5834\u666f Node ID \u958b\u555f\u9078\u55ae <code>26753:64425</code> \u591a\u570b\u5bb6 Bookie <code>26753:74664</code> \u9078\u64c7 Country <code>26753:78142</code> \u9ede\u64ca mask \u95dc\u9589 <code>26753:81632</code> \u9078\u64c7\u5b8c\u6210 <code>26753:85011</code> Scroll Bookie List <code>26748:63554</code> Bookie with Country <code>26748:63712</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_3","title":"\u5143\u4ef6\u7d50\u69cb","text":"<pre><code>Bottom Sheet                               \u2190 #100e26 \u80cc\u666f, 10px \u9802\u90e8\u5713\u89d2\n\u251c\u2500\u2500 \u62d6\u66f3\u689d (Drag Handle)                   \u2190 #d9d9d9, 60px \u00d7 4px, 18px \u5713\u89d2\n\u251c\u2500\u2500 \u6a19\u984c\u5217\n\u2502   \u251c\u2500\u2500 \"Bookie\" \u6a19\u7c64                       \u2190 #878693, 14px Medium\n\u2502   \u2514\u2500\u2500 \"Country\" \u6a19\u7c64                      \u2190 #878693, 14px Medium\n\u251c\u2500\u2500 \u96d9\u6b04\u9078\u64c7\u5668\n\u2502   \u251c\u2500\u2500 Bookie \u5217\u8868 (\u5de6\u6b04)\n\u2502   \u2514\u2500\u2500 Country \u5217\u8868 (\u53f3\u6b04)\n\u2514\u2500\u2500 \u6f38\u5c64\u906e\u7f69 (Fade Out Mask)                \u2190 #100e26 0% \u2192 100%, 12px \u9ad8\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_4","title":"\u6a23\u5f0f\u898f\u683c","text":"<p>Bottom Sheet \u5bb9\u5668\uff1a</p> <pre><code>.background(Color(hex: \"#100e26\"))\n.cornerRadius(10, corners: [.topLeft, .topRight])\n.padding(.horizontal, 12)\n.padding(.top, 6)\n.padding(.bottom, 16)\n</code></pre> <p>\u62d6\u66f3\u689d\uff1a</p> <pre><code>RoundedRectangle(cornerRadius: 18)\n    .fill(Color(hex: \"#d9d9d9\"))\n    .frame(width: 60, height: 4)\n</code></pre> <p>Bookie \u9078\u9805\u6309\u9215\uff1a</p> \u72c0\u614b \u80cc\u666f\u8272 \u6587\u5b57\u8272 \u672a\u9078\u4e2d <code>#464272</code> (50% opacity) <code>#ffffff</code> \u9078\u4e2d <code>#9ff611</code> <code>#464272</code> <pre><code>// \u672a\u9078\u4e2d\nRoundedRectangle(cornerRadius: 10)\n    .fill(Color(hex: \"#464272\").opacity(0.5))\n\n// \u9078\u4e2d\nRoundedRectangle(cornerRadius: 10)\n    .fill(Color(hex: \"#9ff611\"))\n</code></pre> <p>\u9078\u9805\u6309\u9215\u5c3a\u5bf8\uff1a</p> <pre><code>.frame(height: 40)\n.padding(.horizontal, 12)\n</code></pre> <p>\u5217\u9593\u8ddd\uff1a <code>8px</code> \u6b04\u9593\u8ddd\uff1a <code>12px</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_5","title":"\u6f38\u5c64\u906e\u7f69","text":"<pre><code>LinearGradient(\n    gradient: Gradient(colors: [\n        Color(hex: \"#100e26\").opacity(0),\n        Color(hex: \"#100e26\")\n    ]),\n    startPoint: .top,\n    endPoint: .bottom\n)\n.frame(height: 12)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#bookie-country","title":"Bookie \u6e05\u55ae + Country \u5c0d\u61c9","text":"Bookie \u652f\u63f4\u7684 Country \u9078\u64c7\u884c\u70ba F.com NG, GH \u9700\u9078 Country Sporty NG, GH \u9700\u9078 Country MSport NG, TZ \u9700\u9078 Country Bet9ja NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589 Bangbet NG, GH, TZ, KE, UG \u9700\u9078 Country BetKing NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589 1xBet NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589 Betway NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#toast-message-partial-error","title":"\ud83d\udd14 Toast Message (Partial Error)","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#figma-node-id","title":"Figma Node ID","text":"<p><code>26428:71769</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_6","title":"\u8996\u89ba\u898f\u683c","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u26a0  2 selections failed to convert                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>struct PartialErrorToast: View {\n    let failedCount: Int\n\n    var body: some View {\n        HStack(spacing: 4) {\n            Image(\"icon/exclamtion/2\")  // 12px\n                .resizable()\n                .frame(width: 12, height: 12)\n                .foregroundColor(Color(hex: \"#e7e7e9\"))\n\n            Text(\"\\(failedCount) selection\\(failedCount &gt; 1 ? \"s\" : \"\") failed to convert\")\n                .font(.system(size: 12, weight: .regular))\n                .foregroundColor(Color(hex: \"#e7e7e9\"))\n        }\n        .padding(.horizontal, 16)\n        .padding(.vertical, 12)\n        .background(\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color(hex: \"#fb4d3d\"))\n        )\n        .shadow(\n            color: Color(hex: \"#1c1a31\").opacity(0.25),\n            radius: 12,\n            x: 0,\n            y: 4\n        )\n    }\n}\n</code></pre> <p>\u4f4d\u7f6e\uff1a \u87a2\u5e55\u5e95\u90e8\uff0c\u8ddd\u96e2\u5de6\u53f3 <code>10px</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#icons","title":"\ud83d\uddbc\ufe0f Icons","text":"Icon \u540d\u7a31 \u7528\u9014 \u5c3a\u5bf8 \u984f\u8272 <code>icon/arrow_3/down</code> Dropdown \u4e0b\u62c9\u7bad\u982d 12px <code>#ffffff</code> <code>icon/loading</code> Load \u6309\u9215 Loading 12px - <code>icon/cancel</code> (xmark.circle.fill) \u6e05\u9664\u8f38\u5165\u6846 20px <code>#878693</code> <code>icon/exclamtion/2</code> Toast \u8b66\u544a 12px <code>#e7e7e9</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#_7","title":"\ud83d\udcd0 \u97ff\u61c9\u5f0f\u898f\u5247","text":"<p>\u26a0\ufe0f \u8a2d\u8a08\u57fa\u65bc 360px \u5bec\u5ea6</p> \u5143\u4ef6 \u5bec\u5ea6\u898f\u5247 SwiftUI Load Code Widget \u6eff\u7248 - padding <code>.frame(maxWidth: .infinity)</code> Bookie Dropdown \u56fa\u5b9a <code>104px</code> <code>.frame(width: 104)</code> Input Container \u5f48\u6027\u586b\u6eff <code>.frame(maxWidth: .infinity)</code> Bottom Sheet \u6eff\u7248 <code>.frame(maxWidth: .infinity)</code> Toast Message \u6eff\u7248 - 20px <code>.padding(.horizontal, 10)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#checklist","title":"\u2705 \u5be6\u4f5c Checklist","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#load-code-widget_1","title":"Load Code Widget","text":"<ul> <li> \u5916\u6846\u5bb9\u5668\uff08#28263c, 10px \u5713\u89d2, 8px padding\uff09</li> <li> Bookie Dropdown\uff08104px \u00d7 44px\uff09</li> <li> Input Container\uff0844px \u9ad8\uff09</li> <li> 6 \u7a2e\u72c0\u614b\u5207\u63db</li> <li> \u6e05\u9664\u6309\u9215 \u2297</li> <li> Load \u6309\u9215\uff08\u555f\u7528/\u7981\u7528\u72c0\u614b\uff09</li> <li> Focus \u908a\u6846\uff08#9ff611\uff09</li> <li> Error \u908a\u6846\uff08#fb4d3d\uff09</li> <li> Loading \u63d0\u793a\u6587\u5b57</li> <li> Error \u8a0a\u606f\u6587\u5b57</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#bookie-selector","title":"Bookie Selector","text":"<ul> <li> Bottom Sheet \u5bb9\u5668\uff08#100e26\uff09</li> <li> \u62d6\u66f3\u689d\uff0860px \u00d7 4px\uff09</li> <li> \u96d9\u6b04\u9078\u64c7\u5668</li> <li> \u9078\u4e2d/\u672a\u9078\u4e2d\u72c0\u614b</li> <li> \u6f38\u5c64\u906e\u7f69</li> <li> \u55ae\u4e00\u570b\u5bb6\u81ea\u52d5\u95dc\u9589</li> <li> \u591a\u570b\u5bb6\u9078\u64c7\u6d41\u7a0b</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/02_view_design_specs/#toast-message","title":"Toast Message","text":"<ul> <li> \u5bb9\u5668\uff08#fb4d3d, 10px \u5713\u89d2\uff09</li> <li> Warning icon</li> <li> \u52d5\u614b\u6587\u5b57</li> <li> \u9670\u5f71\u6548\u679c</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/","title":"State \u2194 Figma Node Mapping","text":"<p>\u7528\u9014\uff1a\u8b93 AI \u5728\u5be6\u4f5c\u6642\u900f\u904e Figma MCP \u81ea\u52d5\u6293\u53d6\u5c0d\u61c9\u72c0\u614b\u7684\u8a2d\u8a08\u898f\u683c File Key\uff1a<code>SvcTlADMZ7gUPIa7nN2hT1</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#widgetinputstate-figma-node-mapping","title":"\ud83d\udd17 WidgetInputState \u2192 Figma Node Mapping","text":"State Enum Figma Node ID \u89f8\u767c\u689d\u4ef6 (Action/Condition) \u5c0d\u61c9 UI \u8b8a\u5316 <code>.default</code> <code>26769:88873</code> \u521d\u59cb\u72c0\u614b / <code>.inputBlurred</code> + \u7121\u8f38\u5165 \u7121\u908a\u6846\u3001Load \u7070\u8272 <code>.focus</code> <code>26769:88868</code> <code>.inputFocused</code> + \u7121\u8f38\u5165 \u7da0\u8272\u908a\u6846\u3001\u6e38\u6a19 <code>.typing</code> <code>26769:88869</code> <code>.bookingCodeChanged</code> + \u6709\u8f38\u5165 + \u805a\u7126 \u7da0\u8272\u908a\u6846\u3001\u6e05\u9664\u6309\u9215\u3001Load \u7da0\u8272 <code>.filled</code> <code>26769:88870</code> <code>.inputBlurred</code> + \u6709\u8f38\u5165 \u7121\u908a\u6846\u3001\u6e05\u9664\u6309\u9215\u3001Load \u7da0\u8272 <code>.loading</code> <code>26769:88872</code> <code>.loadBookingCode</code> \u57f7\u884c\u4e2d \u7121\u908a\u6846\u3001Spinner\u3001\u63d0\u793a\u6587\u5b57 <code>.error(message)</code> <code>26769:88871</code> <code>.convertCodeCompleted(.failure)</code> \u7d05\u8272\u908a\u6846\u3001\u932f\u8aa4\u8a0a\u606f\u3001Load \u7da0\u8272"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#figma-node-mapping","title":"\ud83d\udcf1 \u4e3b\u6d41\u7a0b\u756b\u9762 \u2192 Figma Node Mapping","text":"\u6d41\u7a0b\u6b65\u9a5f \u756b\u9762 Figma Node ID \u5c0d\u61c9 Feature Action 1.0.0 \u9996\u9801 Default <code>26453:93262</code> \u521d\u59cb\u72c0\u614b 1.0.1 \u9996\u9801 Focus <code>26453:94175</code> <code>.inputFocused</code> 1.0.2 \u9996\u9801 Typing <code>26453:95089</code> <code>.bookingCodeChanged(\"...\")</code> 1.0.3 Bookie \u9078\u64c7\u5668 <code>26479:188518</code> <code>.bookieDropdownTapped</code> \u2192 Sheet \u958b\u555f 1.0.4 \u8f38\u5165\u5b8c\u6210 <code>26479:195612</code> <code>.bookieSelected</code> + \u6709\u8f38\u5165 1.0.5 Loading <code>26453:96003</code> <code>.loadBookingCode</code> 1.0.6 Error <code>26453:96916</code> <code>.convertCodeCompleted(.failure)</code> 1.0.8 Betslip <code>26428:71768</code> <code>.presentBetslip</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#bookie-selector-sheet-figma-node-mapping","title":"\ud83e\udde9 Bookie Selector Sheet \u2192 Figma Node Mapping","text":"\u5834\u666f Figma Node ID \u89f8\u767c\u689d\u4ef6 \u5c0d\u61c9 Action Sheet \u958b\u555f <code>26753:64425</code> <code>.providerConfigLoaded(.success)</code> <code>isBookieSelectorPresented = true</code> \u591a\u570b\u5bb6 Bookie \u5c55\u958b <code>26753:74664</code> \u9ede\u64ca\u591a\u570b\u5bb6 Bookie UI \u5167\u90e8\u72c0\u614b \u9078\u64c7 Country <code>26753:78142</code> \u9ede\u64ca Country <code>.bookieSelected(provider, country)</code> \u9ede\u64ca mask \u95dc\u9589 <code>26753:81632</code> \u9ede\u64ca\u80cc\u666f <code>.bookieSelectorDismissed</code> \u9078\u64c7\u5b8c\u6210 <code>26753:85011</code> \u9078\u64c7\u5f8c Sheet \u95dc\u9589"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#toast-figma-node-mapping","title":"\ud83d\udd14 Toast \u2192 Figma Node Mapping","text":"Toast \u985e\u578b Figma Node ID \u89f8\u767c\u689d\u4ef6 Partial Error <code>26428:71769</code> <code>convertResult.failCnt &gt; 0 &amp;&amp; convertResult.successCnt &gt; 0</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#ai","title":"\ud83e\udd16 AI \u5be6\u4f5c\u5de5\u4f5c\u6d41\u7a0b","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#step-1-tdd-state-mapping","title":"Step 1: \u8b80\u53d6 TDD \u53d6\u5f97 State Mapping","text":"<pre><code>\u8b80\u53d6: 03_state_to_figma_mapping.md\n\u53d6\u5f97: WidgetInputState \u2192 Figma Node ID \u5c0d\u7167\u8868\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#step-2-figma-mcp","title":"Step 2: \u900f\u904e Figma MCP \u6293\u53d6\u8a2d\u8a08","text":"<pre><code>\u5c0d\u65bc\u6bcf\u500b\u9700\u8981\u5be6\u4f5c\u7684 State:\n  1. \u5f9e mapping \u8868\u53d6\u5f97 Figma Node ID\n  2. \u547c\u53eb mcp_Figma_get_design_context(fileKey, nodeId)\n  3. \u53d6\u5f97\u8a72\u72c0\u614b\u7684\u8a73\u7d30\u8a2d\u8a08\u898f\u683c\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#step-3-tdd-stateaction","title":"Step 3: \u6839\u64da TDD \u7684 State/Action \u5be6\u4f5c","text":"<pre><code>\u6839\u64da 06_Feature State and Action:\n  1. \u5be6\u4f5c WidgetInputState enum\n  2. \u5be6\u4f5c\u72c0\u614b\u8f49\u63db\u908f\u8f2f (Reducer)\n  3. \u5728 View \u4e2d\u6839\u64da inputState \u6e32\u67d3\u5c0d\u61c9 UI\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#figma-mcp","title":"\ud83d\udccb \u5be6\u4f5c\u6642\u7684 Figma MCP \u547c\u53eb\u7bc4\u4f8b","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#default","title":"\u6293\u53d6 Default \u72c0\u614b\u8a2d\u8a08","text":"<pre><code>{\n  \"tool\": \"mcp_Figma_get_design_context\",\n  \"params\": {\n    \"fileKey\": \"SvcTlADMZ7gUPIa7nN2hT1\",\n    \"nodeId\": \"26769:88873\",\n    \"clientLanguages\": \"swift\",\n    \"clientFrameworks\": \"swiftui\"\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#error","title":"\u6293\u53d6 Error \u72c0\u614b\u8a2d\u8a08","text":"<pre><code>{\n  \"tool\": \"mcp_Figma_get_design_context\",\n  \"params\": {\n    \"fileKey\": \"SvcTlADMZ7gUPIa7nN2hT1\",\n    \"nodeId\": \"26769:88871\",\n    \"clientLanguages\": \"swift\",\n    \"clientFrameworks\": \"swiftui\"\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#bookie-selector","title":"\u6293\u53d6 Bookie Selector \u8a2d\u8a08","text":"<pre><code>{\n  \"tool\": \"mcp_Figma_get_design_context\",\n  \"params\": {\n    \"fileKey\": \"SvcTlADMZ7gUPIa7nN2hT1\",\n    \"nodeId\": \"26748:63712\",\n    \"clientLanguages\": \"swift\",\n    \"clientFrameworks\": \"swiftui\"\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#_1","title":"\u26a1 \u5feb\u901f\u5c0d\u7167\u8868\uff08\u5be6\u4f5c\u7528\uff09","text":"<pre><code>// WidgetInputState \u2192 Figma Node ID\nextension WidgetInputState {\n    var figmaNodeId: String {\n        switch self {\n        case .default:        return \"26769:88873\"\n        case .focus:          return \"26769:88868\"\n        case .typing:         return \"26769:88869\"\n        case .filled:         return \"26769:88870\"\n        case .loading:        return \"26769:88872\"\n        case .error:          return \"26769:88871\"\n        }\n    }\n}\n\n// \u4e3b\u6d41\u7a0b\u756b\u9762\u5c0d\u61c9\nenum LoadCodeWidgetScreen {\n    case homepage_default     // 26453:93262\n    case homepage_focus       // 26453:94175\n    case homepage_typing      // 26453:95089\n    case bookie_selector      // 26479:188518\n    case homepage_filled      // 26479:195612\n    case homepage_loading     // 26453:96003\n    case homepage_error       // 26453:96916\n    case betslip_result       // 26428:71768\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/03_state_to_figma_mapping/#state-figma-node","title":"\ud83d\udd04 State \u8f49\u63db\u5716 + Figma Node","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; default: \u521d\u59cb\u5316\n\n    default --&gt; focus: inputFocused\n    note right of default: 26769:88873\n\n    focus --&gt; typing: bookingCodeChanged (\u6709\u8f38\u5165)\n    focus --&gt; default: inputBlurred (\u7121\u8f38\u5165)\n    note right of focus: 26769:88868\n\n    typing --&gt; focus: clearButtonTapped\n    typing --&gt; filled: inputBlurred\n    typing --&gt; loading: loadBookingCode\n    note right of typing: 26769:88869\n\n    filled --&gt; focus: inputFocused\n    filled --&gt; loading: loadBookingCode\n    note right of filled: 26769:88870\n\n    loading --&gt; filled: convertCodeCompleted (success)\n    loading --&gt; error: convertCodeCompleted (failure)\n    note right of loading: 26769:88872\n\n    error --&gt; typing: bookingCodeChanged\n    error --&gt; focus: clearButtonTapped\n    note right of error: 26769:88871</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/","title":"Figma \u2192 DesignSystem Mapping","text":"<p>\u76ee\u7684\uff1a\u5c07 Figma \u8a2d\u8a08\u898f\u683c\u5c0d\u61c9\u5230 codebase \u73fe\u6709\u7684 DesignSystem \u984f\u8272/\u6a23\u5f0f \u4f86\u6e90\uff1a<code>DesignSystem/Sources/Colors/</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#_1","title":"\ud83c\udfa8 \u984f\u8272\u5c0d\u7167\u8868","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#brand","title":"\u54c1\u724c\u8272 (Brand)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>brand/brand_secondary</code> <code>#9FF611</code> \u2705 <code>Color.brandSecondary</code> <code>.foregroundColor(.brandSecondary)</code> <code>brand/brand_secondary_disable</code> <code>#343247</code> \u2705 <code>Color.brandSecondaryDisable</code> <code>.background(Color.brandSecondaryDisable)</code> <code>brand/brand_tertiary</code> <code>#100E26</code> \u2705 <code>Color.brandTertiary</code> <code>.background(Color.brandTertiary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#background","title":"\u80cc\u666f\u8272 (Background)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>background_type1_primary</code> <code>#1C1A31</code> \u2705 <code>Color.backgroundType1Primary</code> <code>.background(Color.backgroundType1Primary)</code> <code>background_type1_secondary</code> <code>#100E26</code> \u2705 <code>Color.backgroundType1Secondary</code> <code>.background(Color.backgroundType1Secondary)</code> <code>background_type1_tertiary</code> <code>#28263C</code> \u2705 <code>Color.backgroundType1Tertiary</code> <code>.background(Color.backgroundType1Tertiary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#text","title":"\u6587\u5b57\u8272 (Text)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>text_type1_primary</code> <code>#E7E7E9</code> \u2705 <code>Color.textType1Primary</code> <code>.foregroundColor(.textType1Primary)</code> <code>text_type1_secondary</code> <code>#878693</code> \u2705 <code>Color.textType1Secondary</code> <code>.foregroundColor(.textType1Secondary)</code> <code>text_type1_tertiary</code> <code>#FFFFFF</code> \u2705 <code>Color.textType1Tertiary</code> <code>.foregroundColor(.textType1Tertiary)</code> <code>text_disable_type1_primary</code> <code>#9C9BAB</code> \u2705 <code>Color.textDisableType1Primary</code> <code>.foregroundColor(.textDisableType1Primary)</code> <code>text_type2_secondary</code> <code>#E7E7E9</code> \u2705 <code>Color.textType2Secondary</code> <code>.foregroundColor(.textType2Secondary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#line","title":"\u7dda\u689d/\u908a\u6846 (Line)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>line_type1_primary</code> <code>#332F59</code> \u2705 <code>Color.lineType1Primary</code> <code>.stroke(Color.lineType1Primary)</code> <code>line_type1_secondary</code> <code>#464272</code> \u2705 <code>Color.lineType1Secondary</code> <code>.stroke(Color.lineType1Secondary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#warning","title":"\u8b66\u544a/\u932f\u8aa4 (Warning)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>warning_primary</code> <code>#FB4D3D</code> \u2705 <code>Color.warningPrimary</code> <code>.foregroundColor(.warningPrimary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#_2","title":"\ud83e\udde9 \u5143\u4ef6\u5c0d\u7167\u8868","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#load-code-widget","title":"Load Code Widget","text":"<pre><code>// \u5916\u6846\u80cc\u666f\n.background(Color.backgroundType1Tertiary)  // #28263C\n\n// Dropdown / Input \u80cc\u666f\n.background(Color.backgroundType1Secondary)  // #100E26\n\n// Focus \u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color.brandSecondary, lineWidth: 1)  // #9FF611\n)\n\n// Error \u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color.warningPrimary, lineWidth: 1)  // #FB4D3D\n)\n\n// Placeholder \u6587\u5b57\n.foregroundColor(.textType1Secondary)  // #878693\n\n// \u8f38\u5165\u6587\u5b57\n.foregroundColor(.textType1Primary)  // #E7E7E9\n\n// \u6e38\u6a19\u984f\u8272\n.tint(.brandSecondary)  // #9FF611\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#load","title":"Load \u6309\u9215","text":"<pre><code>// \u555f\u7528\u72c0\u614b\nText(\"Load\")\n    .foregroundColor(.brandTertiary)  // #100E26 (\u6df1\u8272\u80cc\u666f\u4e0a\u7684\u6587\u5b57)\n    .background(Color.brandSecondary)  // #9FF611\n\n// \u7981\u7528\u72c0\u614b\nText(\"Load\")\n    .foregroundColor(.textDisableType1Primary)  // #9C9BAB\n    .background(Color.brandSecondaryDisable)  // #343247\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#_3","title":"\u6e05\u9664\u6309\u9215","text":"<pre><code>Image(systemName: \"xmark.circle.fill\")\n    .foregroundColor(.textType1Secondary)  // #878693\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#error","title":"Error \u8a0a\u606f","text":"<pre><code>Text(errorMessage)\n    .foregroundColor(.warningPrimary)  // #FB4D3D\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#bookie-selector-sheet","title":"Bookie Selector Sheet","text":"<pre><code>// Sheet \u80cc\u666f\n.background(Color.brandTertiary)  // #100E26\n\n// \u672a\u9078\u4e2d\u6309\u9215\n.background(Color.lineType1Secondary.opacity(0.5))  // #464272 @ 50%\n.foregroundColor(.textType1Tertiary)  // #FFFFFF\n\n// \u9078\u4e2d\u6309\u9215\n.background(Color.brandSecondary)  // #9FF611\n.foregroundColor(.lineType1Secondary)  // #464272\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#toast-partial-error","title":"Toast (Partial Error)","text":"<pre><code>HStack(spacing: 4) {\n    Image(\"icon/exclamtion/2\")\n        .foregroundColor(.textType2Secondary)  // #E7E7E9\n    Text(\"\\(count) selections failed to convert\")\n        .foregroundColor(.textType2Secondary)  // #E7E7E9\n}\n.background(Color.warningPrimary)  // #FB4D3D\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#_4","title":"\u26a0\ufe0f \u7f3a\u5c11\u7684\u984f\u8272\uff08\u9700\u78ba\u8a8d\uff09","text":"<p>\u4ee5\u4e0b\u984f\u8272\u5728 Figma \u8a2d\u8a08\u7a3f\u4e2d\u51fa\u73fe\uff0c\u4f46\u5728 DesignSystem \u4e2d\u53ef\u80fd\u9700\u8981\u78ba\u8a8d\uff1a</p> Figma \u7528\u9014 Hex \u5efa\u8b70 DesignSystem \u5c0d\u61c9 \u62d6\u66f3\u689d (Drag Handle) <code>#D9D9D9</code> \u53ef\u80fd\u9700\u65b0\u589e\u6216\u4f7f\u7528 <code>.indicator</code> \u6f38\u5c64\u906e\u7f69 <code>#100E26</code> \u2192 transparent \u4f7f\u7528 <code>Color.brandTertiary</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#_5","title":"\ud83d\udccb \u5feb\u901f\u5c0d\u7167\u6e05\u55ae","text":"<pre><code>// === \u54c1\u724c\u8272 ===\nColor.brandSecondary          // #9FF611 - Focus \u908a\u6846\u3001CTA \u6309\u9215\nColor.brandSecondaryDisable   // #343247 - \u7981\u7528\u6309\u9215\nColor.brandTertiary           // #100E26 - \u6df1\u8272\u80cc\u666f\n\n// === \u80cc\u666f\u8272 ===\nColor.backgroundType1Primary   // #1C1A31 - \u4e3b\u80cc\u666f\nColor.backgroundType1Secondary // #100E26 - \u8f38\u5165\u6846\u80cc\u666f\nColor.backgroundType1Tertiary  // #28263C - Widget \u5916\u6846\n\n// === \u6587\u5b57\u8272 ===\nColor.textType1Primary         // #E7E7E9 - \u4e3b\u6587\u5b57\nColor.textType1Secondary       // #878693 - \u6b21\u6587\u5b57\u3001Placeholder\nColor.textType1Tertiary        // #FFFFFF - \u767d\u8272\u6587\u5b57\nColor.textDisableType1Primary  // #9C9BAB - \u7981\u7528\u6587\u5b57\n\n// === \u8b66\u544a ===\nColor.warningPrimary           // #FB4D3D - \u932f\u8aa4\u908a\u6846\u3001\u932f\u8aa4\u6587\u5b57\n\n// === \u7dda\u689d ===\nColor.lineType1Secondary       // #464272 - Bookie \u9078\u9805\u80cc\u666f\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadCodeWidget/04_figma_to_design_system_mapping/#tdd-vs-designsystem","title":"\ud83d\udd04 TDD \u539f\u59cb\u898f\u683c vs DesignSystem \u5c0d\u7167","text":"TDD \u539f\u59cb\u5beb\u6cd5 \u61c9\u6539\u70ba <code>Color(hex: \"#9ff611\")</code> <code>Color.brandSecondary</code> <code>Color(hex: \"#343247\")</code> <code>Color.brandSecondaryDisable</code> <code>Color(hex: \"#100e26\")</code> <code>Color.brandTertiary</code> \u6216 <code>Color.backgroundType1Secondary</code> <code>Color(hex: \"#28263c\")</code> <code>Color.backgroundType1Tertiary</code> <code>Color(hex: \"#e7e7e9\")</code> <code>Color.textType1Primary</code> <code>Color(hex: \"#878693\")</code> <code>Color.textType1Secondary</code> <code>Color(hex: \"#9c9bab\")</code> <code>Color.textDisableType1Primary</code> <code>Color(hex: \"#fb4d3d\")</code> <code>Color.warningPrimary</code> <code>Color(hex: \"#464272\")</code> <code>Color.lineType1Secondary</code> <code>Color(hex: \"#ffffff\")</code> <code>Color.textType1Tertiary</code>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/","title":"Module Sequence Diagrams - LoadCodeWidget","text":"<p>\u672c\u8cc7\u6599\u593e\u5305\u542b LoadCodeWidget Feature \u7684\u6a21\u7d44\u5e8f\u5217\u5716\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u985e\u578b \u8aaa\u660e 01_data_initialization_load_provider_config.md Data Initialization \u8f09\u5165 Provider Config \u6d41\u7a0b 02_data_interaction_convert_code.md Data Interaction Code2Code \u8f49\u63db\u6d41\u7a0b 03_data_interaction_bookie_selection.md Data Interaction Bookie \u9078\u64c7\u6d41\u7a0b"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/","title":"Module Sequence Diagram: Load Provider Config","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_1","title":"\u89f8\u767c\u6642\u6a5f","text":"<p>\u7528\u6236\u9ede\u64ca Bookie Dropdown \u6642\uff0c\u8f09\u5165 Provider Config \u4e26\u986f\u793a Bookie Selector Sheet\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#1-user-facing-sequence-diagram","title":"1\ufe0f\u20e3 User-Facing Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a\u5f9e\u7528\u6236\u8996\u89d2\u7684\u4e92\u52d5\u6d41\u7a0b\uff0c\u5305\u542b Figma \u8a2d\u8a08\u5c0d\u61c9\u3002</p> <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Selector as Bookie Selector Sheet\n    end\n\n    participant BE as Backend\n\n    %% \u9078\u64c7 Bookie (\u542b Config API)\n    rect rgb(255, 250, 240)\n        note over User,Selector: \u9078\u64c7 Bookie \u6d41\u7a0b\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u958b\u555f\u9078\u55ae\n        User-&gt;&gt;Widget: \u9ede\u64ca Bookie Dropdown\n        Widget-&gt;&gt;BE: GET /orders/converter/config/providerCountries\n\n        alt Config API Success\n            BE--&gt;&gt;Widget: {bizCode: 10000, data: [{provider, name, countries}...]}\n            Widget-&gt;&gt;Selector: \u958b\u555f Bottom Sheet\n\n            alt ALL \u570b\u5bb6 Provider (\u5982 Fcom)\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 (node: 26921:96820)\n                User-&gt;&gt;Selector: \u9078\u64c7 Provider\n                note over Selector: Country \u9810\u8a2d\u70ba ALL\uff0c\u7121\u9700\u9078\u64c7\n            else \u55ae\u4e00\u570b\u5bb6 Provider (\u5982 Bet9ja)\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u55ae\u4e00\u570b\u5bb6 Bookie\n                User-&gt;&gt;Selector: \u9078\u64c7 Provider\n                note over Selector: Country \u81ea\u52d5\u9078\u5b9a\uff0c\u7121\u9700\u9078\u64c7\n            else \u591a\u570b\u5bb6 Provider (\u5982 MSport)\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u591a\u570b\u5bb6 Bookie\n                User-&gt;&gt;Selector: \u9078\u64c7 Provider\n                Selector-&gt;&gt;User: \u986f\u793a Country \u5217\u8868\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u9078\u64c7 Country\n                User-&gt;&gt;Selector: \u9078\u64c7 Country\n            end\n\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 (node: 26921:96820)\n            User-&gt;&gt;Selector: \u9ede\u64ca Submit \u6309\u9215\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u7d50\u679c-\u6700\u7d42\u72c0\u614b\n            Selector--&gt;&gt;Widget: \u95dc\u9589 Sheet + \u56de\u50b3 {provider, country}\n            Widget-&gt;&gt;User: \u66f4\u65b0\u986f\u793a\u5df2\u9078 Provider\n\n        else Config API Failure\n            BE--&gt;&gt;Widget: error response\n            Widget-&gt;&gt;User: \u986f\u793a \"Config Load Failed\" \u932f\u8aa4 (Stop)\n        end\n    end</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Selector as Bookie Selector Sheet\n    end\n\n    participant BE as Backend\n\n    %% \u9078\u64c7 Bookie (\u542b Config API)\n    rect rgb(255, 250, 240)\n        note over User,Selector: \u9078\u64c7 Bookie \u6d41\u7a0b\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u958b\u555f\u9078\u55ae\n        User-&gt;&gt;Widget: \u9ede\u64ca Bookie Dropdown\n        Widget-&gt;&gt;BE: GET /orders/converter/config/providerCountries\n\n        alt Config API Success\n            BE--&gt;&gt;Widget: {bizCode: 10000, data: [{provider, name, countries}...]}\n            Widget-&gt;&gt;Selector: \u958b\u555f Bottom Sheet\n\n            alt ALL \u570b\u5bb6 Provider (\u5982 Fcom)\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 (node: 26921:96820)\n                User-&gt;&gt;Selector: \u9078\u64c7 Provider\n                note over Selector: Country \u9810\u8a2d\u70ba ALL\uff0c\u7121\u9700\u9078\u64c7\n            else \u55ae\u4e00\u570b\u5bb6 Provider (\u5982 Bet9ja)\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u55ae\u4e00\u570b\u5bb6 Bookie\n                User-&gt;&gt;Selector: \u9078\u64c7 Provider\n                note over Selector: Country \u81ea\u52d5\u9078\u5b9a\uff0c\u7121\u9700\u9078\u64c7\n            else \u591a\u570b\u5bb6 Provider (\u5982 MSport)\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u591a\u570b\u5bb6 Bookie\n                User-&gt;&gt;Selector: \u9078\u64c7 Provider\n                Selector-&gt;&gt;User: \u986f\u793a Country \u5217\u8868\n                note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u9078\u64c7 Country\n                User-&gt;&gt;Selector: \u9078\u64c7 Country\n            end\n\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 (node: 26921:96820)\n            User-&gt;&gt;Selector: \u9ede\u64ca Submit \u6309\u9215\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u7d50\u679c-\u6700\u7d42\u72c0\u614b\n            Selector--&gt;&gt;Widget: \u95dc\u9589 Sheet + \u56de\u50b3 {provider, country}\n            Widget-&gt;&gt;User: \u66f4\u65b0\u986f\u793a\u5df2\u9078 Provider\n\n        else Config API Failure\n            BE--&gt;&gt;Widget: error response\n            Widget-&gt;&gt;User: \u986f\u793a \"Config Load Failed\" \u932f\u8aa4 (Stop)\n        end\n    end\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#figma-frame","title":"Figma Frame \u5c0d\u61c9\u8868","text":"\u6d41\u7a0b\u968e\u6bb5 Figma Frame Node ID \u958b\u555f\u9078\u55ae 1.0.3 <code>26753:64425</code> \u55ae\u4e00\u570b\u5bb6 Bookie 1.0.3 <code>26753:64562</code> \u591a\u570b\u5bb6 Bookie 1.0.3 <code>26753:64699</code> \u9078\u64c7 Country 1.0.3 <code>26753:64836</code> Submit \u6309\u9215 1.0.3 <code>26921:96820</code> \u7d50\u679c - \u6700\u7d42\u72c0\u614b 1.0.3 <code>26753:85011</code>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#provider","title":"Provider \u985e\u578b\u5c0d\u7167\u8868","text":"\u985e\u578b \u7bc4\u4f8b <code>countries</code> \u503c Country \u9078\u64c7\u884c\u70ba ALL \u570b\u5bb6 Fcom <code>[\"ALL\"]</code> \u9810\u8a2d\u70ba ALL\uff0c\u7121\u9700\u9078\u64c7 \u55ae\u4e00\u570b\u5bb6 Bet9ja <code>[\"NG\"]</code> \u81ea\u52d5\u9078\u5b9a\uff0c\u7121\u9700\u9078\u64c7 \u591a\u570b\u5bb6 MSport <code>[\"NG\", \"GH\", \"UG\", \"ZM\"]</code> \u9700\u8981\u9078\u64c7 Country"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#2-codebase-level-sequence-diagram","title":"2\ufe0f\u20e3 Codebase-Level Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a Clean Architecture \u5404\u5c64\u4e4b\u9593\u7684\u547c\u53eb\u95dc\u4fc2\u3002</p> <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as LoadProviderConfigUseCase\n    participant Repo as CodeConverterRepository\n    participant Client as CodeConverterClient\n    participant API as GET /orders/converter/config/providerCountries\n\n    UI-&gt;&gt;Feature: .bookieDropdownTapped\n\n    Feature-&gt;&gt;UC: execute()\n\n    UC-&gt;&gt;Repo: getProviderConfigs()\n\n    Repo-&gt;&gt;Client: fetchProviderCountries()\n\n    Client-&gt;&gt;API: GET request\n    API--&gt;&gt;Client: 200 OK with ProviderCountryDTO[]\n\n    Client--&gt;&gt;Repo: [ProviderCountryDTO]\n\n    Note over Repo: DTO \u2192 Domain Model \u8f49\u63db\n    Repo--&gt;&gt;UC: [ProviderConfig]\n\n    UC--&gt;&gt;Feature: .success([ProviderConfig])\n\n    Feature-&gt;&gt;Feature: state.providerConfigs = configs\n    Feature-&gt;&gt;Feature: state.isBookieSelectorPresented = true\n    Feature-&gt;&gt;Feature: state.availableCountries = configs.flatMap(\\.regions)\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    UI-&gt;&gt;UI: \u986f\u793a BookieSelectorSheet</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as LoadProviderConfigUseCase\n    participant Repo as CodeConverterRepository\n    participant Client as CodeConverterClient\n    participant API as GET /orders/converter/config/providerCountries\n\n    UI-&gt;&gt;Feature: .bookieDropdownTapped\n\n    Feature-&gt;&gt;UC: execute()\n\n    UC-&gt;&gt;Repo: getProviderConfigs()\n\n    Repo-&gt;&gt;Client: fetchProviderCountries()\n\n    Client-&gt;&gt;API: GET request\n    API--&gt;&gt;Client: 200 OK with ProviderCountryDTO[]\n\n    Client--&gt;&gt;Repo: [ProviderCountryDTO]\n\n    Note over Repo: DTO \u2192 Domain Model \u8f49\u63db\n    Repo--&gt;&gt;UC: [ProviderConfig]\n\n    UC--&gt;&gt;Feature: .success([ProviderConfig])\n\n    Feature-&gt;&gt;Feature: state.providerConfigs = configs\n    Feature-&gt;&gt;Feature: state.isBookieSelectorPresented = true\n    Feature-&gt;&gt;Feature: state.availableCountries = configs.flatMap(\\.regions)\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    UI-&gt;&gt;UI: \u986f\u793a BookieSelectorSheet\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#api-requestresponse","title":"API Request/Response","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#request","title":"Request","text":"<pre><code>GET /orders/converter/config/providerCountries\nAuthorization: Bearer {token}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#response-200-ok","title":"Response (200 OK)","text":"<pre><code>{\n  \"bizCode\": 10000,\n  \"message\": \"success\",\n  \"data\": [\n    {\n      \"provider\": \"bet9ja\",\n      \"name\": \"Bet9ja\",\n      \"countries\": [\"NG\"]\n    },\n    {\n      \"provider\": \"betway\",\n      \"name\": \"Betway\",\n      \"countries\": [\"GH\", \"NG\", \"KE\", \"TZ\", \"UG\", \"ZM\"]\n    },\n    {\n      \"provider\": \"fcom\",\n      \"name\": \"Fcom\",\n      \"countries\": [\"ALL\"]\n    }\n  ]\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#state","title":"State \u8b8a\u66f4","text":"Before After <code>providerConfigs = []</code> <code>providerConfigs = [ProviderConfig(...), ...]</code> <code>isBookieSelectorPresented = false</code> <code>isBookieSelectorPresented = true</code> <code>availableCountries = [.ghana, .nigeria]</code> <code>availableCountries = [\u6240\u6709 API \u8fd4\u56de\u7684\u570b\u5bb6]</code>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_2","title":"\u932f\u8aa4\u8655\u7406","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as LoadProviderConfigUseCase\n    participant Repo as CodeConverterRepository\n\n    UI-&gt;&gt;Feature: .bookieDropdownTapped\n\n    Feature-&gt;&gt;UC: execute()\n\n    UC-&gt;&gt;Repo: getProviderConfigs()\n\n    Repo--&gt;&gt;UC: throw NetworkError\n\n    UC--&gt;&gt;Feature: .failure(error)\n\n    Feature-&gt;&gt;Feature: state.errorMessage = error.localizedDescription\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u986f\u793a\u932f\u8aa4 Toast\uff08\u4e0d\u958b\u555f Sheet\uff09</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#code","title":"Code \u5be6\u4f5c\u53c3\u8003","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#usecase","title":"UseCase","text":"<pre><code>struct LoadProviderConfigUseCase {\n    @Dependency(\\.codeConverterRepository) var repository\n\n    func execute() async -&gt; Result&lt;[ProviderConfig], Error&gt; {\n        do {\n            let configs = try await repository.getProviderConfigs()\n            return .success(configs)\n        } catch {\n            return .failure(error)\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#repository","title":"Repository","text":"<pre><code>struct CodeConverterRepository {\n    @Dependency(\\.codeConverterClient) var client\n\n    func getProviderConfigs() async throws -&gt; [ProviderConfig] {\n        let dtos = try await client.fetchProviderCountries()\n        return dtos.map { ProviderConfig(from: $0) }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/","title":"Module Sequence Diagram: Convert Booking Code (Code2Code)","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#_1","title":"\u89f8\u767c\u6642\u6a5f","text":"<p>\u7528\u6236\u9ede\u64ca Load \u6309\u9215\uff0c\u57f7\u884c Code2Code \u8f49\u63db\u6d41\u7a0b\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#1-user-facing-sequence-diagram","title":"1\ufe0f\u20e3 User-Facing Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a\u5f9e\u7528\u6236\u8996\u89d2\u7684\u5b8c\u6574\u8f49\u63db\u6d41\u7a0b\uff0c\u5305\u542b Figma \u8a2d\u8a08\u5c0d\u61c9\u3002</p> <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Betslip as Betslip\n    end\n\n    participant BE as Backend\n\n    %% \u8f38\u5165 Booking Code\n    rect rgb(240, 255, 240)\n        note over User,Widget: \u8f38\u5165 Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.1 Focus\n        User-&gt;&gt;Widget: \u9ede\u64ca\u8f38\u5165\u6846\n        Widget-&gt;&gt;User: \u986f\u793a Focus \u72c0\u614b (\u7da0\u8272\u908a\u6846)\n        note over Widget: \ud83d\udcd0 Figma: 1.0.2 Typing\n        User-&gt;&gt;Widget: \u8f38\u5165 Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.4 Filled\n        Widget-&gt;&gt;User: \u986f\u793a Filled \u72c0\u614b (Load \u6309\u9215\u555f\u7528)\n    end\n\n    %% \u8f49\u63db\u6d41\u7a0b\n    rect rgb(255, 245, 238)\n        note over User,BE: \u8f49\u63db\u6d41\u7a0b\n        User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n        note over Widget: \ud83d\udcd0 Figma: 1.0.5 Loading\n        Widget-&gt;&gt;User: \u986f\u793a Loading \u72c0\u614b\n        note right of Widget: \"Conversion may take up to 10 seconds...\"\n\n        Widget-&gt;&gt;BE: POST /orders/converter/code\n        note over Widget,BE: Request: {provider, country, bookingCode}\n\n        alt Convert API Success\n            BE--&gt;&gt;Widget: {bizCode: 10000, data: {shareCode, successCnt, failCnt}}\n            note over Widget: \u8a18\u9304 failCnt \u7528\u65bc\u5f8c\u7e8c Toast \u986f\u793a\n\n            %% Check Liabilities [\u65e2\u6709\u6d41\u7a0b]\n            note over Widget,BE: Check Liabilities [\u65e2\u6709\u6d41\u7a0b]\n            Widget-&gt;&gt;BE: GET /bookingCode/[shareCode]/liabilities\n\n            alt Liabilities API Success\n                BE--&gt;&gt;Widget: {isTrusted: true/false}\n\n                %% Get Betslip Data [\u65e2\u6709\u6d41\u7a0b]\n                note over Widget,BE: Get Betslip Data [\u65e2\u6709\u6d41\u7a0b]\n                Widget-&gt;&gt;BE: GET /orders/share/[shareCode]\n\n                alt Share API Success\n                    BE--&gt;&gt;Widget: {betslipData: selections}\n\n                    %% \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget,Betslip: \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget: \ud83d\udcd0 Figma: 1.0.8 Success\n                    Widget-&gt;&gt;Betslip: Pop up Betslip (\u8f09\u5165 selections)\n                    note over Betslip: \ud83d\udcd0 Figma: Betslip Success\n                    Betslip-&gt;&gt;User: \u986f\u793a Betslip\n\n                    opt failCnt &gt; 0 (\u90e8\u5206\u8f49\u63db\u5931\u6557)\n                        note over Betslip: \ud83d\udcd0 Figma: Betslip Partial\n                        Betslip-&gt;&gt;User: \u986f\u793a Toast \"\u26a0 X selections failed to convert\"\n                    end\n\n                else Share API Failure\n                    BE--&gt;&gt;Widget: error response\n                    Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n                end\n\n            else Liabilities API Failure\n                BE--&gt;&gt;Widget: error response\n                Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n            end\n\n        else Convert API Error\n            note over Widget: \ud83d\udcd0 Figma: 1.0.6 Error\n            BE--&gt;&gt;Widget: error response\n            Widget-&gt;&gt;User: \u986f\u793a Error \u72c0\u614b (Stop)\n        end\n    end</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Betslip as Betslip\n    end\n\n    participant BE as Backend\n\n    %% \u8f38\u5165 Booking Code\n    rect rgb(240, 255, 240)\n        note over User,Widget: \u8f38\u5165 Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.1 Focus\n        User-&gt;&gt;Widget: \u9ede\u64ca\u8f38\u5165\u6846\n        Widget-&gt;&gt;User: \u986f\u793a Focus \u72c0\u614b (\u7da0\u8272\u908a\u6846)\n        note over Widget: \ud83d\udcd0 Figma: 1.0.2 Typing\n        User-&gt;&gt;Widget: \u8f38\u5165 Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.4 Filled\n        Widget-&gt;&gt;User: \u986f\u793a Filled \u72c0\u614b (Load \u6309\u9215\u555f\u7528)\n    end\n\n    %% \u8f49\u63db\u6d41\u7a0b\n    rect rgb(255, 245, 238)\n        note over User,BE: \u8f49\u63db\u6d41\u7a0b\n        User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n        note over Widget: \ud83d\udcd0 Figma: 1.0.5 Loading\n        Widget-&gt;&gt;User: \u986f\u793a Loading \u72c0\u614b\n        note right of Widget: \"Conversion may take up to 10 seconds...\"\n\n        Widget-&gt;&gt;BE: POST /orders/converter/code\n        note over Widget,BE: Request: {provider, country, bookingCode}\n\n        alt Convert API Success\n            BE--&gt;&gt;Widget: {bizCode: 10000, data: {shareCode, successCnt, failCnt}}\n            note over Widget: \u8a18\u9304 failCnt \u7528\u65bc\u5f8c\u7e8c Toast \u986f\u793a\n\n            %% Check Liabilities [\u65e2\u6709\u6d41\u7a0b]\n            note over Widget,BE: Check Liabilities [\u65e2\u6709\u6d41\u7a0b]\n            Widget-&gt;&gt;BE: GET /bookingCode/[shareCode]/liabilities\n\n            alt Liabilities API Success\n                BE--&gt;&gt;Widget: {isTrusted: true/false}\n\n                %% Get Betslip Data [\u65e2\u6709\u6d41\u7a0b]\n                note over Widget,BE: Get Betslip Data [\u65e2\u6709\u6d41\u7a0b]\n                Widget-&gt;&gt;BE: GET /orders/share/[shareCode]\n\n                alt Share API Success\n                    BE--&gt;&gt;Widget: {betslipData: selections}\n\n                    %% \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget,Betslip: \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget: \ud83d\udcd0 Figma: 1.0.8 Success\n                    Widget-&gt;&gt;Betslip: Pop up Betslip (\u8f09\u5165 selections)\n                    note over Betslip: \ud83d\udcd0 Figma: Betslip Success\n                    Betslip-&gt;&gt;User: \u986f\u793a Betslip\n\n                    opt failCnt &gt; 0 (\u90e8\u5206\u8f49\u63db\u5931\u6557)\n                        note over Betslip: \ud83d\udcd0 Figma: Betslip Partial\n                        Betslip-&gt;&gt;User: \u986f\u793a Toast \"\u26a0 X selections failed to convert\"\n                    end\n\n                else Share API Failure\n                    BE--&gt;&gt;Widget: error response\n                    Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n                end\n\n            else Liabilities API Failure\n                BE--&gt;&gt;Widget: error response\n                Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n            end\n\n        else Convert API Error\n            note over Widget: \ud83d\udcd0 Figma: 1.0.6 Error\n            BE--&gt;&gt;Widget: error response\n            Widget-&gt;&gt;User: \u986f\u793a Error \u72c0\u614b (Stop)\n        end\n    end\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#figma-frame","title":"Figma Frame \u5c0d\u61c9\u8868","text":"\u6d41\u7a0b\u968e\u6bb5 Figma Frame Node ID Widget \u72c0\u614b \u8f38\u5165\u6846\u805a\u7126 1.0.1 <code>26769:88868</code> Focus \u6b63\u5728\u8f38\u5165 1.0.2 - Typing \u8f38\u5165\u5b8c\u6210 1.0.4 <code>26453:93265</code> Filled \u8f49\u63db\u4e2d 1.0.5 - Loading \u8f49\u63db\u5931\u6557 1.0.6 - Error \u8f49\u63db\u6210\u529f 1.0.8 <code>26453:93267</code> \u2192 Betslip Betslip \u6210\u529f - <code>26428:71768</code> failCnt == 0 Betslip \u90e8\u5206\u6210\u529f - <code>26428:71769</code> failCnt &gt; 0"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#api","title":"API \u8abf\u7528\u9806\u5e8f","text":"\u9806\u5e8f API Method Figma \u72c0\u614b \u5931\u6557\u8655\u7406 1 <code>/orders/converter/code</code> <code>POST</code> 1.0.5 Loading 1.0.6 Error 2 <code>/bookingCode/[shareCode]/liabilities</code> <code>GET</code> [\u65e2\u6709\u6d41\u7a0b] Betslip \u65e2\u6709\u932f\u8aa4 UI 3 <code>/orders/share/[shareCode]</code> <code>GET</code> [\u65e2\u6709\u6d41\u7a0b] Betslip \u65e2\u6709\u932f\u8aa4 UI"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#2-codebase-level-sequence-diagram","title":"2\ufe0f\u20e3 Codebase-Level Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a Clean Architecture \u5404\u5c64\u4e4b\u9593\u7684\u547c\u53eb\u95dc\u4fc2\u3002</p> <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n    participant CCClient as CodeConverterClient\n    participant ConvertAPI as POST /orders/converter/code\n    participant BSRepo as BetslipRepository (\u65e2\u6709)\n    participant BSClient as BetslipClient (\u65e2\u6709)\n    participant LiabAPI as GET /bookingCode/{shareCode}/liabilities\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Note over Feature: \u6aa2\u67e5 enableCodeConverter&lt;br/&gt;\u5df2\u9078 Bookie + \u8f38\u5165 Code\n\n    Feature-&gt;&gt;Feature: state.inputState = .loading\n    Feature-&gt;&gt;Feature: state.isLoading = true\n\n    Feature-&gt;&gt;UC: execute(input)\n    Note right of Feature: input = ConvertBookingCodeInput&lt;br/&gt;(provider, country, bookingCode)\n\n    %% Step 1: Code2Code \u8f49\u63db\n    UC-&gt;&gt;CCRepo: convertCode(request)\n    CCRepo-&gt;&gt;CCClient: postConvertCode(request)\n    CCClient-&gt;&gt;ConvertAPI: POST request\n    ConvertAPI--&gt;&gt;CCClient: 200 OK with CodeConverterResponseDTO\n    CCClient--&gt;&gt;CCRepo: CodeConverterResponseDTO\n    Note over CCRepo: DTO \u2192 Domain Model\n    CCRepo--&gt;&gt;UC: ConvertResult\n\n    %% Step 2: Liabilities \u6aa2\u67e5 (\u4f7f\u7528 shareCode)\n    UC-&gt;&gt;BSRepo: checkLiabilities(shareCode)\n    BSRepo-&gt;&gt;BSClient: fetchLiabilities(shareCode)\n    BSClient-&gt;&gt;LiabAPI: GET /bookingCode/{shareCode}/liabilities\n    LiabAPI--&gt;&gt;BSClient: 200 OK\n    BSClient--&gt;&gt;BSRepo: LiabilitiesDTO\n    BSRepo--&gt;&gt;UC: LiabilitiesResult\n\n    %% Step 3: \u56de\u50b3\u7d50\u679c\n    UC--&gt;&gt;Feature: .success(ConvertBookingCodeOutput)\n\n    Feature-&gt;&gt;Feature: state.isLoading = false\n    Feature-&gt;&gt;Feature: state.inputState = .filled\n    Feature-&gt;&gt;Feature: state.bookingCode = \"\"\n    Feature-&gt;&gt;Feature: state.convertResult = output.convertResult\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt)\n\n    Note over UI: \u5c0e\u822a\u81f3 Betslip Page</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n    participant CCClient as CodeConverterClient\n    participant ConvertAPI as POST /orders/converter/code\n    participant BSRepo as BetslipRepository (\u65e2\u6709)\n    participant BSClient as BetslipClient (\u65e2\u6709)\n    participant LiabAPI as GET /bookingCode/{shareCode}/liabilities\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Note over Feature: \u6aa2\u67e5 enableCodeConverter&lt;br/&gt;\u5df2\u9078 Bookie + \u8f38\u5165 Code\n\n    Feature-&gt;&gt;Feature: state.inputState = .loading\n    Feature-&gt;&gt;Feature: state.isLoading = true\n\n    Feature-&gt;&gt;UC: execute(input)\n    Note right of Feature: input = ConvertBookingCodeInput&lt;br/&gt;(provider, country, bookingCode)\n\n    %% Step 1: Code2Code \u8f49\u63db\n    UC-&gt;&gt;CCRepo: convertCode(request)\n    CCRepo-&gt;&gt;CCClient: postConvertCode(request)\n    CCClient-&gt;&gt;ConvertAPI: POST request\n    ConvertAPI--&gt;&gt;CCClient: 200 OK with CodeConverterResponseDTO\n    CCClient--&gt;&gt;CCRepo: CodeConverterResponseDTO\n    Note over CCRepo: DTO \u2192 Domain Model\n    CCRepo--&gt;&gt;UC: ConvertResult\n\n    %% Step 2: Liabilities \u6aa2\u67e5 (\u4f7f\u7528 shareCode)\n    UC-&gt;&gt;BSRepo: checkLiabilities(shareCode)\n    BSRepo-&gt;&gt;BSClient: fetchLiabilities(shareCode)\n    BSClient-&gt;&gt;LiabAPI: GET /bookingCode/{shareCode}/liabilities\n    LiabAPI--&gt;&gt;BSClient: 200 OK\n    BSClient--&gt;&gt;BSRepo: LiabilitiesDTO\n    BSRepo--&gt;&gt;UC: LiabilitiesResult\n\n    %% Step 3: \u56de\u50b3\u7d50\u679c\n    UC--&gt;&gt;Feature: .success(ConvertBookingCodeOutput)\n\n    Feature-&gt;&gt;Feature: state.isLoading = false\n    Feature-&gt;&gt;Feature: state.inputState = .filled\n    Feature-&gt;&gt;Feature: state.bookingCode = \"\"\n    Feature-&gt;&gt;Feature: state.convertResult = output.convertResult\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt)\n\n    Note over UI: \u5c0e\u822a\u81f3 Betslip Page\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#api-requestresponse","title":"API Request/Response","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#convert-code-request","title":"Convert Code Request","text":"<pre><code>POST /orders/converter/code\nContent-Type: application/json\nAuthorization: Bearer {token}\n\n{\n  \"provider\": \"bet9ja\",\n  \"country\": \"NG\",\n  \"bookingCode\": \"3RA3FA\"\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#convert-code-response-200-ok","title":"Convert Code Response (200 OK)","text":"<pre><code>{\n  \"bizCode\": 10000,\n  \"message\": \"success\",\n  \"data\": {\n    \"shareCode\": \"FCOM123ABC\",\n    \"successCnt\": 3,\n    \"failCnt\": 1\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#partial-failure","title":"Partial Failure \u6d41\u7a0b","text":"<p>\u7576\u90e8\u5206 selections \u8f49\u63db\u5931\u6557\u6642 (<code>failCnt &gt; 0</code>)\uff1a</p> <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant Betslip as BetslipPage\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt: 2)\n\n    Note over UI: failCnt &gt; 0\uff0c\u986f\u793a Partial Error Toast\n\n    UI-&gt;&gt;UI: \u986f\u793a \"2 selections failed to convert\" Toast\n\n    UI-&gt;&gt;Betslip: \u5c0e\u822a\u81f3 Betslip\uff08\u50c5\u8f09\u5165\u6210\u529f\u7684 selections\uff09</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant Betslip as BetslipPage\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt: 2)\n\n    Note over UI: failCnt &gt; 0\uff0c\u986f\u793a Partial Error Toast\n\n    UI-&gt;&gt;UI: \u986f\u793a \"2 selections failed to convert\" Toast\n\n    UI-&gt;&gt;Betslip: \u5c0e\u822a\u81f3 Betslip\uff08\u50c5\u8f09\u5165\u6210\u529f\u7684 selections\uff09\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#error-handling","title":"Error Handling","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#1-code-not-found-cc002","title":"1. Code Not Found (CC002)","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Feature-&gt;&gt;UC: execute(input)\n\n    UC-&gt;&gt;CCRepo: convertCode(request)\n    CCRepo--&gt;&gt;UC: throw CodeConverterError.codeNotFound(bookieName)\n\n    UC--&gt;&gt;Feature: .failure(CodeConverterError.codeNotFound)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"We couldn't find this booking code on Bet9ja. Please check and try again.\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u986f\u793a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Feature-&gt;&gt;UC: execute(input)\n\n    UC-&gt;&gt;CCRepo: convertCode(request)\n    CCRepo--&gt;&gt;UC: throw CodeConverterError.codeNotFound(bookieName)\n\n    UC--&gt;&gt;Feature: .failure(CodeConverterError.codeNotFound)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"We couldn't find this booking code on Bet9ja. Please check and try again.\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u986f\u793a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#2-all-selections-failed-cc003","title":"2. All Selections Failed (CC003)","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n\n    Note over Feature: convertResult.isAllFailed == true\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"All selections failed to convert\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u986f\u793a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f&lt;br/&gt;\u4e0d\u5c0e\u822a\u81f3 Betslip</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#3-network-error","title":"3. Network Error","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Feature-&gt;&gt;UC: execute(input)\n\n    UC--&gt;&gt;Feature: .failure(NetworkError)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"Network error. Please try again.\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#state","title":"State \u8b8a\u66f4\u5c0d\u7167","text":"\u968e\u6bb5 inputState isLoading bookingCode errorMessage \u9ede\u64ca Load <code>.loading</code> <code>true</code> \"3RA3FA\" <code>nil</code> \u6210\u529f <code>.filled</code> <code>false</code> <code>\"\"</code> <code>nil</code> \u5931\u6557 <code>.error(msg)</code> <code>false</code> \"3RA3FA\" \"We couldn't...\""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#code","title":"Code \u5be6\u4f5c\u53c3\u8003","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#usecase","title":"UseCase","text":"<pre><code>struct ConvertBookingCodeUseCase {\n    @Dependency(\\.codeConverterRepository) var codeConverterRepo\n    @Dependency(\\.betslipRepository) var betslipRepo  // \u65e2\u6709\n\n    func execute(_ input: ConvertBookingCodeInput) async -&gt; Result&lt;ConvertBookingCodeOutput, Error&gt; {\n        do {\n            // Step 1: Code2Code \u8f49\u63db\n            let convertResult = try await codeConverterRepo.convertCode(\n                provider: input.provider,\n                country: input.country,\n                code: input.bookingCode\n            )\n\n            // \u6aa2\u67e5\u662f\u5426\u5168\u90e8\u5931\u6557\n            guard !convertResult.isAllFailed else {\n                throw CodeConverterError.allSelectionsFailed\n            }\n\n            // Step 2: Liabilities \u6aa2\u67e5\uff08\u4f7f\u7528\u8fd4\u56de\u7684 shareCode\uff09\n            let liabilities = try await betslipRepo.checkLiabilities(\n                shareCode: convertResult.shareCode\n            )\n\n            return .success(ConvertBookingCodeOutput(\n                convertResult: convertResult,\n                liabilities: liabilities\n            ))\n        } catch {\n            return .failure(error)\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#inputoutput-model","title":"Input/Output Model","text":"<pre><code>struct ConvertBookingCodeInput {\n    let provider: String\n    let country: String\n    let bookingCode: String\n}\n\nstruct ConvertBookingCodeOutput: Equatable {\n    let convertResult: ConvertResult\n    let liabilities: LiabilitiesResult\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/","title":"Module Sequence Diagram: Bookie Selection","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_1","title":"\u60c5\u5883\u8aaa\u660e","text":"<p>\u7576\u7528\u6236\u5f9e Bookie Selector Sheet \u9078\u64c7 Bookie \u6642\uff0c\u6709\u4e09\u7a2e\u60c5\u6cc1\uff1a</p> <ol> <li>ALL \u570b\u5bb6 Provider\uff1a\u5982 Fcom\uff0cCountry \u9810\u8a2d\u70ba ALL\uff0c\u7121\u9700\u9078\u64c7</li> <li>\u55ae\u4e00\u570b\u5bb6 Bookie\uff1a\u5982 Bet9ja\uff0cCountry \u81ea\u52d5\u9078\u5b9a\uff0c\u7121\u9700\u9078\u64c7</li> <li>\u591a\u570b\u5bb6 Bookie\uff1a\u5982 MSport\uff0c\u9700\u8981\u5148\u9078\u64c7 Country</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#1-user-facing-sequence-diagram","title":"1\ufe0f\u20e3 User-Facing Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a\u5f9e\u7528\u6236\u8996\u89d2\u7684 Bookie \u9078\u64c7\u6d41\u7a0b\uff0c\u5305\u542b Figma \u8a2d\u8a08\u5c0d\u61c9\u3002</p> <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Selector as Bookie Selector Sheet\n    end\n\n    %% Bookie \u9078\u64c7\u6d41\u7a0b\n    rect rgb(255, 250, 240)\n        note over User,Selector: Bookie Selector Sheet \u4e92\u52d5\u6d41\u7a0b\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u958b\u555f\u9078\u55ae (node: 26753:64425)\n\n        alt ALL \u570b\u5bb6 Provider (\u5982 Fcom)\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 (node: 26921:96820)\n            User-&gt;&gt;Selector: \u9078\u64c7 Provider \"Fcom\"\n            note over Selector: Country \u9810\u8a2d\u70ba \"ALL\"\uff0c\u7121\u9700\u9078\u64c7\n            Selector-&gt;&gt;Selector: selectedCountry = \"ALL\"\n        else \u55ae\u4e00\u570b\u5bb6 Provider (\u5982 Bet9ja)\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u55ae\u4e00\u570b\u5bb6 Bookie (node: 26753:64562)\n            User-&gt;&gt;Selector: \u9078\u64c7 Provider \"Bet9ja\"\n            note over Selector: Country \u81ea\u52d5\u9078\u5b9a \"NG\"\uff0c\u7121\u9700\u9078\u64c7\n            Selector-&gt;&gt;Selector: selectedCountry = \"NG\"\n        else \u591a\u570b\u5bb6 Provider (\u5982 MSport)\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u591a\u570b\u5bb6 Bookie (node: 26753:64699)\n            User-&gt;&gt;Selector: \u9078\u64c7 Provider \"MSport\"\n            Selector-&gt;&gt;User: \u5c55\u958b Country \u5217\u8868\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u9078\u64c7 Country (node: 26753:64836)\n            User-&gt;&gt;Selector: \u9078\u64c7 Country \"Ghana\"\n            Selector-&gt;&gt;Selector: selectedCountry = \"GH\"\n        end\n\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 Submit \u6309\u9215 (node: 26921:96820)\n        User-&gt;&gt;Selector: \u9ede\u64ca Submit \u6309\u9215\n\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u7d50\u679c-\u6700\u7d42\u72c0\u614b (node: 26753:85011)\n        Selector--&gt;&gt;Widget: \u95dc\u9589 Sheet + \u56de\u50b3 {provider, country}\n        Widget-&gt;&gt;User: \u66f4\u65b0 Dropdown \u986f\u793a\u5df2\u9078 Provider\n    end</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Selector as Bookie Selector Sheet\n    end\n\n    %% Bookie \u9078\u64c7\u6d41\u7a0b\n    rect rgb(255, 250, 240)\n        note over User,Selector: Bookie Selector Sheet \u4e92\u52d5\u6d41\u7a0b\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u958b\u555f\u9078\u55ae (node: 26753:64425)\n\n        alt ALL \u570b\u5bb6 Provider (\u5982 Fcom)\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 (node: 26921:96820)\n            User-&gt;&gt;Selector: \u9078\u64c7 Provider \"Fcom\"\n            note over Selector: Country \u9810\u8a2d\u70ba \"ALL\"\uff0c\u7121\u9700\u9078\u64c7\n            Selector-&gt;&gt;Selector: selectedCountry = \"ALL\"\n        else \u55ae\u4e00\u570b\u5bb6 Provider (\u5982 Bet9ja)\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u55ae\u4e00\u570b\u5bb6 Bookie (node: 26753:64562)\n            User-&gt;&gt;Selector: \u9078\u64c7 Provider \"Bet9ja\"\n            note over Selector: Country \u81ea\u52d5\u9078\u5b9a \"NG\"\uff0c\u7121\u9700\u9078\u64c7\n            Selector-&gt;&gt;Selector: selectedCountry = \"NG\"\n        else \u591a\u570b\u5bb6 Provider (\u5982 MSport)\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u591a\u570b\u5bb6 Bookie (node: 26753:64699)\n            User-&gt;&gt;Selector: \u9078\u64c7 Provider \"MSport\"\n            Selector-&gt;&gt;User: \u5c55\u958b Country \u5217\u8868\n            note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u9078\u64c7 Country (node: 26753:64836)\n            User-&gt;&gt;Selector: \u9078\u64c7 Country \"Ghana\"\n            Selector-&gt;&gt;Selector: selectedCountry = \"GH\"\n        end\n\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 Submit \u6309\u9215 (node: 26921:96820)\n        User-&gt;&gt;Selector: \u9ede\u64ca Submit \u6309\u9215\n\n        note over Selector: \ud83d\udcd0 Figma: 1.0.3 \u7d50\u679c-\u6700\u7d42\u72c0\u614b (node: 26753:85011)\n        Selector--&gt;&gt;Widget: \u95dc\u9589 Sheet + \u56de\u50b3 {provider, country}\n        Widget-&gt;&gt;User: \u66f4\u65b0 Dropdown \u986f\u793a\u5df2\u9078 Provider\n    end\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#figma-frame","title":"Figma Frame \u5c0d\u61c9\u8868","text":"\u6d41\u7a0b\u968e\u6bb5 Figma Frame Node ID \u958b\u555f\u9078\u55ae 1.0.3 <code>26753:64425</code> \u55ae\u4e00\u570b\u5bb6 Bookie 1.0.3 <code>26753:64562</code> \u591a\u570b\u5bb6 Bookie 1.0.3 <code>26753:64699</code> \u9078\u64c7 Country 1.0.3 <code>26753:64836</code> Click mask to close 1.0.3 <code>26753:64973</code> Submit \u6309\u9215 1.0.3 <code>26921:96820</code> \u7d50\u679c - \u6700\u7d42\u72c0\u614b 1.0.3 <code>26753:85011</code>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#provider","title":"Provider \u985e\u578b\u5c0d\u7167\u8868","text":"\u985e\u578b \u7bc4\u4f8b <code>countries</code> \u503c Country \u9078\u64c7\u884c\u70ba ALL \u570b\u5bb6 Fcom <code>[\"ALL\"]</code> \u9810\u8a2d\u70ba ALL\uff0c\u7121\u9700\u9078\u64c7 \u55ae\u4e00\u570b\u5bb6 Bet9ja <code>[\"NG\"]</code> \u81ea\u52d5\u9078\u5b9a\uff0c\u7121\u9700\u9078\u64c7 \u591a\u570b\u5bb6 MSport <code>[\"NG\", \"GH\", \"UG\", \"ZM\"]</code> \u9700\u8981\u9078\u64c7 Country"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#2-codebase-level-sequence-diagrams","title":"2\ufe0f\u20e3 Codebase-Level Sequence Diagrams","text":"<p>\u6b64\u5716\u5c55\u793a Clean Architecture \u5404\u5c64\u4e4b\u9593\u7684\u547c\u53eb\u95dc\u4fc2\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#1-bookie","title":"\u60c5\u5883 1: \u55ae\u4e00\u570b\u5bb6 Bookie","text":"<pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u9ede\u64ca \"Bet9ja\"&lt;br/&gt;(countries: [\"NG\"])\n\n    UI-&gt;&gt;Feature: .bookieSelected(provider: \"bet9ja\", country: .nigeria)\n\n    Feature-&gt;&gt;State: selectedBookie = SelectedBookie(...)\n    Feature-&gt;&gt;State: selectedCountry = .nigeria (\u5411\u5f8c\u76f8\u5bb9)\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u81ea\u52d5\u95dc\u9589&lt;br/&gt;Dropdown \u986f\u793a \"Bet9ja NG\"</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u9ede\u64ca \"Bet9ja\"&lt;br/&gt;(countries: [\"NG\"])\n\n    UI-&gt;&gt;Feature: .bookieSelected(provider: \"bet9ja\", country: .nigeria)\n\n    Feature-&gt;&gt;State: selectedBookie = SelectedBookie(...)\n    Feature-&gt;&gt;State: selectedCountry = .nigeria (\u5411\u5f8c\u76f8\u5bb9)\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u81ea\u52d5\u95dc\u9589&lt;br/&gt;Dropdown \u986f\u793a \"Bet9ja NG\"\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#2-bookie","title":"\u60c5\u5883 2: \u591a\u570b\u5bb6 Bookie\uff08\u5169\u6b65\u9078\u64c7\uff09","text":"<pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u9ede\u64ca \"Betway\"&lt;br/&gt;(countries: [\"GH\", \"NG\", \"KE\", \"TZ\", \"UG\", \"ZM\"])\n\n    UI-&gt;&gt;UI: \u5207\u63db\u81f3\u570b\u5bb6\u5217\u8868\u986f\u793a\n\n    Note over UI: \u7528\u6236\u9078\u64c7 \"Ghana\"\n\n    UI-&gt;&gt;Feature: .bookieSelected(provider: \"betway\", country: .ghana)\n\n    Feature-&gt;&gt;State: selectedBookie = SelectedBookie(...)\n    Feature-&gt;&gt;State: selectedCountry = .ghana (\u5411\u5f8c\u76f8\u5bb9)\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u95dc\u9589&lt;br/&gt;Dropdown \u986f\u793a \"Betway GH\"</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u9ede\u64ca \"Betway\"&lt;br/&gt;(countries: [\"GH\", \"NG\", \"KE\", \"TZ\", \"UG\", \"ZM\"])\n\n    UI-&gt;&gt;UI: \u5207\u63db\u81f3\u570b\u5bb6\u5217\u8868\u986f\u793a\n\n    Note over UI: \u7528\u6236\u9078\u64c7 \"Ghana\"\n\n    UI-&gt;&gt;Feature: .bookieSelected(provider: \"betway\", country: .ghana)\n\n    Feature-&gt;&gt;State: selectedBookie = SelectedBookie(...)\n    Feature-&gt;&gt;State: selectedCountry = .ghana (\u5411\u5f8c\u76f8\u5bb9)\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u95dc\u9589&lt;br/&gt;Dropdown \u986f\u793a \"Betway GH\"\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#3-all-provider","title":"\u60c5\u5883 3: ALL \u570b\u5bb6 Provider","text":"<pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u9ede\u64ca \"Fcom\"&lt;br/&gt;(countries: [\"ALL\"])\n\n    UI-&gt;&gt;Feature: .bookieSelected(provider: \"fcom\", country: .all)\n\n    Feature-&gt;&gt;State: selectedBookie = SelectedBookie(provider: \"fcom\", name: \"Fcom\", country: .all)\n    Feature-&gt;&gt;State: selectedCountry = .all\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u95dc\u9589&lt;br/&gt;Dropdown \u986f\u793a \"Fcom\"</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u9ede\u64ca \"Fcom\"&lt;br/&gt;(countries: [\"ALL\"])\n\n    UI-&gt;&gt;Feature: .bookieSelected(provider: \"fcom\", country: .all)\n\n    Feature-&gt;&gt;State: selectedBookie = SelectedBookie(provider: \"fcom\", name: \"Fcom\", country: .all)\n    Feature-&gt;&gt;State: selectedCountry = .all\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u95dc\u9589&lt;br/&gt;Dropdown \u986f\u793a \"Fcom\"\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#sheet","title":"Sheet \u95dc\u9589\uff08\u7121\u9078\u64c7\uff09","text":"<pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u5411\u4e0b\u6ed1\u52d5\u95dc\u9589 Sheet\n\n    UI-&gt;&gt;Feature: .bookieSelectorDismissed\n\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u95dc\u9589&lt;br/&gt;\u4fdd\u6301\u539f\u672c\u7684 selectedBookie</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as BookieSelectorSheet\n    participant Feature as LoadCodeWidget.Feature\n    participant State as LoadCodeWidget.State\n\n    Note over UI: \u7528\u6236\u5411\u4e0b\u6ed1\u52d5\u95dc\u9589 Sheet\n\n    UI-&gt;&gt;Feature: .bookieSelectorDismissed\n\n    Feature-&gt;&gt;State: isBookieSelectorPresented = false\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: Sheet \u95dc\u9589&lt;br/&gt;\u4fdd\u6301\u539f\u672c\u7684 selectedBookie\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#state","title":"State \u8b8a\u66f4\u5c0d\u7167","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_2","title":"\u9078\u64c7\u524d","text":"<pre><code>state.selectedBookie = SelectedBookie(provider: \"bet9ja\", name: \"Bet9ja\", country: .nigeria)\nstate.selectedCountry = .nigeria\nstate.isBookieSelectorPresented = true\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#betway-ghana","title":"\u9078\u64c7\u5f8c\uff08\u9078\u64c7 Betway Ghana\uff09","text":"<pre><code>state.selectedBookie = SelectedBookie(provider: \"betway\", name: \"Betway\", country: .ghana)\nstate.selectedCountry = .ghana  // \u5411\u5f8c\u76f8\u5bb9\nstate.isBookieSelectorPresented = false\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#ui","title":"UI \u884c\u70ba\u898f\u683c","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#bookieselectorsheet","title":"BookieSelectorSheet \u884c\u70ba","text":"\u689d\u4ef6 \u884c\u70ba Bookie \u6709 ALL \u570b\u5bb6 \u9ede\u64ca\u5f8c\u76f4\u63a5\u9078\u5b9a\uff0cCountry = ALL Bookie \u53ea\u6709\u55ae\u4e00\u570b\u5bb6 \u9ede\u64ca\u7acb\u5373\u9078\u5b9a\u8a72\u570b\u5bb6 Bookie \u6709\u591a\u500b\u570b\u5bb6 \u9ede\u64ca\u5f8c\u5c55\u958b\u570b\u5bb6\u5217\u8868 \u9ede\u64ca\u570b\u5bb6 \u9078\u5b9a\u8a72\u570b\u5bb6 \u9ede\u64ca Submit \u6309\u9215 \u95dc\u9589 Sheet\uff0c\u56de\u50b3\u9078\u64c7\u7d50\u679c \u5411\u4e0b\u6ed1\u52d5 \u95dc\u9589 Sheet\uff08\u4e0d\u6539\u8b8a\u9078\u64c7\uff09 \u9ede\u64ca\u80cc\u666f (mask) \u95dc\u9589 Sheet\uff08\u4e0d\u6539\u8b8a\u9078\u64c7\uff09"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#dropdown","title":"Dropdown \u986f\u793a\u898f\u5247","text":"\u689d\u4ef6 \u986f\u793a ALL \u570b\u5bb6 <code>{Name}</code> (\u4e0d\u986f\u793a\u570b\u5bb6) \u540d\u7a31 \u2264 12 \u5b57\u5143 <code>{Name} {Country}</code> \u540d\u7a31 &gt; 12 \u5b57\u5143 <code>{Name\u524d12\u5b57}\u2026 {Country}</code> <p>\u7bc4\u4f8b\uff1a - <code>Fcom</code> (ALL \u570b\u5bb6) - <code>Bet9ja NG</code> - <code>SportyBet GH</code> - <code>Bookie Longna\u2026 NG</code></p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#view","title":"View \u5be6\u4f5c\u53c3\u8003","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#bookieselectorsheet_1","title":"BookieSelectorSheet","text":"<pre><code>struct BookieSelectorSheet: View {\n    let providerConfigs: [ProviderConfig]\n    let onSelect: (String, CountryCode) -&gt; Void\n    let onDismiss: () -&gt; Void\n\n    @State private var expandedProvider: String? = nil\n    @State private var selectedProvider: ProviderConfig? = nil\n    @State private var selectedCountry: CountryCode? = nil\n\n    var body: some View {\n        NavigationStack {\n            List {\n                ForEach(providerConfigs) { config in\n                    if config.isAllCountry {\n                        // ALL \u570b\u5bb6\uff1a\u76f4\u63a5\u53ef\u9078\n                        BookieRow(config: config, isSelected: selectedProvider?.provider == config.provider)\n                            .onTapGesture {\n                                selectedProvider = config\n                                selectedCountry = .all\n                            }\n                    } else if config.isSingleCountry {\n                        // \u55ae\u4e00\u570b\u5bb6\uff1a\u76f4\u63a5\u53ef\u9078\n                        BookieRow(config: config, isSelected: selectedProvider?.provider == config.provider)\n                            .onTapGesture {\n                                selectedProvider = config\n                                selectedCountry = config.countries[0]\n                            }\n                    } else {\n                        // \u591a\u570b\u5bb6\uff1a\u53ef\u5c55\u958b\n                        DisclosureGroup(\n                            isExpanded: Binding(\n                                get: { expandedProvider == config.provider },\n                                set: { if $0 { expandedProvider = config.provider } }\n                            )\n                        ) {\n                            ForEach(config.countries, id: \\.self) { country in\n                                CountryRow(country: country, isSelected: selectedCountry == country)\n                                    .onTapGesture {\n                                        selectedProvider = config\n                                        selectedCountry = country\n                                    }\n                            }\n                        } label: {\n                            BookieRow(config: config, isSelected: selectedProvider?.provider == config.provider)\n                        }\n                    }\n                }\n            }\n            .navigationTitle(\"Select Bookie\")\n            .navigationBarTitleDisplayMode(.inline)\n            .toolbar {\n                ToolbarItem(placement: .cancellationAction) {\n                    Button(\"Cancel\", action: onDismiss)\n                }\n                ToolbarItem(placement: .confirmationAction) {\n                    Button(\"Submit\") {\n                        if let provider = selectedProvider, let country = selectedCountry {\n                            onSelect(provider.provider, country)\n                        }\n                    }\n                    .disabled(selectedProvider == nil || selectedCountry == nil)\n                }\n            }\n        }\n        .presentationDetents([.medium, .large])\n        .presentationDragIndicator(.visible)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#reducer","title":"Reducer","text":"<pre><code>case let .bookieSelected(provider, country):\n    guard let config = state.providerConfigs.first(where: { $0.provider == provider }) else {\n        return .none\n    }\n\n    state.selectedBookie = SelectedBookie(\n        provider: provider,\n        name: config.name,\n        country: country\n    )\n    state.isBookieSelectorPresented = false\n\n    // \u5411\u5f8c\u76f8\u5bb9\uff1a\u540c\u6b65\u66f4\u65b0 selectedCountry\n    if let region = Region.from(countryCode: country) {\n        state.selectedCountry = region\n    }\n\n    return .none\n\ncase .bookieSelectorDismissed:\n    state.isBookieSelectorPresented = false\n    return .none\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/","title":"06_Feature State and Action (TCA)","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 LoadCodeWidgetFeature \u7684 State \u548c Action\u3002</p>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_feature_state_action.md Feature State \u548c Action \u5b9a\u7fa9"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/","title":"Feature State and Action (TCA)","text":""},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#loadcodewidgetfeature-loadbookingcodesectionfeature","title":"LoadCodeWidget.Feature\uff08\u64f4\u5c55\u81ea LoadBookingCodeSection.Feature\uff09","text":""},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#_1","title":"\u5fa9\u7528\u7b56\u7565","text":"<pre><code>// \u4fdd\u6301\u5411\u5f8c\u76f8\u5bb9\u7684\u65b9\u5f0f\uff1a\n// 1. State \u65b0\u589e\u5c6c\u6027\u90fd\u6709 default value\n// 2. Action \u65b0\u589e case \u4e0d\u5f71\u97ff\u65e2\u6709\u908f\u8f2f\n// 3. \u53ef\u9078\u64c7\u6027\u555f\u7528 Code Converter \u529f\u80fd\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#state","title":"State\uff08\u64f4\u5c55\uff09","text":"<pre><code>@ObservableState\nstruct State: Equatable {\n    // ========== \u539f\u6709\u5c6c\u6027\uff08\u4fdd\u6301\u76f8\u5bb9\uff09 ==========\n    var bookingCode: String = \"\"\n    var selectedCountry: Region = .current\n    var isLoading: Bool = false\n    var contentState: SectionContentState = .loaded\n    var availableCountries: [Region] = [.ghana, .nigeria]\n\n    // ========== \u65b0\u589e\u5c6c\u6027\uff08Code Converter\uff09 ==========\n\n    /// \u662f\u5426\u555f\u7528 Code Converter \u529f\u80fd\uff08\u5411\u5f8c\u76f8\u5bb9\u958b\u95dc\uff09\n    var enableCodeConverter: Bool = true\n\n    /// \u5df2\u9078\u64c7\u7684 Bookie\uff08\u5305\u542b provider + country\uff09\n    var selectedBookie: SelectedBookie?\n\n    /// Provider Config \u5217\u8868\uff08\u5f9e API \u53d6\u5f97\uff09\n    var providerConfigs: [ProviderConfig] = []\n\n    /// Widget \u8f38\u5165\u72c0\u614b\uff086 \u7a2e\u72c0\u614b\uff09\n    var inputState: WidgetInputState = .default\n\n    /// Bookie \u9078\u64c7\u5668\u662f\u5426\u986f\u793a\n    var isBookieSelectorPresented: Bool = false\n\n    /// \u932f\u8aa4\u8a0a\u606f\n    var errorMessage: String?\n\n    /// \u8f49\u63db\u7d50\u679c\n    var convertResult: ConvertResult?\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#state_1","title":"State \u5c6c\u6027\u8aaa\u660e","text":"\u5c6c\u6027 \u985e\u578b \u539f\u6709/\u65b0\u589e \u9810\u8a2d\u503c \u8aaa\u660e <code>bookingCode</code> String \u2705 \u539f\u6709 <code>\"\"</code> \u8f38\u5165\u7684 Booking Code <code>selectedCountry</code> Region \u2705 \u539f\u6709 <code>.current</code> \u9078\u64c7\u7684\u570b\u5bb6 <code>isLoading</code> Bool \u2705 \u539f\u6709 <code>false</code> Loading \u72c0\u614b <code>contentState</code> SectionContentState \u2705 \u539f\u6709 <code>.loaded</code> Section \u72c0\u614b <code>availableCountries</code> [Region] \u2705 \u539f\u6709 <code>[.ghana, .nigeria]</code> \u53ef\u7528\u570b\u5bb6 <code>enableCodeConverter</code> Bool \ud83c\udd95 \u65b0\u589e <code>true</code> \u662f\u5426\u555f\u7528 Code Converter <code>selectedBookie</code> SelectedBookie? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u5df2\u9078 Bookie <code>providerConfigs</code> [ProviderConfig] \ud83c\udd95 \u65b0\u589e <code>[]</code> Provider \u8a2d\u5b9a <code>inputState</code> WidgetInputState \ud83c\udd95 \u65b0\u589e <code>.default</code> 6 \u7a2e\u8f38\u5165\u72c0\u614b <code>isBookieSelectorPresented</code> Bool \ud83c\udd95 \u65b0\u589e <code>false</code> Sheet \u986f\u793a <code>errorMessage</code> String? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u932f\u8aa4\u8a0a\u606f <code>convertResult</code> ConvertResult? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u8f49\u63db\u7d50\u679c"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#action","title":"Action\uff08\u64f4\u5c55\uff09","text":"<pre><code>@CasePathable\nenum Action: Equatable {\n    // ========== \u539f\u6709 Action\uff08\u4fdd\u6301\u76f8\u5bb9\uff09 ==========\n    case onAppear\n    case bookingCodeChanged(String)\n    case countrySelected(Region)\n    case loadBookingCode\n    case bookingCodeLoadFailed(String)\n    case bookingCodeLoaded(LoadCodeModel.CodeResult)\n\n    // ========== \u65b0\u589e Action\uff08Code Converter\uff09 ==========\n\n    // UI Actions\n    case bookieDropdownTapped\n    case bookieSelectorDismissed\n    case bookieSelected(provider: String, country: CountryCode)\n    case inputFocused\n    case inputBlurred\n    case clearButtonTapped\n\n    // Response Actions\n    case providerConfigLoaded(Result&lt;[ProviderConfig], Error&gt;)\n    case convertCodeCompleted(Result&lt;ConvertBookingCodeOutput, Error&gt;)\n\n    // Navigation Actions\n    case presentBetslip(shareCode: String, failCnt: Int)\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#action_1","title":"Action \u5c0d\u7167\u8868","text":"Action \u539f\u6709/\u65b0\u589e \u89f8\u767c\u6642\u6a5f \u5c0d\u61c9 UseCase <code>.onAppear</code> \u2705 \u539f\u6709 \u9801\u9762\u51fa\u73fe - <code>.bookingCodeChanged</code> \u2705 \u539f\u6709 \u8f38\u5165\u8b8a\u66f4 - <code>.countrySelected</code> \u2705 \u539f\u6709 \u9078\u64c7\u570b\u5bb6\uff08\u539f\u6d41\u7a0b\uff09 - <code>.loadBookingCode</code> \u2705 \u539f\u6709 \u8f09\u5165\uff08\u539f\u6d41\u7a0b\uff09 LoadCodeManager <code>.bookingCodeLoadFailed</code> \u2705 \u539f\u6709 \u8f09\u5165\u5931\u6557\uff08\u539f\u6d41\u7a0b\uff09 - <code>.bookingCodeLoaded</code> \u2705 \u539f\u6709 \u8f09\u5165\u6210\u529f\uff08\u539f\u6d41\u7a0b\uff09 - <code>.bookieDropdownTapped</code> \ud83c\udd95 \u65b0\u589e \u9ede\u64ca Bookie Dropdown LoadProviderConfigUseCase <code>.bookieSelectorDismissed</code> \ud83c\udd95 \u65b0\u589e \u95dc\u9589 Sheet - <code>.bookieSelected</code> \ud83c\udd95 \u65b0\u589e \u9078\u64c7 Bookie + Country - <code>.inputFocused</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u805a\u7126 - <code>.inputBlurred</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u5931\u7126 - <code>.clearButtonTapped</code> \ud83c\udd95 \u65b0\u589e \u9ede\u64ca\u6e05\u9664\u6309\u9215 - <code>.providerConfigLoaded</code> \ud83c\udd95 \u65b0\u589e Config \u8f09\u5165\u5b8c\u6210 - <code>.convertCodeCompleted</code> \ud83c\udd95 \u65b0\u589e \u8f49\u63db\u5b8c\u6210 - <code>.presentBetslip</code> \ud83c\udd95 \u65b0\u589e \u8f09\u5165 Betslip -"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#reducer","title":"Reducer\uff08\u64f4\u5c55\uff09","text":"<pre><code>@Reducer\nstruct Feature: Reducer {\n    typealias State = LoadCodeWidget.State\n    typealias Action = LoadCodeWidget.Action\n\n    @Dependency(\\.currentRegion) var currentRegion\n    @Dependency(\\.loadProviderConfigUseCase) var loadProviderConfigUseCase\n    @Dependency(\\.convertBookingCodeUseCase) var convertBookingCodeUseCase\n\n    private let manager: LoadCodeManager\n\n    init(manager: LoadCodeManager = .init()) {\n        self.manager = manager\n    }\n\n    var body: some ReducerOf&lt;Self&gt; {\n        Reduce { state, action in\n            switch action {\n            // ========== \u539f\u6709\u908f\u8f2f\uff08\u4fdd\u6301\u4e0d\u8b8a\uff09 ==========\n            case .onAppear:\n                if state.availableCountries.contains(currentRegion) {\n                    state.selectedCountry = currentRegion\n                } else {\n                    state.selectedCountry = state.availableCountries.first ?? .nigeria\n                }\n                // \u65b0\u589e\uff1a\u5982\u679c\u555f\u7528 Code Converter\uff0c\u8a2d\u7f6e\u9810\u8a2d Bookie\n                if state.enableCodeConverter, let firstConfig = state.providerConfigs.first {\n                    state.selectedBookie = SelectedBookie(from: firstConfig)\n                }\n                return .none\n\n            case .bookingCodeChanged(let rawCode):\n                let filteredCode = manager.filterBookingCode(rawCode)\n                state.bookingCode = filteredCode\n                // \u65b0\u589e\uff1a\u66f4\u65b0 inputState\n                if state.enableCodeConverter {\n                    state.inputState = filteredCode.isEmpty ? .focus : .typing\n                    state.errorMessage = nil // \u6e05\u9664\u932f\u8aa4\n                }\n                return .none\n\n            case .countrySelected(let country):\n                state.selectedCountry = country\n                return .none\n\n            case .loadBookingCode:\n                guard !state.bookingCode.isEmpty else {\n                    return .run { send in\n                        await send(.bookingCodeLoadFailed(\"Empty Code\"))\n                    }\n                }\n\n                // \u65b0\u589e\uff1a\u6839\u64da\u662f\u5426\u555f\u7528 Code Converter \u6c7a\u5b9a\u6d41\u7a0b\n                if state.enableCodeConverter, let bookie = state.selectedBookie {\n                    // Code Converter \u6d41\u7a0b\n                    state.inputState = .loading\n                    state.isLoading = true\n\n                    let input = ConvertBookingCodeInput(\n                        provider: bookie.provider,\n                        country: bookie.country.rawValue,\n                        bookingCode: state.bookingCode\n                    )\n                    return .run { send in\n                        let result = await convertBookingCodeUseCase.execute(input)\n                        await send(.convertCodeCompleted(result))\n                    }\n                } else {\n                    // \u539f\u6709\u6d41\u7a0b\n                    state.isLoading = true\n                    state.contentState = .loaded\n\n                    return .run { [bookingCode = state.bookingCode, \n                                   country = state.selectedCountry] send in\n                        do {\n                            let result = try await manager.loadBookingCodeData(\n                                shareCode: bookingCode, \n                                countryCode: country.apiCountryCode\n                            )\n                            await send(.bookingCodeLoaded(result))\n                        } catch {\n                            await send(.bookingCodeLoadFailed(manager.mapErrorToMessage(error)))\n                        }\n                    }\n                }\n\n            case .bookingCodeLoadFailed(let message):\n                state.isLoading = false\n                if state.enableCodeConverter {\n                    state.inputState = .error(message: message)\n                    state.errorMessage = message\n                }\n                return .none\n\n            case .bookingCodeLoaded:\n                state.isLoading = false\n                state.bookingCode = \"\"\n                if state.enableCodeConverter {\n                    state.inputState = .default\n                }\n                return .none\n\n            // ========== \u65b0\u589e\u908f\u8f2f\uff08Code Converter\uff09 ==========\n            case .bookieDropdownTapped:\n                return .run { send in\n                    let result = await loadProviderConfigUseCase.execute()\n                    await send(.providerConfigLoaded(result))\n                }\n\n            case .bookieSelectorDismissed:\n                state.isBookieSelectorPresented = false\n                return .none\n\n            case let .bookieSelected(provider, country):\n                guard let config = state.providerConfigs.first(where: { $0.provider == provider }) else {\n                    return .none\n                }\n                state.selectedBookie = SelectedBookie(\n                    provider: provider,\n                    name: config.name,\n                    country: country\n                )\n                state.isBookieSelectorPresented = false\n                // \u540c\u6b65\u66f4\u65b0 selectedCountry\uff08\u5411\u5f8c\u76f8\u5bb9\uff09\n                if let region = Region.from(countryCode: country) {\n                    state.selectedCountry = region\n                }\n                return .none\n\n            case .inputFocused:\n                state.inputState = .focus\n                return .none\n\n            case .inputBlurred:\n                if state.bookingCode.isEmpty {\n                    state.inputState = .default\n                } else {\n                    state.inputState = .filled\n                }\n                return .none\n\n            case .clearButtonTapped:\n                state.bookingCode = \"\"\n                state.inputState = .focus\n                state.errorMessage = nil\n                return .none\n\n            case let .providerConfigLoaded(.success(configs)):\n                state.providerConfigs = configs\n                state.isBookieSelectorPresented = true\n                // \u540c\u6b65\u66f4\u65b0 availableCountries\uff08\u5411\u5f8c\u76f8\u5bb9\uff09\n                state.availableCountries = configs.flatMap { $0.regions }\n                return .none\n\n            case let .providerConfigLoaded(.failure(error)):\n                state.errorMessage = error.localizedDescription\n                return .none\n\n            case let .convertCodeCompleted(.success(output)):\n                state.isLoading = false\n                state.inputState = .filled\n                state.convertResult = output.convertResult\n                state.bookingCode = \"\" // \u6e05\u7a7a\u8f38\u5165\n                return .send(.presentBetslip(\n                    shareCode: output.convertResult.shareCode,\n                    failCnt: output.convertResult.failCnt\n                ))\n\n            case let .convertCodeCompleted(.failure(error)):\n                state.isLoading = false\n                let message = (error as? CodeConverterError)?.localizedDescription ?? error.localizedDescription\n                state.inputState = .error(message: message)\n                state.errorMessage = message\n                return .none\n\n            case .presentBetslip:\n                // \u7531\u5916\u90e8\u8655\u7406 Betslip \u5c0e\u822a\n                return .none\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#computed-properties","title":"Computed Properties","text":"<pre><code>extension LoadCodeWidget.State {\n    /// Load \u6309\u9215\u662f\u5426\u555f\u7528\n    var isLoadButtonEnabled: Bool {\n        guard !bookingCode.isEmpty else { return false }\n        if enableCodeConverter {\n            return selectedBookie != nil &amp;&amp; inputState.isLoadButtonEnabled\n        }\n        return true\n    }\n\n    /// Dropdown \u986f\u793a\u6587\u5b57\n    var dropdownDisplayText: String {\n        if enableCodeConverter, let bookie = selectedBookie {\n            return bookie.displayText\n        }\n        return selectedCountry.description\n    }\n\n    /// \u662f\u5426\u986f\u793a\u6e05\u9664\u6309\u9215\n    var showClearButton: Bool {\n        !bookingCode.isEmpty &amp;&amp; (inputState == .typing || inputState == .filled || inputState.isError)\n    }\n\n    /// Loading \u63d0\u793a\u6587\u5b57\n    var loadingHintText: String? {\n        guard inputState == .loading else { return nil }\n        return \"Conversion may take up to 10 seconds, please stay here and wait for the result.\"\n    }\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/","title":"07_UseCase Input and Output Model","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 UseCase \u7684 Input \u548c Output Model\u3002</p>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_usecase_input_output.md UseCase Input/Output Model \u5b9a\u7fa9"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/","title":"UseCase Input and Output Model","text":""},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#loadproviderconfigusecase","title":"LoadProviderConfigUseCase","text":""},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#input-model","title":"Input Model","text":"<pre><code>struct LoadProviderConfigInput: Equatable {\n    // \u7121\u53c3\u6578\n}\n</code></pre> <p>\u8aaa\u660e\uff1a\u6b64 UseCase \u4e0d\u9700\u8981\u4efb\u4f55\u8f38\u5165\u53c3\u6578\uff0c\u76f4\u63a5\u53d6\u5f97\u6240\u6709\u53ef\u7528\u7684 Provider Config\u3002</p>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#output-model","title":"Output Model","text":"<pre><code>struct LoadProviderConfigOutput: Equatable {\n    let providerConfigs: [ProviderConfig]\n}\n</code></pre> \u5c6c\u6027 \u985e\u578b \u8aaa\u660e <code>providerConfigs</code> <code>[ProviderConfig]</code> \u6240\u6709\u53ef\u7528\u7684 Provider \u8a2d\u5b9a\u5217\u8868"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#usecase","title":"UseCase \u5b9a\u7fa9","text":"<pre><code>protocol LoadProviderConfigUseCaseProtocol {\n    func execute() async -&gt; Result&lt;LoadProviderConfigOutput, Error&gt;\n}\n\nstruct LoadProviderConfigUseCase: LoadProviderConfigUseCaseProtocol {\n    let repository: CodeConverterRepositoryProtocol\n\n    func execute() async -&gt; Result&lt;LoadProviderConfigOutput, Error&gt; {\n        do {\n            let configs = try await repository.getProviderCountryConfig()\n            return .success(LoadProviderConfigOutput(providerConfigs: configs))\n        } catch {\n            return .failure(error)\n        }\n    }\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#convertbookingcodeusecase","title":"ConvertBookingCodeUseCase","text":""},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#input-model_1","title":"Input Model","text":"<pre><code>struct ConvertBookingCodeInput: Equatable {\n    let provider: String\n    let country: String\n    let bookingCode: String\n}\n</code></pre> \u5c6c\u6027 \u985e\u578b \u8aaa\u660e <code>provider</code> <code>String</code> \u7af6\u54c1 Provider \u4ee3\u78bc\uff08\u5982 bet9ja\uff09 <code>country</code> <code>String</code> \u570b\u5bb6\u4ee3\u78bc\uff08\u5982 NG\uff09 <code>bookingCode</code> <code>String</code> \u7af6\u54c1 Booking Code"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#output-model_1","title":"Output Model","text":"<pre><code>struct ConvertBookingCodeOutput: Equatable {\n    let convertResult: ConvertResult\n    let betslipData: BetslipData\n}\n</code></pre> \u5c6c\u6027 \u985e\u578b \u8aaa\u660e <code>convertResult</code> <code>ConvertResult</code> \u8f49\u63db\u7d50\u679c\uff08shareCode, successCnt, failCnt\uff09 <code>betslipData</code> <code>BetslipData</code> Betslip \u8cc7\u6599\uff08\u65e2\u6709 Domain Model\uff09"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#usecase_1","title":"UseCase \u5b9a\u7fa9","text":"<pre><code>protocol ConvertBookingCodeUseCaseProtocol {\n    func execute(_ input: ConvertBookingCodeInput) async -&gt; Result&lt;ConvertBookingCodeOutput, Error&gt;\n}\n\nstruct ConvertBookingCodeUseCase: ConvertBookingCodeUseCaseProtocol {\n    let codeConverterRepository: CodeConverterRepositoryProtocol\n    let betslipRepository: BetslipRepositoryProtocol\n\n    func execute(_ input: ConvertBookingCodeInput) async -&gt; Result&lt;ConvertBookingCodeOutput, Error&gt; {\n        do {\n            // 1. \u8f49\u63db Booking Code\n            let convertResult = try await codeConverterRepository.convertCode(\n                provider: input.provider,\n                country: input.country,\n                bookingCode: input.bookingCode\n            )\n\n            // 2. \u6aa2\u67e5 Liabilities\uff08\u65e2\u6709\u6d41\u7a0b\uff09\n            _ = try await betslipRepository.checkLiabilities(shareCode: convertResult.shareCode)\n\n            // 3. \u53d6\u5f97 Betslip Data\uff08\u65e2\u6709\u6d41\u7a0b\uff09\n            let betslipData = try await betslipRepository.getBetslipData(shareCode: convertResult.shareCode)\n\n            return .success(ConvertBookingCodeOutput(\n                convertResult: convertResult,\n                betslipData: betslipData\n            ))\n        } catch {\n            return .failure(error)\n        }\n    }\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#error-types","title":"Error Types","text":"<pre><code>enum CodeConverterError: Error, Equatable {\n    case invalidParameter\n    case codeNotFound(bookieName: String)\n    case providerNotSupported\n    case countryNotSupported\n    case timeout\n    case internalError\n    case unknown\n\n    var localizedDescription: String {\n        switch self {\n        case .invalidParameter:\n            return \"Invalid parameter\"\n        case .codeNotFound(let bookieName):\n            return \"We couldn't find this booking code on \\(bookieName). Please check and try again.\"\n        case .providerNotSupported:\n            return \"Provider not supported\"\n        case .countryNotSupported:\n            return \"Country not supported\"\n        case .timeout:\n            return \"Request timeout. Please try again.\"\n        case .internalError:\n            return \"Internal error. Please try again later.\"\n        case .unknown:\n            return \"An unknown error occurred\"\n        }\n    }\n\n    static func from(bizCode: Int, bookieName: String = \"\") -&gt; CodeConverterError {\n        switch bizCode {\n        case 10001: return .invalidParameter\n        case 10002: return .codeNotFound(bookieName: bookieName)\n        case 10003: return .providerNotSupported\n        case 10004: return .countryNotSupported\n        case 10005: return .timeout\n        case 10006: return .internalError\n        default: return .unknown\n        }\n    }\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#dependency-injection","title":"Dependency Injection","text":"<pre><code>extension DependencyValues {\n    var loadProviderConfigUseCase: LoadProviderConfigUseCaseProtocol {\n        get { self[LoadProviderConfigUseCaseKey.self] }\n        set { self[LoadProviderConfigUseCaseKey.self] = newValue }\n    }\n\n    var convertBookingCodeUseCase: ConvertBookingCodeUseCaseProtocol {\n        get { self[ConvertBookingCodeUseCaseKey.self] }\n        set { self[ConvertBookingCodeUseCaseKey.self] = newValue }\n    }\n}\n\nprivate enum LoadProviderConfigUseCaseKey: DependencyKey {\n    static let liveValue: LoadProviderConfigUseCaseProtocol = LoadProviderConfigUseCase(\n        repository: CodeConverterRepository()\n    )\n}\n\nprivate enum ConvertBookingCodeUseCaseKey: DependencyKey {\n    static let liveValue: ConvertBookingCodeUseCaseProtocol = ConvertBookingCodeUseCase(\n        codeConverterRepository: CodeConverterRepository(),\n        betslipRepository: BetslipRepository()\n    )\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/","title":"08_API Spec and Mapping","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter \u76f8\u95dc API \u898f\u683c\u53ca DTO \u2192 Domain Model Mapping\u3002</p>"},{"location":"08_API%20Spec%20and%20Mapping/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_api_spec.md API Endpoints \u898f\u683c 02_dto_mapping.md DTO \u2192 Domain Model Mapping"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/","title":"API Spec","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api","title":"\u65b0\u589e API","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#1-get-provider-country-config","title":"1. Get Provider Country Config","text":"\u9805\u76ee \u8aaa\u660e Method <code>GET</code> Endpoint <code>/orders/converter/config/providerCountries</code> Description \u53d6\u5f97\u652f\u63f4\u7684 Provider \u53ca\u5176\u5c0d\u61c9\u7684\u570b\u5bb6\u8a2d\u5b9a \u6240\u5c6c Client CodeConverterClient \u6240\u5c6c Repository CodeConverterRepository \u6240\u5c6c UseCase LoadProviderConfigUseCase"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#request","title":"Request","text":"<p>\u7121\u53c3\u6578</p>"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#response","title":"Response","text":"<pre><code>{\n  \"bizCode\": 10000,\n  \"message\": \"SUCCESS\",\n  \"data\": [\n    {\n      \"provider\": \"fcom\",\n      \"name\": \"F.com\",\n      \"countries\": [\"ALL\"]\n    },\n    {\n      \"provider\": \"bet9ja\",\n      \"name\": \"Bet9ja\",\n      \"countries\": [\"NG\"]\n    },\n    {\n      \"provider\": \"msport\",\n      \"name\": \"MSport\",\n      \"countries\": [\"NG\", \"GH\", \"UG\", \"ZM\"]\n    }\n  ]\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#2-convert-code2code","title":"2. Convert Code2Code","text":"\u9805\u76ee \u8aaa\u660e Method <code>POST</code> Endpoint <code>/orders/converter/code</code> Description \u5c07\u7af6\u54c1 Booking Code \u8f49\u63db\u70ba Fcom Share Code \u6240\u5c6c Client CodeConverterClient \u6240\u5c6c Repository CodeConverterRepository \u6240\u5c6c UseCase ConvertBookingCodeUseCase"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#headers","title":"Headers","text":"Field Type Required Description <code>uid</code> String Optional User ID <code>OperId</code> String Optional Operator ID"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#request-body","title":"Request Body","text":"<pre><code>{\n  \"provider\": \"bet9ja\",\n  \"country\": \"NG\",\n  \"bookingCode\": \"3RA3FA\"\n}\n</code></pre> Field Type Required Description <code>provider</code> String \u2705 \u7af6\u54c1 Provider Code <code>country</code> String \u2705 Country Code <code>bookingCode</code> String \u2705 \u7af6\u54c1 Booking Code"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#response-success","title":"Response - Success","text":"<pre><code>{\n  \"bizCode\": 10000,\n  \"message\": \"SUCCESS\",\n  \"data\": {\n    \"shareCode\": \"ABC123\",\n    \"successCnt\": 5,\n    \"failCnt\": 1\n  }\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api_1","title":"\u65e2\u6709 API\uff08\u5fa9\u7528\uff09","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#3-check-liabilities","title":"3. Check Liabilities","text":"\u9805\u76ee \u8aaa\u660e Method <code>GET</code> Endpoint <code>/bookingCode/{shareCode}/liabilities</code> Description \u6aa2\u67e5 Share Code \u7684 Liabilities \u6240\u5c6c Client BetslipClient\uff08\u65e2\u6709\uff09 \u6240\u5c6c Repository BetslipRepository\uff08\u65e2\u6709\uff09"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#4-get-share-order","title":"4. Get Share Order","text":"\u9805\u76ee \u8aaa\u660e Method <code>GET</code> Endpoint <code>/orders/share/{shareCode}</code> Description \u53d6\u5f97 Share Code \u5c0d\u61c9\u7684 Betslip Data \u6240\u5c6c Client BetslipClient\uff08\u65e2\u6709\uff09 \u6240\u5c6c Repository BetslipRepository\uff08\u65e2\u6709\uff09"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#error-codes","title":"Error Codes","text":"bizCode message Description 10000 SUCCESS \u8acb\u6c42\u6210\u529f 10001 INVALID_PARAMETER \u53c3\u6578\u932f\u8aa4 10002 CODE_NOT_FOUND \u627e\u4e0d\u5230\u6307\u5b9a\u7684 Booking Code 10003 PROVIDER_NOT_SUPPORTED \u4e0d\u652f\u63f4\u7684 Provider 10004 COUNTRY_NOT_SUPPORTED \u4e0d\u652f\u63f4\u7684 Country 10005 TIMEOUT \u8acb\u6c42\u903e\u6642 10006 INTERNAL_ERROR \u5167\u90e8\u932f\u8aa4"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api_2","title":"API \u8abf\u7528\u9806\u5e8f","text":"\u9806\u5e8f API \u6642\u6a5f 1 GET <code>/orders/converter/config/providerCountries</code> \u9ede\u64ca Bookie Dropdown 2 POST <code>/orders/converter/code</code> \u9ede\u64ca Load \u6309\u9215 3 GET <code>/bookingCode/{shareCode}/liabilities</code> \u8f49\u63db\u6210\u529f\u5f8c 4 GET <code>/orders/share/{shareCode}</code> Liabilities \u6aa2\u67e5\u5f8c"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/","title":"DTO \u2192 Domain Model Mapping","text":""},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#dto","title":"DTO \u5b9a\u7fa9","text":""},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#providercountryconfigdto","title":"ProviderCountryConfigDTO","text":"<pre><code>struct ProviderCountryConfigResponse: Decodable {\n    let bizCode: Int\n    let message: String\n    let data: [ProviderCountryConfigDTO]?\n}\n\nstruct ProviderCountryConfigDTO: Decodable {\n    let provider: String\n    let name: String\n    let countries: [String]\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#code2codedto","title":"Code2CodeDTO","text":"<pre><code>struct Code2CodeResponse: Decodable {\n    let bizCode: Int\n    let message: String\n    let innerMsg: String?\n    let data: Code2CodeDataDTO?\n}\n\nstruct Code2CodeDataDTO: Decodable {\n    let shareCode: String\n    let successCnt: Int\n    let failCnt: Int\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#code2coderequestdto","title":"Code2CodeRequestDTO","text":"<pre><code>struct Code2CodeRequestDTO: Encodable {\n    let provider: String\n    let country: String\n    let bookingCode: String\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#mapping","title":"Mapping \u898f\u5247","text":""},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#providercountryconfigdto-providerconfig","title":"ProviderCountryConfigDTO \u2192 ProviderConfig","text":"DTO \u6b04\u4f4d Domain Model \u6b04\u4f4d \u8f49\u63db\u908f\u8f2f <code>provider</code> <code>provider</code> \u76f4\u63a5\u5c0d\u61c9 <code>name</code> <code>name</code> \u76f4\u63a5\u5c0d\u61c9 <code>countries</code> <code>countries</code> String[] \u2192 [CountryCode]\uff0c\u904e\u6ffe\u7121\u6548\u503c <p>\u5be6\u4f5c\uff1a</p> <pre><code>extension ProviderConfig {\n    init(from dto: ProviderCountryConfigDTO) {\n        self.provider = dto.provider\n        self.name = dto.name\n        self.countries = dto.countries.compactMap { CountryCode(rawValue: $0) }\n    }\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#code2codedatadto-convertresult","title":"Code2CodeDataDTO \u2192 ConvertResult","text":"DTO \u6b04\u4f4d Domain Model \u6b04\u4f4d \u8f49\u63db\u908f\u8f2f <code>shareCode</code> <code>shareCode</code> \u76f4\u63a5\u5c0d\u61c9 <code>successCnt</code> <code>successCnt</code> \u76f4\u63a5\u5c0d\u61c9 <code>failCnt</code> <code>failCnt</code> \u76f4\u63a5\u5c0d\u61c9 <p>\u5be6\u4f5c\uff1a</p> <pre><code>extension ConvertResult {\n    init(from dto: Code2CodeDataDTO) {\n        self.shareCode = dto.shareCode\n        self.successCnt = dto.successCnt\n        self.failCnt = dto.failCnt\n    }\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#repository-mapping","title":"Repository Mapping \u8cac\u4efb","text":"Repository DTO Domain Model CodeConverterRepository ProviderCountryConfigDTO ProviderConfig CodeConverterRepository Code2CodeDataDTO ConvertResult BetslipRepository LiabilitiesDTO Liabilities\uff08\u65e2\u6709\uff09 BetslipRepository BetslipDataDTO BetslipData\uff08\u65e2\u6709\uff09"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#repository","title":"Repository \u5be6\u4f5c","text":"<pre><code>protocol CodeConverterRepositoryProtocol {\n    func getProviderCountryConfig() async throws -&gt; [ProviderConfig]\n    func convertCode(provider: String, country: String, bookingCode: String) async throws -&gt; ConvertResult\n}\n\nstruct CodeConverterRepository: CodeConverterRepositoryProtocol {\n    let client: CodeConverterClient\n\n    init(client: CodeConverterClient = .live) {\n        self.client = client\n    }\n\n    func getProviderCountryConfig() async throws -&gt; [ProviderConfig] {\n        let response = try await client.fetchProviderCountries()\n\n        guard response.bizCode == 10000, let data = response.data else {\n            throw CodeConverterError.from(bizCode: response.bizCode)\n        }\n\n        return data.map { ProviderConfig(from: $0) }\n    }\n\n    func convertCode(provider: String, country: String, bookingCode: String) async throws -&gt; ConvertResult {\n        let request = Code2CodeRequestDTO(\n            provider: provider,\n            country: country,\n            bookingCode: bookingCode\n        )\n\n        let response = try await client.convertCode(request)\n\n        guard response.bizCode == 10000, let data = response.data else {\n            throw CodeConverterError.from(bizCode: response.bizCode, bookieName: provider)\n        }\n\n        return ConvertResult(from: data)\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/","title":"09_Error Handling","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter \u7684\u932f\u8aa4\u8655\u7406\u7b56\u7565\u3002</p>"},{"location":"09_Error%20Handling/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_error_handling.md \u932f\u8aa4\u5206\u985e\u8207\u8655\u7406\u7b56\u7565"},{"location":"09_Error%20Handling/01_error_handling/","title":"Error Handling","text":""},{"location":"09_Error%20Handling/01_error_handling/#_1","title":"\u932f\u8aa4\u985e\u578b\u5b9a\u7fa9","text":"<pre><code>enum CodeConverterError: LocalizedError {\n    /// \u627e\u4e0d\u5230 Booking Code\uff08\u5c0d\u61c9 API error code: CC002\uff09\n    case codeNotFound(bookieName: String)\n\n    /// \u6240\u6709 selections \u90fd\u8f49\u63db\u5931\u6557\uff08\u5c0d\u61c9 API error code: CC003\uff09\n    case allSelectionsFailed\n\n    /// Provider \u4e0d\u652f\u63f4\n    case unsupportedProvider\n\n    /// \u570b\u5bb6\u4e0d\u652f\u63f4\n    case unsupportedCountry\n\n    /// \u7db2\u8def\u932f\u8aa4\n    case networkError(underlying: Error)\n\n    /// \u4f3a\u670d\u5668\u932f\u8aa4\n    case serverError(statusCode: Int, message: String?)\n\n    /// \u672a\u77e5\u932f\u8aa4\n    case unknown(underlying: Error)\n\n    var errorDescription: String? {\n        switch self {\n        case .codeNotFound(let bookieName):\n            return \"We couldn't find this booking code on \\(bookieName). Please check and try again.\"\n        case .allSelectionsFailed:\n            return \"All selections failed to convert. Please try a different code.\"\n        case .unsupportedProvider:\n            return \"This bookie is not supported.\"\n        case .unsupportedCountry:\n            return \"This country is not supported.\"\n        case .networkError:\n            return \"Network error. Please check your connection and try again.\"\n        case .serverError(_, let message):\n            return message ?? \"Server error. Please try again later.\"\n        case .unknown:\n            return \"An unexpected error occurred. Please try again.\"\n        }\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#api-error-code","title":"API Error Code \u5c0d\u7167","text":"API Error Code HTTP Status CodeConverterError UI \u986f\u793a CC001 400 <code>.unsupportedProvider</code> \u4e0d\u652f\u63f4\u7684 Bookie CC002 404 <code>.codeNotFound(bookieName)</code> \u627e\u4e0d\u5230 Code\uff08\u7d05\u6846 + \u8a0a\u606f\uff09 CC003 200 (partial) <code>.allSelectionsFailed</code> \u5168\u90e8\u5931\u6557\uff08\u7d05\u6846 + \u8a0a\u606f\uff09 - 5xx <code>.serverError</code> \u4f3a\u670d\u5668\u932f\u8aa4 - timeout <code>.networkError</code> \u7db2\u8def\u932f\u8aa4"},{"location":"09_Error%20Handling/01_error_handling/#_2","title":"\u932f\u8aa4\u8655\u7406\u6d41\u7a0b","text":""},{"location":"09_Error%20Handling/01_error_handling/#1-code-not-found-cc002","title":"1. Code Not Found (CC002)","text":"<pre><code>sequenceDiagram\n    participant API as API\n    participant Client as CodeConverterClient\n    participant Repo as CodeConverterRepository\n    participant UC as ConvertBookingCodeUseCase\n    participant Feature as LoadCodeWidget.Feature\n    participant UI as LoadCodeWidgetView\n\n    API--&gt;&gt;Client: 404 Not Found\n    Client--&gt;&gt;Repo: throw APIError.notFound\n\n    Note over Repo: \u8f49\u63db\u70ba Domain Error\n    Repo--&gt;&gt;UC: throw CodeConverterError.codeNotFound(bookieName)\n\n    UC--&gt;&gt;Feature: .failure(CodeConverterError.codeNotFound)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"We couldn't find...\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#2-partial-failure","title":"2. Partial Failure (\u6210\u529f\u4f46\u90e8\u5206\u5931\u6557)","text":"<pre><code>sequenceDiagram\n    participant API as API\n    participant Feature as LoadCodeWidget.Feature\n    participant UI as LoadCodeWidgetView\n    participant Toast as PartialErrorToast\n    participant Betslip as BetslipPage\n\n    API--&gt;&gt;Feature: 200 OK with { failCnt: 2, successCnt: 5 }\n\n    Feature-&gt;&gt;Feature: state.convertResult = result\n    Feature-&gt;&gt;Feature: state.inputState = .filled\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt: 2)\n\n    Note over UI: failCnt &gt; 0\n\n    UI-&gt;&gt;Toast: \u986f\u793a \"2 selections failed to convert\"\n    UI-&gt;&gt;Betslip: \u5c0e\u822a\uff08\u53ea\u8f09\u5165\u6210\u529f\u7684 selections\uff09</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#3-all-selections-failed-cc003","title":"3. All Selections Failed (CC003)","text":"<pre><code>sequenceDiagram\n    participant Feature as LoadCodeWidget.Feature\n    participant UI as LoadCodeWidgetView\n\n    Note over Feature: convertResult.isAllFailed == true\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"All selections failed...\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f&lt;br/&gt;\u4e0d\u5c0e\u822a\u81f3 Betslip</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#ui","title":"UI \u932f\u8aa4\u72c0\u614b","text":""},{"location":"09_Error%20Handling/01_error_handling/#inputstate-errormessage","title":"inputState == .error(message)","text":"\u5143\u4ef6 \u8b8a\u5316 \u8f38\u5165\u6846\u908a\u6846 \u7d05\u8272 (#FF4444) \u6e05\u9664\u6309\u9215 \u986f\u793a \u2297 Load \u6309\u9215 \u7da0\u8272\uff08\u53ef\u91cd\u8a66\uff09 \u932f\u8aa4\u8a0a\u606f \u8f38\u5165\u6846\u4e0b\u65b9\u7d05\u8272\u6587\u5b57 Dropdown \u7121\u8b8a\u5316"},{"location":"09_Error%20Handling/01_error_handling/#_3","title":"\u8996\u89ba\u898f\u683c","text":"<pre><code>// \u932f\u8aa4\u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color.red, lineWidth: 2)\n)\n\n// \u932f\u8aa4\u8a0a\u606f\nText(errorMessage)\n    .font(.system(size: 12))\n    .foregroundColor(.red)\n    .padding(.top, 8)\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_4","title":"\u932f\u8aa4\u6062\u5fa9","text":""},{"location":"09_Error%20Handling/01_error_handling/#_5","title":"\u7528\u6236\u64cd\u4f5c \u2192 \u6e05\u9664\u932f\u8aa4","text":"\u7528\u6236\u64cd\u4f5c \u7d50\u679c \u9ede\u64ca\u8f38\u5165\u6846 <code>inputState = .focus</code>\uff0c\u6e05\u9664 errorMessage \u4fee\u6539\u8f38\u5165 <code>inputState = .typing</code>\uff0c\u6e05\u9664 errorMessage \u9ede\u64ca\u6e05\u9664\u6309\u9215 \u6e05\u9664\u8f38\u5165 + errorMessage\uff0c<code>inputState = .focus</code> \u9078\u64c7\u65b0 Bookie \u4fdd\u6301\u8f38\u5165\uff0c\u6e05\u9664 errorMessage"},{"location":"09_Error%20Handling/01_error_handling/#reducer","title":"Reducer \u5be6\u4f5c","text":"<pre><code>case .bookingCodeChanged(let rawCode):\n    let filteredCode = manager.filterBookingCode(rawCode)\n    state.bookingCode = filteredCode\n\n    // \u6e05\u9664\u932f\u8aa4\u72c0\u614b\n    if state.inputState.isError {\n        state.inputState = filteredCode.isEmpty ? .focus : .typing\n        state.errorMessage = nil\n    } else {\n        state.inputState = filteredCode.isEmpty ? .focus : .typing\n    }\n    return .none\n\ncase .clearButtonTapped:\n    state.bookingCode = \"\"\n    state.inputState = .focus\n    state.errorMessage = nil  // \u6e05\u9664\u932f\u8aa4\n    return .none\n\ncase .inputFocused:\n    if state.inputState.isError {\n        // \u805a\u7126\u6642\u4e0d\u6e05\u9664\u932f\u8aa4\uff0c\u8b93\u7528\u6236\u770b\u5230\u8a0a\u606f\n    } else {\n        state.inputState = .focus\n    }\n    return .none\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#partial-error-toast","title":"Partial Error Toast","text":""},{"location":"09_Error%20Handling/01_error_handling/#_6","title":"\u986f\u793a\u6642\u6a5f","text":"<p>\u7576 <code>convertResult.failCnt &gt; 0 &amp;&amp; convertResult.successCnt &gt; 0</code> \u6642\u986f\u793a\u3002</p>"},{"location":"09_Error%20Handling/01_error_handling/#toast","title":"Toast \u898f\u683c","text":"<pre><code>struct PartialErrorToast: View {\n    let failedCount: Int\n\n    var body: some View {\n        HStack(spacing: 8) {\n            Image(systemName: \"exclamationmark.triangle.fill\")\n                .foregroundColor(.orange)\n\n            Text(\"\\(failedCount) selection\\(failedCount &gt; 1 ? \"s\" : \"\") failed to convert\")\n                .font(.system(size: 14))\n                .foregroundColor(.white)\n        }\n        .padding(.horizontal, 16)\n        .padding(.vertical, 12)\n        .background(\n            RoundedRectangle(cornerRadius: 8)\n                .fill(Color.black.opacity(0.8))\n        )\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_7","title":"\u986f\u793a\u908f\u8f2f","text":"<pre><code>// \u5728 LoadCodeWidgetView \u6216 Parent View \u4e2d\n.toast(isPresenting: $showPartialErrorToast) {\n    PartialErrorToast(failedCount: store.convertResult?.failCnt ?? 0)\n}\n\n// \u6536\u5230 .presentBetslip \u6642\ncase let .presentBetslip(shareCode, failCnt):\n    if failCnt &gt; 0 {\n        state.showPartialErrorToast = true\n    }\n    // \u5c0e\u822a\u81f3 Betslip\n    return .none\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_8","title":"\u932f\u8aa4\u65e5\u8a8c","text":""},{"location":"09_Error%20Handling/01_error_handling/#analytics-event","title":"Analytics Event","text":"<pre><code>struct CodeConverterErrorEvent: AnalyticsEvent {\n    let errorType: String\n    let errorCode: String?\n    let provider: String\n    let country: String\n    let bookingCode: String  // \u5df2\u906e\u853d\u654f\u611f\u8cc7\u8a0a\n\n    static func from(error: CodeConverterError, input: ConvertBookingCodeInput) -&gt; Self {\n        Self(\n            errorType: error.analyticsType,\n            errorCode: error.analyticsCode,\n            provider: input.provider,\n            country: input.country,\n            bookingCode: input.bookingCode.prefix(3) + \"***\"  // \u906e\u853d\n        )\n    }\n}\n\nextension CodeConverterError {\n    var analyticsType: String {\n        switch self {\n        case .codeNotFound: return \"code_not_found\"\n        case .allSelectionsFailed: return \"all_failed\"\n        case .networkError: return \"network_error\"\n        case .serverError: return \"server_error\"\n        default: return \"unknown\"\n        }\n    }\n\n    var analyticsCode: String? {\n        switch self {\n        case .codeNotFound: return \"CC002\"\n        case .allSelectionsFailed: return \"CC003\"\n        case .serverError(let code, _): return \"HTTP_\\(code)\"\n        default: return nil\n        }\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/","title":"10_Test Scenarios","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter \u7684\u6e2c\u8a66\u6848\u4f8b\u3002</p>"},{"location":"10_Test%20Scenarios/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_test_scenarios.md UseCase \u6e2c\u8a66\u6848\u4f8b"},{"location":"10_Test%20Scenarios/01_test_scenarios/","title":"Test Scenarios","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#_1","title":"\u6e2c\u8a66\u5206\u985e","text":"\u985e\u5225 \u7bc4\u570d \u5de5\u5177 Unit Test UseCase, Repository, Domain Model XCTest Integration Test Feature (TCA), API Client XCTest + TCA TestStore UI Test View \u4ea4\u4e92 XCUITest"},{"location":"10_Test%20Scenarios/01_test_scenarios/#unit-tests","title":"Unit Tests","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#1-widgetinputstate-tests","title":"1. WidgetInputState Tests","text":"<pre><code>class WidgetInputStateTests: XCTestCase {\n\n    func test_default_state_properties() {\n        let state = WidgetInputState.default\n\n        XCTAssertFalse(state.showFocusBorder)\n        XCTAssertFalse(state.showErrorBorder)\n        XCTAssertFalse(state.showClearButton)\n        XCTAssertFalse(state.isLoadButtonEnabled)\n    }\n\n    func test_focus_state_shows_border() {\n        let state = WidgetInputState.focus\n\n        XCTAssertTrue(state.showFocusBorder)\n        XCTAssertFalse(state.showErrorBorder)\n    }\n\n    func test_typing_state_enables_load_button() {\n        let state = WidgetInputState.typing\n\n        XCTAssertTrue(state.showFocusBorder)\n        XCTAssertTrue(state.showClearButton)\n        XCTAssertTrue(state.isLoadButtonEnabled)\n    }\n\n    func test_error_state_shows_red_border() {\n        let state = WidgetInputState.error(message: \"Error message\")\n\n        XCTAssertFalse(state.showFocusBorder)\n        XCTAssertTrue(state.showErrorBorder)\n        XCTAssertTrue(state.showClearButton)\n        XCTAssertEqual(state.errorMessage, \"Error message\")\n    }\n\n    func test_loading_state_disables_interactions() {\n        let state = WidgetInputState.loading\n\n        XCTAssertFalse(state.showClearButton)\n        XCTAssertFalse(state.isLoadButtonEnabled)\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#2-selectedbookie-tests","title":"2. SelectedBookie Tests","text":"<pre><code>class SelectedBookieTests: XCTestCase {\n\n    func test_displayText_format() {\n        let bookie = SelectedBookie(provider: \"bet9ja\", name: \"Bet9ja\", country: .nigeria)\n\n        XCTAssertEqual(bookie.displayText, \"Bet9ja NG\")\n    }\n\n    func test_shortDisplayText_truncates_long_name() {\n        let bookie = SelectedBookie(provider: \"longbookie\", name: \"Very Long Bookie Name\", country: .nigeria)\n\n        XCTAssertEqual(bookie.shortDisplayText, \"Very Long Bo\u2026 NG\")\n    }\n\n    func test_init_from_providerConfig_uses_first_country() {\n        let config = ProviderConfig(\n            id: \"betway\",\n            provider: \"betway\",\n            name: \"Betway\",\n            countries: [.ghana, .nigeria, .kenya]\n        )\n\n        let bookie = SelectedBookie(from: config)\n\n        XCTAssertEqual(bookie?.country, .ghana)\n    }\n\n    func test_init_from_empty_providerConfig_returns_nil() {\n        let config = ProviderConfig(\n            id: \"empty\",\n            provider: \"empty\",\n            name: \"Empty\",\n            countries: []\n        )\n\n        XCTAssertNil(SelectedBookie(from: config))\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#3-convertresult-tests","title":"3. ConvertResult Tests","text":"<pre><code>class ConvertResultTests: XCTestCase {\n\n    func test_failCnt_counts_failed_selections() {\n        let result = ConvertResult(\n            shareCode: \"ABC123\",\n            selections: [\n                .mock(isFailed: false),\n                .mock(isFailed: true),\n                .mock(isFailed: true),\n                .mock(isFailed: false)\n            ]\n        )\n\n        XCTAssertEqual(result.failCnt, 2)\n        XCTAssertEqual(result.successCnt, 2)\n    }\n\n    func test_hasPartialFailure_when_some_failed() {\n        let result = ConvertResult(\n            shareCode: \"ABC123\",\n            selections: [\n                .mock(isFailed: false),\n                .mock(isFailed: true)\n            ]\n        )\n\n        XCTAssertTrue(result.hasPartialFailure)\n        XCTAssertFalse(result.isAllFailed)\n    }\n\n    func test_isAllFailed_when_all_failed() {\n        let result = ConvertResult(\n            shareCode: \"ABC123\",\n            selections: [\n                .mock(isFailed: true),\n                .mock(isFailed: true)\n            ]\n        )\n\n        XCTAssertTrue(result.isAllFailed)\n        XCTAssertFalse(result.hasPartialFailure)\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#tca-feature-tests","title":"TCA Feature Tests","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#1-happy-path-load-provider-config","title":"1. Happy Path: Load Provider Config","text":"<pre><code>@MainActor\nclass LoadCodeWidgetFeatureTests: XCTestCase {\n\n    func test_bookieDropdownTapped_loads_config_and_shows_sheet() async {\n        let mockConfigs = [\n            ProviderConfig(id: \"bet9ja\", provider: \"bet9ja\", name: \"Bet9ja\", countries: [.nigeria])\n        ]\n\n        let store = TestStore(initialState: LoadCodeWidget.State(enableCodeConverter: true)) {\n            LoadCodeWidget.Feature()\n        } withDependencies: {\n            $0.loadProviderConfigUseCase = .init { .success(mockConfigs) }\n        }\n\n        await store.send(.bookieDropdownTapped)\n\n        await store.receive(.providerConfigLoaded(.success(mockConfigs))) {\n            $0.providerConfigs = mockConfigs\n            $0.isBookieSelectorPresented = true\n            $0.availableCountries = [.nigeria]\n        }\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#2-happy-path-convert-booking-code","title":"2. Happy Path: Convert Booking Code","text":"<pre><code>func test_loadBookingCode_with_codeConverter_converts_and_presents_betslip() async {\n    let mockOutput = ConvertBookingCodeOutput(\n        convertResult: ConvertResult(shareCode: \"FCOM123\", selections: [.mock(isFailed: false)]),\n        liabilities: .mock\n    )\n\n    let store = TestStore(initialState: LoadCodeWidget.State(\n        bookingCode: \"3RA3FA\",\n        enableCodeConverter: true,\n        selectedBookie: SelectedBookie(provider: \"bet9ja\", name: \"Bet9ja\", country: .nigeria)\n    )) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.convertBookingCodeUseCase = .init { _ in .success(mockOutput) }\n    }\n\n    await store.send(.loadBookingCode) {\n        $0.inputState = .loading\n        $0.isLoading = true\n    }\n\n    await store.receive(.convertCodeCompleted(.success(mockOutput))) {\n        $0.isLoading = false\n        $0.inputState = .filled\n        $0.bookingCode = \"\"\n        $0.convertResult = mockOutput.convertResult\n    }\n\n    await store.receive(.presentBetslip(shareCode: \"FCOM123\", failCnt: 0))\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#3-error-code-not-found","title":"3. Error: Code Not Found","text":"<pre><code>func test_loadBookingCode_codeNotFound_shows_error() async {\n    let store = TestStore(initialState: LoadCodeWidget.State(\n        bookingCode: \"INVALID\",\n        enableCodeConverter: true,\n        selectedBookie: SelectedBookie(provider: \"bet9ja\", name: \"Bet9ja\", country: .nigeria)\n    )) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.convertBookingCodeUseCase = .init { _ in\n            .failure(CodeConverterError.codeNotFound(bookieName: \"Bet9ja\"))\n        }\n    }\n\n    await store.send(.loadBookingCode) {\n        $0.inputState = .loading\n        $0.isLoading = true\n    }\n\n    await store.receive(.convertCodeCompleted(.failure(CodeConverterError.codeNotFound(bookieName: \"Bet9ja\")))) {\n        $0.isLoading = false\n        $0.inputState = .error(message: \"We couldn't find this booking code on Bet9ja. Please check and try again.\")\n        $0.errorMessage = \"We couldn't find this booking code on Bet9ja. Please check and try again.\"\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#4-input-state-transitions","title":"4. Input State Transitions","text":"<pre><code>func test_inputState_transitions() async {\n    let store = TestStore(initialState: LoadCodeWidget.State(enableCodeConverter: true)) {\n        LoadCodeWidget.Feature()\n    }\n\n    // Default \u2192 Focus\n    await store.send(.inputFocused) {\n        $0.inputState = .focus\n    }\n\n    // Focus \u2192 Typing (when text entered)\n    await store.send(.bookingCodeChanged(\"3RA\")) {\n        $0.bookingCode = \"3RA\"\n        $0.inputState = .typing\n    }\n\n    // Typing \u2192 Focus (when cleared)\n    await store.send(.clearButtonTapped) {\n        $0.bookingCode = \"\"\n        $0.inputState = .focus\n        $0.errorMessage = nil\n    }\n\n    // Focus \u2192 Default (when blurred with no text)\n    await store.send(.inputBlurred) {\n        $0.inputState = .default\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#5-bookie-selection","title":"5. Bookie Selection","text":"<pre><code>func test_bookieSelected_updates_state_and_closes_sheet() async {\n    let configs = [\n        ProviderConfig(id: \"betway\", provider: \"betway\", name: \"Betway\", countries: [.ghana, .nigeria])\n    ]\n\n    let store = TestStore(initialState: LoadCodeWidget.State(\n        enableCodeConverter: true,\n        providerConfigs: configs,\n        isBookieSelectorPresented: true\n    )) {\n        LoadCodeWidget.Feature()\n    }\n\n    await store.send(.bookieSelected(provider: \"betway\", country: .ghana)) {\n        $0.selectedBookie = SelectedBookie(provider: \"betway\", name: \"Betway\", country: .ghana)\n        $0.selectedCountry = .ghana  // \u5411\u5f8c\u76f8\u5bb9\n        $0.isBookieSelectorPresented = false\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#ui-tests","title":"UI Tests","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#1-input-field-focus","title":"1. Input Field Focus","text":"<pre><code>func test_input_field_shows_green_border_when_focused() {\n    let app = XCUIApplication()\n    app.launch()\n\n    let inputField = app.textFields[\"bookingCodeInput\"]\n    inputField.tap()\n\n    // \u9a57\u8b49\u7da0\u8272\u908a\u6846\u5b58\u5728\uff08\u900f\u904e accessibility identifier\uff09\n    XCTAssertTrue(inputField.otherElements[\"focusBorder\"].exists)\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#2-clear-button","title":"2. Clear Button","text":"<pre><code>func test_clear_button_clears_input() {\n    let app = XCUIApplication()\n    app.launch()\n\n    let inputField = app.textFields[\"bookingCodeInput\"]\n    inputField.tap()\n    inputField.typeText(\"3RA3FA\")\n\n    let clearButton = app.buttons[\"clearButton\"]\n    XCTAssertTrue(clearButton.exists)\n\n    clearButton.tap()\n\n    XCTAssertEqual(inputField.value as? String, \"\")\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#3-bookie-selector-sheet","title":"3. Bookie Selector Sheet","text":"<pre><code>func test_dropdown_opens_bookie_selector_sheet() {\n    let app = XCUIApplication()\n    app.launch()\n\n    let dropdown = app.buttons[\"bookieDropdown\"]\n    dropdown.tap()\n\n    // \u9a57\u8b49 Sheet \u51fa\u73fe\n    XCTAssertTrue(app.sheets[\"bookieSelectorSheet\"].waitForExistence(timeout: 2))\n\n    // \u9078\u64c7 Bookie\n    app.buttons[\"Bet9ja\"].tap()\n\n    // \u9a57\u8b49 Sheet \u95dc\u9589\n    XCTAssertFalse(app.sheets[\"bookieSelectorSheet\"].exists)\n\n    // \u9a57\u8b49 Dropdown \u6587\u5b57\u66f4\u65b0\n    XCTAssertTrue(dropdown.label.contains(\"Bet9ja\"))\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#test-data-mocks","title":"Test Data Mocks","text":"<pre><code>extension ConvertResult.Selection {\n    static func mock(\n        eventId: String = \"12345\",\n        sportId: Int = 1,\n        isFailed: Bool = false,\n        failReason: String? = nil\n    ) -&gt; Self {\n        Self(\n            eventId: eventId,\n            sportId: sportId,\n            marketId: 10,\n            selectionId: 100,\n            odds: 1.85,\n            specialBetValue: nil,\n            isFailed: isFailed,\n            failReason: failReason\n        )\n    }\n}\n\nextension LiabilitiesResult {\n    static var mock: Self {\n        Self(isValid: true, liabilities: [])\n    }\n}\n</code></pre>"},{"location":"11_Risks%20and%20Questions/","title":"11_Risks and Questions","text":"<p>\u672c\u7ae0\u7bc0\u8a18\u9304\u5f85\u78ba\u8a8d\u4e8b\u9805\u8207\u6f5b\u5728\u98a8\u96aa\u3002</p>"},{"location":"11_Risks%20and%20Questions/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_risks_and_questions.md \u5f85\u78ba\u8a8d\u4e8b\u9805\u8207\u98a8\u96aa\u5217\u8868"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/","title":"Risks and Questions","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_1","title":"\u5f85\u78ba\u8a8d\u4e8b\u9805","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#1","title":"1. \u5411\u5f8c\u76f8\u5bb9\u6027","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 <code>LoadCodeManager</code> \u662f\u5426\u9700\u8981\u4fee\u6539\uff1f \u73fe\u6709 <code>LoadBookingCodeSection.Feature</code> \u4f9d\u8cf4 <code>LoadCodeManager</code> \u5982\u9700\u4fee\u6539\u53ef\u80fd\u5f71\u97ff\u5176\u4ed6\u4f7f\u7528\u8005 \u4fdd\u6301 <code>LoadCodeManager</code> \u4e0d\u8b8a\uff0c\u65b0\u908f\u8f2f\u8d70 UseCase <code>enableCodeConverter</code> \u9810\u8a2d\u503c\uff1f \u6c7a\u5b9a\u65b0\u529f\u80fd\u7684\u555f\u7528\u7b56\u7565 \u5f71\u97ff rollout \u8a08\u756b \u5efa\u8b70\u9810\u8a2d <code>false</code>\uff0c\u9010\u6b65\u958b\u555f"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#2-api","title":"2. API \u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 <code>POST /orders/converter/code</code> \u8fd4\u56de\u7684 <code>shareCode</code> \u662f\u5426\u53ea\u5305\u542b\u6210\u529f\u7684 selections\uff1f \u90e8\u5206\u5931\u6557\u6642\u9700\u8981\u77e5\u9053\u5982\u4f55\u8f09\u5165 Betslip \u5f71\u97ff Betslip \u986f\u793a \u8207\u5f8c\u7aef\u78ba\u8a8d Provider Config \u66f4\u65b0\u983b\u7387\uff1f \u662f\u5426\u9700\u8981\u7de9\u5b58 \u5f71\u97ff API \u8abf\u7528\u6b21\u6578 \u5efa\u8b70\u9996\u6b21\u958b\u555f Sheet \u6642\u8f09\u5165\uff0c\u5f8c\u7e8c\u4f7f\u7528\u7de9\u5b58 Provider Config \u662f\u5426\u4f9d\u8cf4\u7528\u6236\u767b\u5165\uff1f \u672a\u767b\u5165\u7528\u6236\u662f\u5426\u53ef\u7528 \u5f71\u97ff Guest \u7528\u6236\u9ad4\u9a57 \u8207\u5f8c\u7aef\u78ba\u8a8d"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#3-uiux","title":"3. UI/UX \u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 \u591a\u570b\u5bb6 Bookie \u7684 UI \u4ea4\u4e92\uff1f \u8a2d\u8a08\u7a3f\u986f\u793a\u96d9\u6b04\u9078\u64c7\u5668 \u9700\u78ba\u8a8d\u662f\u5148\u9078 Bookie \u518d\u9078 Country\uff0c\u9084\u662f\u4e26\u5217\u986f\u793a \u53c3\u8003 Figma \u8a2d\u8a08 Partial Failure Toast \u986f\u793a\u6642\u9577\uff1f \u9700\u8981\u8b93\u7528\u6236\u6ce8\u610f\u5230\u90e8\u5206\u5931\u6557 \u5f71\u97ff\u7528\u6236\u611f\u77e5 \u5efa\u8b70 3 \u79d2\u81ea\u52d5\u6d88\u5931 \u9577 Bookie \u540d\u7a31\u622a\u65b7\u7b56\u7565\uff1f Dropdown \u7a7a\u9593\u6709\u9650 \u5f71\u97ff\u53ef\u8b80\u6027 \u8a2d\u8a08\u7a3f\u6307\u5b9a 12 \u5b57\u5143\u5f8c\u622a\u65b7"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#4","title":"4. \u6548\u80fd\u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 \u8f49\u63db API \u6700\u9577\u8017\u6642\uff1f PRD \u63d0\u5230\u53ef\u80fd\u9700\u8981 10 \u79d2 \u5f71\u97ff Loading \u63d0\u793a \u986f\u793a \"Conversion may take up to 10 seconds\" \u63d0\u793a Timeout \u8a2d\u7f6e\uff1f \u9700\u8981\u5408\u7406\u7684\u8d85\u6642\u6642\u9593 \u5f71\u97ff\u932f\u8aa4\u8655\u7406 \u5efa\u8b70 30 \u79d2 timeout"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_2","title":"\u98a8\u96aa\u8a55\u4f30","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_3","title":"\u9ad8\u98a8\u96aa","text":"\u98a8\u96aa \u63cf\u8ff0 \u7de9\u89e3\u63aa\u65bd \u539f\u6709\u529f\u80fd regression \u64f4\u5c55 <code>LoadBookingCodeSectionView</code> \u53ef\u80fd\u5f71\u97ff\u9996\u9801 Widget \u5b8c\u6574\u7684\u55ae\u5143\u6e2c\u8a66 + <code>enableCodeConverter = false</code> \u6642\u5b8c\u5168\u8d70\u539f\u6709\u908f\u8f2f API \u683c\u5f0f\u4e0d\u5339\u914d DTO \u5b9a\u7fa9\u8207\u5be6\u969b API \u4e0d\u7b26 \u8207\u5f8c\u7aef\u540c\u6b65 API \u6587\u6a94\uff0c\u589e\u52a0 Response \u9a57\u8b49"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_4","title":"\u4e2d\u98a8\u96aa","text":"\u98a8\u96aa \u63cf\u8ff0 \u7de9\u89e3\u63aa\u65bd Betslip \u5c0e\u822a\u5931\u6557 \u8f49\u63db\u6210\u529f\u4f46 Betslip \u8f09\u5165\u5931\u6557 \u589e\u52a0\u932f\u8aa4\u8655\u7406\uff0c\u56de\u6efe\u5230 Error \u72c0\u614b Provider Config \u8f09\u5165\u5931\u6557 \u7121\u6cd5\u958b\u555f Bookie \u9078\u64c7\u5668 \u986f\u793a\u932f\u8aa4 Toast\uff0c\u5141\u8a31\u91cd\u8a66"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_5","title":"\u4f4e\u98a8\u96aa","text":"\u98a8\u96aa \u63cf\u8ff0 \u7de9\u89e3\u63aa\u65bd UI \u72c0\u614b\u4e0d\u4e00\u81f4 \u5feb\u901f\u64cd\u4f5c\u53ef\u80fd\u5c0e\u81f4\u72c0\u614b\u6df7\u4e82 TCA \u4fdd\u8b49\u72c0\u614b\u4e00\u81f4\u6027 \u9577\u6642\u9593 Loading \u7528\u6236\u53ef\u80fd\u96e2\u958b\u9801\u9762 \u63d0\u793a\u6587\u5b57 + \u8003\u616e\u80cc\u666f\u8655\u7406"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_6","title":"\u4f9d\u8cf4\u9805","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_7","title":"\u5916\u90e8\u4f9d\u8cf4","text":"\u4f9d\u8cf4 \u72c0\u614b \u8ca0\u8cac\u5718\u968a \u5099\u8a3b <code>GET /orders/converter/config/providerCountries</code> \u5f85\u78ba\u8a8d Backend \u9700\u78ba\u8a8d Response \u683c\u5f0f <code>POST /orders/converter/code</code> \u5f85\u78ba\u8a8d Backend \u9700\u78ba\u8a8d\u932f\u8aa4\u78bc\u5b8c\u6574\u6027 Figma \u8a2d\u8a08\u7a3f \u2705 \u5df2\u63d0\u4f9b Design \u5df2\u6709 Node IDs"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_8","title":"\u5167\u90e8\u4f9d\u8cf4","text":"\u4f9d\u8cf4 \u72c0\u614b \u5099\u8a3b <code>BetslipRepository</code> \u2705 \u65e2\u6709 \u7528\u65bc Liabilities \u6aa2\u67e5 <code>LoadCodeManager</code> \u2705 \u65e2\u6709 \u4fdd\u6301\u4e0d\u8b8a\uff0c\u5411\u5f8c\u76f8\u5bb9 <code>Region</code> enum \u26a0\ufe0f \u53ef\u80fd\u9700\u64f4\u5c55 \u65b0\u589e CountryCode mapping"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_9","title":"\u958b\u653e\u6027\u554f\u984c","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_10","title":"\u7522\u54c1\u5c64\u9762","text":"<ol> <li>Feature Flag \u7b56\u7565\uff1aCode Converter \u529f\u80fd\u662f\u5426\u9700\u8981 Remote Config \u63a7\u5236\u958b\u95dc\uff1f</li> <li>\u7528\u6236\u5206\u7fa4\uff1a\u662f\u5426\u53ea\u5c0d\u7279\u5b9a\u570b\u5bb6/\u7528\u6236\u958b\u653e\uff1f</li> <li>Analytics\uff1a\u9700\u8981\u8ffd\u8e64\u54ea\u4e9b GA Events\uff1f</li> </ol>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_11","title":"\u6280\u8853\u5c64\u9762","text":"<ol> <li>\u7de9\u5b58\u7b56\u7565\uff1aProvider Config \u662f\u5426\u9700\u8981\u6301\u4e45\u5316\u7de9\u5b58\uff1f</li> <li>\u96e2\u7dda\u652f\u63f4\uff1a\u96e2\u7dda\u6642\u662f\u5426\u9700\u8981 graceful degradation\uff1f</li> <li>\u6df1\u9023\u7d50\uff1a\u662f\u5426\u9700\u8981\u652f\u63f4\u6df1\u9023\u7d50\u76f4\u63a5\u5e36\u5165 Booking Code\uff1f</li> </ol>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_12","title":"\u5f8c\u7e8c\u8fed\u4ee3\u8003\u91cf","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#phase-2-ocr2code","title":"Phase 2: OCR2Code\uff08\u9810\u7559\uff09","text":"<ul> <li>\u9700\u8981\u589e\u52a0\u76f8\u6a5f/\u5716\u7247\u9078\u64c7\u529f\u80fd</li> <li>\u53ef\u80fd\u9700\u8981\u65b0\u7684 UI \u5165\u53e3</li> <li>UseCase \u53ef\u5fa9\u7528\uff0c\u53ea\u9700\u65b0\u589e OCR \u524d\u8655\u7406</li> </ul>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#phase-3-prompt2code","title":"Phase 3: Prompt2Code\uff08\u9810\u7559\uff09","text":"<ul> <li>\u9700\u8981\u6574\u5408 LLM/AI \u670d\u52d9</li> <li>\u53ef\u80fd\u9700\u8981\u5c0d\u8a71\u5f0f UI</li> <li>\u8003\u616e Streaming Response</li> </ul>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#checklist","title":"Checklist\uff08\u958b\u767c\u524d\u78ba\u8a8d\uff09","text":"<ul> <li> \u8207\u5f8c\u7aef\u78ba\u8a8d API Response \u5b8c\u6574\u683c\u5f0f</li> <li> \u8207\u8a2d\u8a08\u78ba\u8a8d\u591a\u570b\u5bb6 Bookie \u9078\u64c7\u4ea4\u4e92</li> <li> \u78ba\u8a8d Feature Flag \u9700\u6c42</li> <li> \u78ba\u8a8d Analytics Events \u6e05\u55ae</li> <li> \u78ba\u8a8d Timeout \u8207\u91cd\u8a66\u7b56\u7565</li> </ul>"},{"location":"12_Sprint%20Plan/","title":"12. Sprint Plan","text":"<p>\u6b64\u8cc7\u6599\u593e\u5305\u542b Code Converter Phase 1 \u7684 Sprint \u898f\u5283\u6587\u4ef6\u3002</p>"},{"location":"12_Sprint%20Plan/#_1","title":"\ud83d\udcc4 \u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_5day_sprint_plan.md 5 \u5929 Sprint \u8a73\u7d30\u898f\u5283\uff0c\u5305\u542b\u6240\u6709 Jira Tickets"},{"location":"12_Sprint%20Plan/#sprint","title":"\ud83c\udfaf Sprint \u76ee\u6a19","text":"<ul> <li>\u671f\u9593: 2025-01-07 ~ 2025-01-13 (5 \u5de5\u4f5c\u5929)</li> <li>\u76ee\u6a19: \u5b8c\u6210 Code Converter Phase 1 (Code2Code) \u6838\u5fc3\u529f\u80fd</li> </ul>"},{"location":"12_Sprint%20Plan/#_2","title":"\ud83d\udcca \u6bcf\u65e5\u4e3b\u984c","text":"Day \u4e3b\u984c Day 1 \u57fa\u790e\u67b6\u69cb + UI \u9aa8\u67b6 Day 2 Bookie Selector + Config API Day 3 Convert API \u6574\u5408 Day 4 Betslip \u4e32\u63a5 + \u7d50\u679c\u986f\u793a Day 5 \u932f\u8aa4\u8655\u7406 + \u6e2c\u8a66 + Polish"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/","title":"Code Converter Phase 1 - 5 Day Sprint Plan","text":"<p>Sprint \u671f\u9593: 2025-01-07 (\u9031\u4e8c) ~ 2025-01-13 (\u9031\u4e00\uff0c\u8df3\u904e\u9031\u672b) Epic: FOOTBALL-9161 - Booking Code Converter \u958b\u767c\u8005: @Reed Hsin</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#sprint","title":"\ud83d\udcca Sprint \u7e3d\u89bd","text":"Day \u65e5\u671f \u4e3b\u984c Story Points Day 1 01/07 (\u4e8c) \u57fa\u790e\u67b6\u69cb + UI \u9aa8\u67b6 5 Day 2 01/08 (\u4e09) Bookie Selector + Config API 5 Day 3 01/09 (\u56db) Convert API \u6574\u5408 5 Day 4 01/10 (\u4e94) Betslip \u4e32\u63a5 + \u7d50\u679c\u986f\u793a 5 Day 5 01/13 (\u4e00) \u932f\u8aa4\u8655\u7406 + \u6e2c\u8a66 + Polish 5 <p>Total: 25 Story Points</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#jira-tickets","title":"\ud83d\udccb Jira Tickets \u8a73\u7d30\u898f\u5283","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-1-ui-0107","title":"Day 1: \u57fa\u790e\u67b6\u69cb + UI \u9aa8\u67b6 (01/07)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-module","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Module \u67b6\u69cb\u8a2d\u5b9a","text":"<p>Type: Task Story Points: 1 Labels: <code>architecture</code>, <code>setup</code></p> <p>Description: \u8a2d\u5b9a Code Converter \u529f\u80fd\u7684 Module \u67b6\u69cb\uff0c\u5305\u542b\u8cc7\u6599\u593e\u7d50\u69cb\u548c\u57fa\u672c\u6a94\u6848\u3002</p> <p>Acceptance Criteria: - [ ] \u5efa\u7acb <code>CodeConverter/</code> \u8cc7\u6599\u593e\u7d50\u69cb   - <code>Feature/</code>   - <code>View/</code>   - <code>UseCase/</code>   - <code>Repository/</code>   - <code>Client/</code>   - <code>Model/</code> - [ ] \u5efa\u7acb <code>CodeConverterAPI.swift</code> \u6a94\u6848 (\u7a7a\u6bbc) - [ ] \u5efa\u7acb <code>CodeConverterClient.swift</code> \u6a94\u6848 (\u7a7a\u6bbc)</p> <p>Reference: - TDD: <code>02_Architecture/01_clean_architecture_diagram.md</code> - TDD: <code>03_Module Responsibility/01_module_responsibility.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-loadcodewidgetview-ui","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - LoadCodeWidgetView \u57fa\u790e UI","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>view</code></p> <p>Description: \u5be6\u4f5c Load Code Widget \u7684\u4e3b\u8981\u5bb9\u5668\u8996\u5716\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>LoadCodeWidgetView</code> \u4e3b\u8996\u5716   - \u5305\u542b <code>BookieDropdownView</code> placeholder   - \u5305\u542b <code>BookingCodeInputView</code> placeholder   - \u80cc\u666f\u8272: <code>Color.backgroundType1Tertiary</code>   - CornerRadius: 10   - Padding: 8 - [ ] \u5be6\u4f5c\u5e95\u90e8\u932f\u8aa4\u8a0a\u606f\u5340\u57df - [ ] SwiftUI Preview \u53ef\u6b63\u5e38\u986f\u793a</p> <p>Figma Reference: - Node: <code>26769-88873</code> (Default State) - Node: <code>26342-46244</code> (Component Set)</p> <p>Reference: - TDD: <code>05_Module Sequence Diagram/LoadCodeWidget/01_view_implementation.md</code> - TDD: <code>05_Module Sequence Diagram/LoadCodeWidget/02_view_design_specs.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-bookiedropdownview","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - BookieDropdownView","text":"<p>Type: Story Story Points: 1 Labels: <code>ui</code>, <code>view</code>, <code>component</code></p> <p>Description: \u5be6\u4f5c Bookie \u9078\u64c7\u4e0b\u62c9\u6309\u9215\u5143\u4ef6\u3002</p> <p>Acceptance Criteria: - [ ] \u986f\u793a\u9078\u4e2d\u7684 Bookie Logo - [ ] \u986f\u793a Bookie \u540d\u7a31 (\u82e5\u7121\u5247\u986f\u793a \"Select\") - [ ] \u986f\u793a\u4e0b\u62c9\u7bad\u982d icon - [ ] \u9ede\u64ca\u89f8\u767c <code>onTap</code> callback - [ ] \u56fa\u5b9a\u5bec\u5ea6: 104</p> <p>Figma Reference: - Node: <code>26769-88873</code> (Default)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-bookingcodeinputview","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - BookingCodeInputView","text":"<p>Type: Story Story Points: 1 Labels: <code>ui</code>, <code>view</code>, <code>component</code></p> <p>Description: \u5be6\u4f5c Booking Code \u8f38\u5165\u6b04\u4f4d\u5143\u4ef6\u3002</p> <p>Acceptance Criteria: - [ ] \u652f\u63f4\u4ee5\u4e0b\u72c0\u614b:   - Default (placeholder \u986f\u793a)   - Focus (\u7de8\u8f2f\u4e2d)   - Typing (\u8f38\u5165\u4e2d)   - Filled (\u5df2\u586b\u5beb)   - Loading (API \u8acb\u6c42\u4e2d)   - Error (\u986f\u793a\u932f\u8aa4) - [ ] \u53f3\u5074 \"Load\" \u6309\u9215   - \u555f\u7528\u6642: <code>Color.brandSecondary</code>   - \u505c\u7528\u6642: <code>Color.brandSecondaryDisable</code> - [ ] \u5b57\u578b: <code>Font.b1_m</code></p> <p>Figma Reference: - Node: <code>26769-88873</code> (Default) - Node: <code>26769-88868</code> (Focus) - Node: <code>26769-88863</code> (Typing) - Node: <code>26769-88878</code> (Filled) - Node: <code>26453-93276</code> (Loading) - Node: <code>26453-93353</code> (Error)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-2-bookie-selector-config-api-0108","title":"Day 2: Bookie Selector + Config API (01/08)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-bookieselectorsheet-ui","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - BookieSelectorSheet UI","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>view</code>, <code>sheet</code></p> <p>Description: \u5be6\u4f5c Bookie \u9078\u64c7\u5668 Bottom Sheet\u3002</p> <p>Acceptance Criteria: - [ ] Sheet \u6a19\u984c: \"Select bookie\" - [ ] \u53ef\u6efe\u52d5\u7684 Bookie \u5217\u8868 - [ ] \u652f\u63f4\u55ae\u4e00\u570b\u5bb6 Bookie (\u76f4\u63a5\u9078\u64c7) - [ ] \u652f\u63f4\u591a\u570b\u5bb6 Bookie (\u5c55\u958b\u9078\u64c7\u570b\u5bb6) - [ ] \u652f\u63f4 ALL \u570b\u5bb6 Provider (\u9810\u8a2d \"ALL\") - [ ] Submit \u6309\u9215 - [ ] \u5e95\u90e8\u6f38\u5c64\u906e\u7f69\u6548\u679c</p> <p>Figma Reference: - Node: <code>26753-64425</code> (\u958b\u555f\u9078\u55ae) - Node: <code>26753-64480</code> (\u55ae\u4e00\u570b\u5bb6 Bookie) - Node: <code>26753-64517</code> (\u591a\u570b\u5bb6 Bookie) - Node: <code>26921-96820</code> (ALL \u570b\u5bb6 Provider) - Node: <code>26753-85011</code> (\u7d50\u679c - \u6700\u7d42\u72c0\u614b)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-loadproviderconfigusecase","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - LoadProviderConfigUseCase","text":"<p>Type: Story Story Points: 1 Labels: <code>usecase</code>, <code>domain</code></p> <p>Description: \u5be6\u4f5c\u8f09\u5165 Provider \u8a2d\u5b9a\u7684 UseCase\u3002</p> <p>Acceptance Criteria: - [ ] Input: \u7121 - [ ] Output: <code>[ProviderConfig]</code> - [ ] \u8abf\u7528 <code>CodeConverterRepository.fetchProviderConfig()</code> - [ ] \u932f\u8aa4\u8655\u7406: \u56de\u50b3 <code>.failure(error)</code></p> <p>API Reference: - <code>GET /orders/converter/config/providerCountries</code></p> <p>Reference: - TDD: <code>07_UseCase Input and Output Model/01_usecase_input_output.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-codeconverterrepository-config","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - CodeConverterRepository (Config)","text":"<p>Type: Story Story Points: 1 Labels: <code>repository</code>, <code>data</code></p> <p>Description: \u5be6\u4f5c Repository \u5c64\u7684 Config API \u547c\u53eb\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>fetchProviderConfig()</code> \u65b9\u6cd5 - [ ] DTO to Domain Model \u8f49\u63db - [ ] \u4f9d\u8cf4 <code>CodeConverterClient</code></p> <p>Reference: - TDD: <code>03_Module Responsibility/01_module_responsibility.md</code> - TDD: <code>08_API Spec and Mapping/02_dto_mapping.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-codeconverterclient-config-api","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - CodeConverterClient (Config API)","text":"<p>Type: Story Story Points: 1 Labels: <code>client</code>, <code>network</code></p> <p>Description: \u5be6\u4f5c Client \u5c64\u7684 Config API \u7db2\u8def\u8acb\u6c42\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>getProviderCountryConfig()</code> \u65b9\u6cd5 - [ ] Method: <code>GET</code> - [ ] Endpoint: <code>/orders/converter/config/providerCountries</code> - [ ] Response DTO: <code>ProviderCountryConfigResponse</code></p> <p>Reference: - TDD: <code>08_API Spec and Mapping/01_api_spec.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-3-convert-api-0109","title":"Day 3: Convert API \u6574\u5408 (01/09)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-convertbookingcodeusecase","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - ConvertBookingCodeUseCase","text":"<p>Type: Story Story Points: 1 Labels: <code>usecase</code>, <code>domain</code></p> <p>Description: \u5be6\u4f5c\u8f49\u63db Booking Code \u7684 UseCase\u3002</p> <p>Acceptance Criteria: - [ ] Input: <code>ConvertBookingCodeInput</code> (provider, country, bookingCode) - [ ] Output: <code>ConvertBookingCodeOutput</code> (shareCode, successCnt, failCnt) - [ ] \u8abf\u7528 <code>CodeConverterRepository.convertCode()</code> - [ ] \u932f\u8aa4\u8655\u7406</p> <p>API Reference: - <code>POST /orders/converter/code</code></p> <p>Reference: - TDD: <code>07_UseCase Input and Output Model/01_usecase_input_output.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-codeconverterrepository-convert","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - CodeConverterRepository (Convert)","text":"<p>Type: Story Story Points: 1 Labels: <code>repository</code>, <code>data</code></p> <p>Description: \u5be6\u4f5c Repository \u5c64\u7684 Convert API \u547c\u53eb\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>convertCode(input:)</code> \u65b9\u6cd5 - [ ] DTO to Domain Model \u8f49\u63db - [ ] \u932f\u8aa4\u8655\u7406\u8207\u56de\u50b3</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-codeconverterclient-convert-api","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - CodeConverterClient (Convert API)","text":"<p>Type: Story Story Points: 1 Labels: <code>client</code>, <code>network</code></p> <p>Description: \u5be6\u4f5c Client \u5c64\u7684 Convert API \u7db2\u8def\u8acb\u6c42\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>convertCode(request:)</code> \u65b9\u6cd5 - [ ] Method: <code>POST</code> - [ ] Endpoint: <code>/orders/converter/code</code> - [ ] Request Body: <code>{ provider, country, bookingCode }</code> - [ ] Response DTO: <code>Code2CodeResponse</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-tca-feature","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - TCA Feature \u6574\u5408","text":"<p>Type: Story Story Points: 2 Labels: <code>tca</code>, <code>feature</code></p> <p>Description: \u6574\u5408 TCA Feature State \u548c Action\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>LoadCodeWidget.Feature.State</code> \u65b0\u589e\u5c6c\u6027   - <code>providerConfigs: [ProviderConfig]</code>   - <code>selectedProvider: ProviderConfig?</code>   - <code>selectedCountry: String?</code>   - <code>bookingCode: String</code>   - <code>conversionState: ConversionState</code> - [ ] \u5be6\u4f5c <code>LoadCodeWidget.Feature.Action</code> \u65b0\u589e\u9805\u76ee   - <code>.loadProviderConfig</code>   - <code>.providerConfigResponse(Result&lt;...&gt;)</code>   - <code>.bookieDropdownTapped</code>   - <code>.bookieSelected(ProviderConfig, String?)</code>   - <code>.bookingCodeChanged(String)</code>   - <code>.loadButtonTapped</code>   - <code>.convertResponse(Result&lt;...&gt;)</code> - [ ] Reducer \u908f\u8f2f\u5be6\u4f5c</p> <p>Reference: - TDD: <code>06_Feature State and Action (TCA)/01_feature_state_action.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-4-betslip-0110","title":"Day 4: Betslip \u4e32\u63a5 + \u7d50\u679c\u986f\u793a (01/10)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-betslip","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Betslip \u6d41\u7a0b\u4e32\u63a5","text":"<p>Type: Story Story Points: 2 Labels: <code>integration</code>, <code>betslip</code></p> <p>Description: \u5c07\u8f49\u63db\u6210\u529f\u5f8c\u7684 shareCode \u4e32\u63a5\u5230\u65e2\u6709 Betslip \u6d41\u7a0b\u3002</p> <p>Acceptance Criteria: - [ ] Convert API \u6210\u529f\u5f8c:   1. \u547c\u53eb <code>GET /bookingCode/[shareCode]/liabilities</code> [\u65e2\u6709\u6d41\u7a0b]   2. \u547c\u53eb <code>GET /orders/share/[shareCode]</code> [\u65e2\u6709\u6d41\u7a0b]   3. Pop up Betslip \u4e26\u986f\u793a\u8f49\u63db\u7d50\u679c - [ ] \u4f7f\u7528\u65e2\u6709\u7684 <code>BetslipRepository</code> / <code>BetslipClient</code> - [ ] \u932f\u8aa4\u6642\u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI</p> <p>Reference: - TDD: <code>01_Integrated Service-Level Sequence Diagram/01_full_integration_flow.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-partialerrortoast","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - PartialErrorToast","text":"<p>Type: Story Story Points: 1 Labels: <code>ui</code>, <code>component</code>, <code>toast</code></p> <p>Description: \u5be6\u4f5c\u90e8\u5206\u8f49\u63db\u5931\u6557\u7684 Toast \u63d0\u793a\u3002</p> <p>Acceptance Criteria: - [ ] \u7576 <code>failCnt &gt; 0</code> \u6642\u986f\u793a - [ ] \u986f\u793a\u5931\u6557\u6578\u91cf: \"X selections failed to convert\" - [ ] \u81ea\u52d5\u6d88\u5931 (3 \u79d2) - [ ] \u5e95\u90e8\u986f\u793a\uff0c\u4e0d\u906e\u64cb Betslip \u5167\u5bb9</p> <p>Figma Reference: - Node: <code>26428-71769</code> (Partial)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-ui","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - \u8f49\u63db\u7d50\u679c UI \u72c0\u614b","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>state</code></p> <p>Description: \u5be6\u4f5c\u8f49\u63db\u7d50\u679c\u7684\u5404\u7a2e UI \u72c0\u614b\u3002</p> <p>Acceptance Criteria: - [ ] \u5b8c\u5168\u6210\u529f: Betslip \u6b63\u5e38\u986f\u793a\u6240\u6709 selections - [ ] \u90e8\u5206\u6210\u529f: Betslip \u986f\u793a + PartialErrorToast - [ ] \u5b8c\u5168\u5931\u6557: \u986f\u793a 1.0.6 Error UI</p> <p>Figma Reference: - Node: <code>26428-71768</code> (Success) - Node: <code>26428-71769</code> (Partial) - Node: <code>26453-93353</code> (Error)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-5-polish-0113","title":"Day 5: \u932f\u8aa4\u8655\u7406 + \u6e2c\u8a66 + Polish (01/13)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - \u5b8c\u6574\u932f\u8aa4\u8655\u7406","text":"<p>Type: Story Story Points: 2 Labels: <code>error-handling</code></p> <p>Description: \u5be6\u4f5c\u5b8c\u6574\u7684\u932f\u8aa4\u8655\u7406\u908f\u8f2f\u3002</p> <p>Acceptance Criteria: - [ ] Config API \u5931\u6557: \u986f\u793a \"Config Load Failed\" \u932f\u8aa4 - [ ] Convert API \u5931\u6557: \u986f\u793a API \u932f\u8aa4\u8a0a\u606f (1.0.6 Error) - [ ] Liabilities API \u5931\u6557: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI - [ ] Betslip API \u5931\u6557: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI - [ ] \u7db2\u8def\u932f\u8aa4\u8655\u7406 - [ ] Retry \u6a5f\u5236 (\u5982\u6709\u9700\u8981)</p> <p>Reference: - TDD: <code>09_Error Handling/01_error_handling.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-unit-tests","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Unit Tests","text":"<p>Type: Task Story Points: 2 Labels: <code>testing</code>, <code>unit-test</code></p> <p>Description: \u64b0\u5beb\u6838\u5fc3\u908f\u8f2f\u7684 Unit Tests\u3002</p> <p>Acceptance Criteria: - [ ] <code>LoadProviderConfigUseCase</code> tests - [ ] <code>ConvertBookingCodeUseCase</code> tests - [ ] <code>LoadCodeWidget.Feature</code> reducer tests   - Config \u8f09\u5165\u6210\u529f/\u5931\u6557   - Bookie \u9078\u64c7\u908f\u8f2f   - \u8f49\u63db\u6210\u529f/\u90e8\u5206\u6210\u529f/\u5931\u6557</p> <p>Reference: - TDD: <code>10_Test Scenarios/01_test_scenarios.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-ui-polish-review","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - UI Polish &amp; Review","text":"<p>Type: Task Story Points: 1 Labels: <code>polish</code>, <code>review</code></p> <p>Description: \u6700\u7d42 UI \u8abf\u6574\u548c\u7a0b\u5f0f\u78bc Review\u3002</p> <p>Acceptance Criteria: - [ ] \u5c0d\u7167 Figma \u6aa2\u67e5\u6240\u6709 UI \u72c0\u614b - [ ] \u52d5\u756b\u548c\u8f49\u5834\u6548\u679c - [ ] Code Review \u4fee\u6539 - [ ] \u6587\u4ef6\u66f4\u65b0 (\u5982\u6709\u9700\u8981)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#sprint-burndown","title":"\ud83d\udcca Sprint Burndown \u8ffd\u8e64","text":"Day \u5b8c\u6210 Tickets \u7d2f\u8a08 SP \u5269\u9918 SP Day 1 25 Day 2 Day 3 Day 4 Day 5 0"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#_1","title":"\ud83d\udea8 \u98a8\u96aa\u8207\u963b\u585e","text":"\u98a8\u96aa \u5f71\u97ff \u7de9\u89e3\u63aa\u65bd BE API \u5c1a\u672a\u5b8c\u6210 \u7121\u6cd5\u9032\u884c\u6574\u5408\u6e2c\u8a66 \u4f7f\u7528 Mock Data \u958b\u767c Figma \u8a2d\u8a08\u7d30\u7bc0\u4e0d\u660e\u78ba UI \u5be6\u4f5c\u5ef6\u9072 \u63d0\u524d\u8207 UED \u78ba\u8a8d \u65e2\u6709 Betslip \u6d41\u7a0b\u4e0d\u719f\u6089 \u6574\u5408\u56f0\u96e3 Day 4 \u524d\u5148\u7814\u7a76\u65e2\u6709\u7a0b\u5f0f\u78bc"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#daily-standup-template","title":"\ud83d\udcdd Daily Standup Template","text":"<pre><code>### [\u65e5\u671f] Standup\n\n**\u6628\u5929\u5b8c\u6210:**\n- \n\n**\u4eca\u5929\u8a08\u5283:**\n- \n\n**\u963b\u585e:**\n- \u7121 / \u6709: [\u63cf\u8ff0]\n</code></pre>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#_2","title":"\ud83d\udd17 \u76f8\u95dc\u9023\u7d50","text":"<ul> <li>Epic: FOOTBALL-9161</li> <li>Figma: Code-Converter</li> <li>PRD: <code>PRDs/01_PRD/01_06/Fcom_PRD_Booking_Code_Converter_01_06_zh-TW.md</code></li> <li>API Doc: <code>Docs/API_Doc/Code_Converter_API_Doc.md</code></li> </ul>"}]}