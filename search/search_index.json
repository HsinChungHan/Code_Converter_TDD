{"config":{"lang":["en","zh"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Code Converter Phase 1 - Technical Design Document","text":"<p>\u529f\u80fd: Booking Code Converter (Code2Code) \u7248\u672c: Phase 1 \u6700\u5f8c\u66f4\u65b0: 2025-01-14</p>"},{"location":"#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e Config API \u5ee2\u68c4 ~~<code>GET /orders/converter/config/providerCountries</code>~~ \u4e0d\u518d\u4f7f\u7528 Provider/Country \u79fb\u9664 Convert API \u53ea\u9700 <code>bookingCode</code>\uff0cBE \u81ea\u52d5\u8b58\u5225 Bookie Selector \u5ee2\u68c4 \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie \u6d41\u7a0b Tooltip \u65b0\u589e \u9996\u6b21\u4f7f\u7528\u986f\u793a\u5f15\u5c0e\uff0c\u4ee5 Device ID \u5132\u5b58"},{"location":"#_1","title":"\ud83c\udfaf \u529f\u80fd\u6982\u8ff0","text":"<p>Code Converter \u8b93\u7528\u6236\u53ef\u4ee5\u5c07\u4efb\u610f Booking Code \u8f49\u63db\u70ba Fcom \u7684 Share Code\uff0c\u4e26\u76f4\u63a5\u8f09\u5165\u5230 Betslip \u9032\u884c\u6295\u6ce8\u3002</p>"},{"location":"#_2","title":"\u6838\u5fc3\u6d41\u7a0b","text":"<pre><code>sequenceDiagram\n    actor User\n    participant App\n    participant BE as Backend\n\n    Note over App: \ud83d\udcd0 Tooltip (\u9996\u6b21\u4f7f\u7528)\n    User-&gt;&gt;App: \u8f38\u5165\u4efb\u610f Booking Code\n    App-&gt;&gt;BE: POST /orders/converter/code {bookingCode}\n    BE--&gt;&gt;App: \u8fd4\u56de {shareCode, successCnt, failCnt}\n    Note over App: \u8d70\u539f\u6709 Load Code \u6d41\u7a0b\n    App-&gt;&gt;BE: GET /bookingCode/{shareCode}/liabilities\n    App-&gt;&gt;BE: GET /orders/share/{shareCode}\n    BE--&gt;&gt;App: \u8fd4\u56de Betslip \u8cc7\u6599\n    App--&gt;&gt;User: \u986f\u793a Betslip</code></pre>"},{"location":"#_3","title":"\ud83d\udcda \u6587\u4ef6\u5c0e\u89bd","text":""},{"location":"#_4","title":"\u5feb\u901f\u958b\u59cb","text":"\u7ae0\u7bc0 \u8aaa\u660e Overview \u529f\u80fd\u6982\u8ff0\u3001\u5fa9\u7528\u7b56\u7565\u3001\u5be6\u4f5c\u512a\u5148\u7d1a Sprint Plan 5 \u5929\u958b\u767c\u8a08\u5283\u8207 Jira Tickets"},{"location":"#_5","title":"\u67b6\u69cb\u8a2d\u8a08","text":"\u7ae0\u7bc0 \u8aaa\u660e \u5b8c\u6574\u6d41\u7a0b\u5e8f\u5217\u5716 \u7aef\u5230\u7aef\u7684\u670d\u52d9\u6d41\u7a0b Clean Architecture \u5206\u5c64\u67b6\u69cb\u5716 \u6a21\u7d44\u8077\u8cac \u5404\u6a21\u7d44\u7684\u8077\u8cac\u5b9a\u7fa9"},{"location":"#view-layer","title":"View Layer","text":"\u7ae0\u7bc0 \u8aaa\u660e View \u5be6\u4f5c SwiftUI View \u5be6\u4f5c\u7d30\u7bc0 \u8a2d\u8a08\u898f\u683c Figma \u8a2d\u8a08\u898f\u683c\uff08\u984f\u8272\u3001\u5b57\u578b\u3001\u9593\u8ddd\uff09 State \u2194 Figma \u5c0d\u7167 State \u8207 Figma Node \u5c0d\u7167\u8868 \u2b50 UI \u66ff\u63db\u7b56\u7565 01_09 \u7248\u672c UI \u66ff\u63db\u7b56\u7565 \ud83c\udd95 Tooltip \u908f\u8f2f Tooltip \u986f\u793a\u908f\u8f2f"},{"location":"#domain-layer","title":"Domain Layer","text":"\u7ae0\u7bc0 \u8aaa\u660e Domain Model Domain \u6a21\u578b\u5b9a\u7fa9 TCA State &amp; Action TCA Feature \u5b9a\u7fa9 UseCase I/O UseCase \u8f38\u5165\u8f38\u51fa\u6a21\u578b"},{"location":"#data-layer","title":"Data Layer","text":"\u7ae0\u7bc0 \u8aaa\u660e API \u898f\u683c API Endpoints \u898f\u683c DTO Mapping DTO \u8207 Domain Model \u6620\u5c04"},{"location":"#_6","title":"\u5176\u4ed6","text":"\u7ae0\u7bc0 \u8aaa\u660e Error Handling \u932f\u8aa4\u8655\u7406\u7b56\u7565 Test Scenarios \u6e2c\u8a66\u60c5\u5883\u8207\u7bc4\u4f8b Risks &amp; Questions \u98a8\u96aa\u8a55\u4f30\u8207\u5f85\u78ba\u8a8d\u4e8b\u9805"},{"location":"#_7","title":"\ud83c\udfd7\ufe0f \u67b6\u69cb\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        UI Layer                             \u2502\n\u2502  LoadBookingCodeSectionView \u2502 TooltipView \u2502 PartialErrorToast \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      Domain Layer (TCA)                      \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502  LoadBookingCodeSection.Feature (\u64f4\u5c55)                   \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                             \u2502                                \u2502\n\u2502            \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510               \u2502\n\u2502            \u2502 ConvertBookingCodeUseCase       \u2502               \u2502\n\u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                              \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   Data &amp; Infrastructure                      \u2502\n\u2502  CodeConverterRepository \u2502 CodeConverterClient \u2502 API         \u2502\n\u2502  TooltipStorage (UserDefaults)                               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"#_8","title":"\u5ee2\u68c4\u9805\u76ee","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 ~~BookieSelectorSheet~~ UI \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie ~~LoadProviderConfigUseCase~~ UseCase Config API \u5df2\u5ee2\u68c4 ~~Config API~~ API BE \u65b0\u8a2d\u8a08\u4e0d\u9700\u8981"},{"location":"#_9","title":"\ud83d\udcc5 \u958b\u767c\u6642\u7a0b","text":"Phase \u5167\u5bb9 \u6642\u7a0b Phase 1.1 \u64f4\u5c55\u73fe\u6709\u5143\u4ef6 + Tooltip Day 1-2 Phase 1.2 \u65b0\u589e Data Layer Day 2-3 Phase 1.3 \u66ff\u63db\u5165\u53e3\u9ede Day 4 Phase 1.4 \u6e05\u7406 &amp; \u6e2c\u8a66 Day 5"},{"location":"#_10","title":"\ud83d\udd17 \u76f8\u95dc\u9023\u7d50","text":"<ul> <li>Epic: FOOTBALL-9161</li> <li>Figma: Code-Converter</li> <li>PRD: \u53c3\u898b <code>/PRDs/01_PRD/01_06/</code></li> </ul>"},{"location":"00_Overview/","title":"00_Overview","text":"<p>\u672c\u7ae0\u7bc0\u8aaa\u660e Code Converter Phase 1 (Code2Code) \u529f\u80fd\u7684\u6574\u9ad4\u76ee\u6a19\u3001\u7bc4\u570d\u8207\u50f9\u503c\u4e3b\u5f35\u3002</p>"},{"location":"00_Overview/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_overview.md \u529f\u80fd\u6982\u8ff0\u3001\u76ee\u6a19\u7528\u6236\u3001\u6838\u5fc3\u6d41\u7a0b\u3001\u8cc7\u6599\u4f86\u6e90"},{"location":"00_Overview/01_overview/","title":"Code Converter Phase 1 - TDD Overview","text":""},{"location":"00_Overview/01_overview/#_1","title":"\u529f\u80fd\u6982\u8ff0","text":"<p>Code Converter \u662f\u4e00\u500b\u8b93\u7528\u6236\u5c07\u5176\u4ed6\u535a\u5f69\u516c\u53f8\uff08Bookie\uff09\u7684 Booking Code \u8f49\u63db\u70ba Fcom Booking Code \u7684\u529f\u80fd\u3002Phase 1 \u5be6\u4f5c Code2Code \u8f49\u63db\uff0c\u652f\u63f4\u7528\u6236\u624b\u52d5\u8f38\u5165\u7af6\u722d\u5c0d\u624b\u7684 Booking Code \u4e26\u8f49\u63db\u3002</p>"},{"location":"00_Overview/01_overview/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u820a\u7248 \u65b0\u7248 Provider/Country \u9078\u64c7 \u9700\u5148\u9078\u64c7 Bookie (Provider + Country) \u274c \u5ee2\u68c4 - \u4e0d\u9700\u9078\u64c7 Config API <code>GET /orders/converter/config/providerCountries</code> \u274c \u5ee2\u68c4 Convert API <code>POST /orders/converter/code</code> (\u542b provider, country) <code>POST /orders/converter/code</code> (\u53ea\u9700 bookingCode) Bookie Selector Sheet \u9700\u8981\u5be6\u4f5c \u274c \u5ee2\u68c4 - \u4e0d\u9700\u5be6\u4f5c \u6d41\u7a0b \u9078 Bookie \u2192 \u8f38\u5165 Code \u2192 \u8f49\u63db \u8f38\u5165 Code \u2192 \u8f49\u63db \u2192 \u8d70\u539f\u6709 load code \u6d41\u7a0b"},{"location":"00_Overview/01_overview/#_2","title":"\u6838\u5fc3\u9700\u6c42","text":"\u9700\u6c42 \u8aaa\u660e \u8f38\u5165 \u7528\u6236\u8f38\u5165\u4efb\u610f Booking Code\uff08\u7121\u9700\u9078\u64c7 Provider\uff09 \u8f49\u63db \u8abf\u7528\u5f8c\u7aef API \u9032\u884c Code2Code \u8f49\u63db \u8f38\u51fa \u751f\u6210 Fcom ShareCode\uff0c\u8d70\u539f\u6709 load code \u6d41\u7a0b\u5c0e\u822a\u81f3 Betslip \u932f\u8aa4\u8655\u7406 Code Not Found\u3001Partial Failure\u3001All Failed Tooltip \u9996\u6b21\u4f7f\u7528\u6642\u986f\u793a\u5f15\u5c0e Tooltip"},{"location":"00_Overview/01_overview/#tooltip","title":"Tooltip \u529f\u80fd","text":""},{"location":"00_Overview/01_overview/#_3","title":"\u884c\u70ba\u63cf\u8ff0","text":"\u9805\u76ee \u8aaa\u660e \u986f\u793a\u6642\u6a5f \u529f\u80fd\u4e0a\u7dda\u5f8c\uff0c\u6240\u6709 Load Code Widget \u51fa\u73fe\u8655 \u986f\u793a\u4f4d\u7f6e \u9996\u9801 Widget\u3001Code Center\u3001Betslip Empty \u7b49 \u6d88\u5931\u689d\u4ef6 User \u7b2c\u4e00\u6b21\u5728\u4efb\u610f\u5730\u65b9\u9ede\u64ca\u95dc\u9589 Tooltip \u5132\u5b58\u6a5f\u5236 \u4ee5 Device ID \u5224\u65b7\u662f\u5426\u518d\u6b21\u51fa\u73fe \u8de8\u5165\u53e3\u540c\u6b65 \u4efb\u4e00\u5165\u53e3\u95dc\u9589\u5f8c\uff0c\u6240\u6709\u5165\u53e3\u7686\u4e0d\u518d\u986f\u793a"},{"location":"00_Overview/01_overview/#tooltip-ui-figma-100","title":"Tooltip UI (\u53c3\u8003 Figma 1.0.0)","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \ud83d\udca1 Insert a booking code from any provider  \u2715     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"00_Overview/01_overview/#_4","title":"\u5165\u53e3\u9ede","text":"\u4f4d\u7f6e \u73fe\u6709\u5be6\u4f5c \u66ff\u63db\u70ba \u9996\u9801 Widget <code>LoadBookingCodeSectionView</code> <code>LoadCodeWidgetView</code>\uff08\u539f\u5730\u64f4\u5c55\uff09 Code Center Load Code Tab <code>LoadCodeViewWrapper</code> \u2192 <code>LoadCodeViewController</code> (UIKit) <code>LoadCodeWidgetView</code> (SwiftUI) \u9996\u9801 Betslip (Empty) \u65e2\u6709\u7a7a\u72c0\u614b \u5d4c\u5165 <code>LoadCodeWidgetView</code>"},{"location":"00_Overview/01_overview/#_5","title":"\u5fa9\u7528\u7b56\u7565\uff08\u6838\u5fc3\u8a2d\u8a08\u6c7a\u7b56\uff09","text":""},{"location":"00_Overview/01_overview/#loadbookingcodesectionview","title":"\u6700\u5927\u5316\u5fa9\u7528 LoadBookingCodeSectionView","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u5fa9\u7528\u7b56\u7565                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u2705 \u64f4\u5c55\u73fe\u6709 View/Feature \u7d50\u69cb                                       \u2502\n\u2502  \u2705 \u4fdd\u6301\u539f\u6709 API \u5411\u5f8c\u76f8\u5bb9                                            \u2502\n\u2502  \u2705 \u65b0\u529f\u80fd\u4ee5 optional flag (enableCodeConverter) \u63a7\u5236                \u2502\n\u2502  \u2705 \u5b50\u5143\u4ef6\u64f4\u5c55\u800c\u975e\u91cd\u5beb                                               \u2502\n\u2502  \u2705 \u6f38\u9032\u5f0f\u66ff\u63db LoadCodeViewController                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"00_Overview/01_overview/#_6","title":"\u5143\u4ef6\u5c0d\u7167\u8868","text":"\u73fe\u6709\u5143\u4ef6 \u64f4\u5c55\u70ba \u8b8a\u66f4\u985e\u578b <code>LoadBookingCodeSectionView</code> <code>LoadCodeWidgetView</code> \u64f4\u5c55 ~~<code>CountryDropdownView</code>~~ ~~<code>BookieDropdownView</code>~~ \u274c \u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981 <code>BookingCodeInputView</code> <code>BookingCodeInputView</code> \u64f4\u5c55\uff08\u589e\u52a0\u72c0\u614b\uff09 <code>LoadBookingCodeSection.Feature</code> <code>LoadCodeWidget.Feature</code> \u64f4\u5c55 ~~<code>BookieSelectorSheet</code>~~ - \u274c \u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981 - <code>TooltipView</code> \u65b0\u589e (SwiftUI)"},{"location":"00_Overview/01_overview/#ui-6","title":"UI \u72c0\u614b\u5c0d\u7167\uff086 \u7a2e\u72c0\u614b\uff09","text":"\u72c0\u614b \u8f38\u5165\u6846\u908a\u6846 \u6e05\u9664\u6309\u9215 Load \u6309\u9215 \u63d0\u793a\u6587\u5b57 Default \u7121 \u96b1\u85cf \u7070\u8272\u7981\u7528 \u7121 Focus \u7da0\u8272 \u96b1\u85cf \u7070\u8272\u7981\u7528 \u7121 Typing \u7da0\u8272 \u986f\u793a \u2297 \u7da0\u8272\u555f\u7528 \u7121 Filled \u7121 \u986f\u793a \u2297 \u7da0\u8272\u555f\u7528 \u7121 Loading \u7121 \u96b1\u85cf Spinner \"Conversion may take up to 10 seconds...\" Error \u7d05\u8272 \u986f\u793a \u2297 \u7da0\u8272\u555f\u7528 \u7d05\u8272\u932f\u8aa4\u8a0a\u606f"},{"location":"00_Overview/01_overview/#_7","title":"\u6280\u8853\u67b6\u69cb","text":""},{"location":"00_Overview/01_overview/#clean-architecture","title":"Clean Architecture \u5206\u5c64","text":"<pre><code>UI Layer (SwiftUI)\n    \u2514\u2500\u2500 LoadCodeWidgetView, TooltipView\n\nDomain Layer (TCA)\n    \u251c\u2500\u2500 Feature: LoadCodeWidget.Feature\n    \u2514\u2500\u2500 UseCase: ConvertBookingCodeUseCase\n\nDomain Model\n    \u2514\u2500\u2500 ConvertResult, WidgetInputState\n\nData &amp; Infrastructure Layer\n    \u251c\u2500\u2500 Repository: CodeConverterRepository\n    \u251c\u2500\u2500 Client: CodeConverterClient\n    \u251c\u2500\u2500 API: CodeConverterAPI\n    \u2514\u2500\u2500 TooltipStorage (UserDefaults + Device ID)\n</code></pre>"},{"location":"00_Overview/01_overview/#api-endpoints","title":"API Endpoints","text":"API \u7528\u9014 \u72c0\u614b ~~<code>GET /orders/converter/config/providerCountries</code>~~ ~~\u53d6\u5f97 Provider Config~~ \u274c \u5ee2\u68c4 <code>POST /orders/converter/code</code> Code2Code \u8f49\u63db (\u53ea\u9700 bookingCode) \u2705 \u4f7f\u7528\u4e2d <code>GET /bookingCode/{shareCode}/liabilities</code> Liabilities \u6aa2\u67e5\uff08\u65e2\u6709\u6d41\u7a0b\uff09 \u2705 \u4f7f\u7528\u4e2d <code>GET /orders/share/{shareCode}</code> \u53d6\u5f97 Betslip Data\uff08\u65e2\u6709\u6d41\u7a0b\uff09 \u2705 \u4f7f\u7528\u4e2d"},{"location":"00_Overview/01_overview/#_8","title":"\u5be6\u4f5c\u512a\u5148\u7d1a","text":""},{"location":"00_Overview/01_overview/#phase-11","title":"Phase 1.1: \u64f4\u5c55\u73fe\u6709\u5143\u4ef6","text":"<ol> <li>\u64f4\u5c55 <code>LoadBookingCodeSection.State/Action/Feature</code></li> <li>\u64f4\u5c55 <code>BookingCodeInputView</code>\uff08\u589e\u52a0 6 \u7a2e\u72c0\u614b\uff09</li> <li>~~\u64f4\u5c55 <code>CountryDropdownView</code> \u2192 <code>BookieDropdownView</code>~~ \u274c \u5ee2\u68c4</li> <li>~~\u65b0\u589e <code>BookieSelectorSheet</code> (SwiftUI)~~ \u274c \u5ee2\u68c4</li> <li>\u65b0\u589e <code>TooltipView</code> (SwiftUI)</li> <li>\u5be6\u4f5c Tooltip \u5132\u5b58\u908f\u8f2f (Device ID)</li> </ol>"},{"location":"00_Overview/01_overview/#phase-12-data-layer","title":"Phase 1.2: \u65b0\u589e Data Layer","text":"<ol> <li>\u5b9a\u7fa9 Domain Models</li> <li>\u5be6\u4f5c <code>CodeConverterRepository</code></li> <li>\u5be6\u4f5c <code>CodeConverterClient</code></li> <li>~~\u5be6\u4f5c <code>LoadProviderConfigUseCase</code>~~ \u274c \u5ee2\u68c4</li> <li>\u5be6\u4f5c <code>ConvertBookingCodeUseCase</code></li> </ol>"},{"location":"00_Overview/01_overview/#phase-13","title":"Phase 1.3: \u66ff\u63db\u5165\u53e3\u9ede","text":"<ol> <li>\u9996\u9801 Widget\uff1a\u8a2d\u7f6e <code>enableCodeConverter = true</code> + Tooltip</li> <li>Code Center\uff1a\u7528 <code>LoadCodeWidgetView</code> \u66ff\u63db <code>LoadCodeViewWrapper</code> + Tooltip</li> <li>Betslip Empty\uff1a\u5d4c\u5165 <code>LoadCodeWidgetView</code> + Tooltip</li> </ol>"},{"location":"00_Overview/01_overview/#phase-14","title":"Phase 1.4: \u6e05\u7406","text":"<ol> <li>\u79fb\u9664 <code>LoadCodeViewController</code></li> <li>\u79fb\u9664 <code>LoadCodeViewController.xib</code></li> <li>\u79fb\u9664 <code>LoadCodeViewWrapper</code></li> </ol>"},{"location":"00_Overview/01_overview/#_9","title":"\u6e2c\u8a66\u7b56\u7565","text":"\u6e2c\u8a66\u985e\u578b \u7bc4\u570d \u512a\u5148\u7d1a Unit Test Domain Models, UseCases P0 TCA TestStore Feature State/Action P0 Integration Test API Client P1 UI Test \u95dc\u9375\u7528\u6236\u6d41\u7a0b P1"},{"location":"00_Overview/01_overview/#_10","title":"\u98a8\u96aa\u8207\u5f85\u78ba\u8a8d","text":"\u98a8\u96aa \u5f71\u97ff \u7de9\u89e3\u63aa\u65bd \u539f\u6709\u908f\u8f2f\u76f8\u5bb9\u6027 LoadCodeManager \u65e2\u6709\u547c\u53eb\u53ef\u80fd\u53d7\u5f71\u97ff \u4fdd\u6301 enableCodeConverter = false \u6642\u5b8c\u5168\u76f8\u5bb9 API \u56de\u50b3\u683c\u5f0f\u8b8a\u66f4 DTO \u6620\u5c04\u5931\u6557 \u8207\u5f8c\u7aef\u78ba\u8a8d\u5b8c\u6574 Response \u7d50\u69cb Betslip \u5c0e\u822a\u908f\u8f2f \u90e8\u5206\u5931\u6557\u6642\u7684 Betslip \u8f09\u5165 \u78ba\u8a8d shareCode \u662f\u5426\u53ea\u5305\u542b\u6210\u529f\u7684 selections \u6548\u80fd\uff08\u9577\u6642\u9593\u8f49\u63db\uff09 Loading \u72c0\u614b\u6700\u9577 10 \u79d2 \u986f\u793a\u63d0\u793a\u6587\u5b57\u63d0\u9192\u7528\u6236 Tooltip \u8de8\u5165\u53e3\u540c\u6b65 \u9700\u78ba\u4fdd\u6240\u6709\u5165\u53e3\u90fd\u8b80\u53d6\u540c\u4e00\u4efd flag \u4f7f\u7528\u7d71\u4e00\u7684 TooltipStorage + Device ID"},{"location":"00_Overview/01_overview/#_11","title":"\u7c21\u5316\u5f8c\u7684\u6d41\u7a0b\u5716","text":"<pre><code>sequenceDiagram\n    actor User\n    participant Widget as Load Code Widget\n    participant BE as Backend\n\n    Note over Widget: \ud83d\udcd0 Tooltip \u986f\u793a (\u9996\u6b21\u4f7f\u7528)\n    User-&gt;&gt;Widget: \u95dc\u9589 Tooltip\n    Note over Widget: \u5132\u5b58 Device ID\uff0c\u4e0d\u518d\u986f\u793a\n\n    User-&gt;&gt;Widget: \u8f38\u5165 Booking Code\n    User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n    Widget-&gt;&gt;BE: POST /orders/converter/code {bookingCode}\n\n    alt Convert API Success\n        BE--&gt;&gt;Widget: {shareCode, successCnt, failCnt}\n        Note over Widget: \u8d70\u539f\u6709 Load Code \u6d41\u7a0b\n        Widget-&gt;&gt;BE: GET /bookingCode/{shareCode}/liabilities\n        Widget-&gt;&gt;BE: GET /orders/share/{shareCode}\n        Widget-&gt;&gt;User: Pop up Betslip\n    else Convert API Error\n        BE--&gt;&gt;Widget: error\n        Widget-&gt;&gt;User: \u986f\u793a\u932f\u8aa4\u8a0a\u606f\n    end</code></pre>"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/","title":"01_Integrated Service-Level Sequence Diagram","text":"<p>\u672c\u7ae0\u7bc0\u5448\u73fe Code Converter Phase 1 \u7684\u6574\u5408\u5e8f\u5217\u5716\uff0c\u5c55\u793a\u5b8c\u6574\u7684 Code2Code \u8f49\u63db\u6d41\u7a0b\u3002</p>"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_full_integration_flow.md \u5b8c\u6574\u7684 Code2Code \u8f49\u63db\u6d41\u7a0b\uff08Service Level\uff09"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/","title":"Code2Code \u5b8c\u6574\u6574\u5408\u6d41\u7a0b","text":""},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#flow","title":"Flow \u8cc7\u8a0a","text":"\u6b04\u4f4d \u503c feature CodeConverter flow_id CC-ISSD-001 flow_type Full flow_name Code2Code \u5b8c\u6574\u6574\u5408\u6d41\u7a0b"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e Config API \u5ee2\u68c4 ~~<code>GET /orders/converter/config/providerCountries</code>~~ \u4e0d\u518d\u4f7f\u7528 Provider/Country \u79fb\u9664 Convert API \u4e0d\u518d\u9700\u8981 provider \u548c country \u53c3\u6578 Bookie Selector \u79fb\u9664 \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u6d41\u7a0b \u6d41\u7a0b\u7c21\u5316 \u76f4\u63a5\u8f38\u5165 Code \u2192 \u8f49\u63db \u2192 \u8d70\u539f\u6709 load code \u6d41\u7a0b"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#_1","title":"\u6d41\u7a0b\u8aaa\u660e","text":"\u968e\u6bb5 \u8aaa\u660e 0. Tooltip \u986f\u793a \u9996\u6b21\u4f7f\u7528\u6642\u986f\u793a\u5f15\u5c0e Tooltip\uff0c\u95dc\u9589\u5f8c\u4ee5 Device ID \u8a18\u9304\u4e0d\u518d\u986f\u793a 1. \u8f38\u5165 Booking Code 1. Focus \u8f38\u5165\u68462. \u8f38\u5165\u4efb\u610f Booking Code3. \u555f\u7528 Load \u6309\u9215 2. \u8f49\u63db\u6d41\u7a0b 1. \u547c\u53eb Convert API\uff08\u53ea\u5e36 bookingCode\uff092. \u53d6\u5f97 shareCode 3. \u539f\u6709 Load Code \u6d41\u7a0b 1. \u6aa2\u67e5 Liabilities2. \u53d6\u5f97 Betslip Data3. \u8f09\u5165 Betslip"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#_2","title":"\u6574\u5408\u5e8f\u5217\u5716","text":"<pre><code>sequenceDiagram\n    actor User\n\n    box rgb(207,232,255) UI Layer\n        participant Widget as LoadCodeWidgetView\n        participant Tooltip as TooltipView\n        participant Betslip as Betslip\n    end\n\n    box rgb(255,250,205) Domain Layer\n        participant Feature as LoadCodeWidget.Feature\n        participant ConvertUC as ConvertBookingCodeUseCase\n    end\n\n    box rgb(240,240,240) Data and Infrastructure Layer\n        participant CCRepo as CodeConverterRepository\n        participant CCClient as CodeConverterClient\n        participant ConvertAPI as POST /orders/converter/code\n        participant BetslipRepo as BetslipRepository (\u65e2\u6709)\n        participant BetslipClient as BetslipClient (\u65e2\u6709)\n        participant LiabAPI as GET /bookingCode/{shareCode}/liabilities\n        participant ShareAPI as GET /orders/share/{shareCode}\n        participant Storage as TooltipStorage\n    end\n\n    Note over User,Widget: \u4f7f\u7528\u8005\u9032\u5165\u9996\u9801\u6216 Code Center\n\n    %% 0. Tooltip \u6aa2\u67e5\n    Widget-&gt;&gt;Storage: \u6aa2\u67e5 Device ID \u662f\u5426\u5df2\u95dc\u9589 Tooltip\n\n    alt \u9996\u6b21\u4f7f\u7528\uff08\u672a\u95dc\u9589\u904e\uff09\n        Storage--&gt;&gt;Widget: shouldShowTooltip = true\n        Widget-&gt;&gt;Tooltip: \u986f\u793a Tooltip\n        Note over Tooltip: \ud83d\udca1 Insert a booking code from any provider\n        User-&gt;&gt;Tooltip: \u9ede\u64ca\u95dc\u9589 (\u2715)\n        Tooltip-&gt;&gt;Storage: \u5132\u5b58 Device ID\uff08\u5df2\u95dc\u9589\uff09\n        Tooltip--&gt;&gt;Widget: \u96b1\u85cf Tooltip\n    else \u5df2\u95dc\u9589\u904e\n        Storage--&gt;&gt;Widget: shouldShowTooltip = false\n        Note over Widget: \u4e0d\u986f\u793a Tooltip\n    end\n\n    %% 1. \u8f38\u5165 Booking Code\n    User-&gt;&gt;Widget: \u9ede\u64ca\u8f38\u5165\u6846\n    Widget-&gt;&gt;Feature: .inputFocused\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Focus \u72c0\u614b\n    User-&gt;&gt;Widget: \u8f38\u5165 Booking Code\n    Widget-&gt;&gt;Feature: .bookingCodeChanged(code)\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Typing/Filled \u72c0\u614b\n\n    %% 2. \u8f49\u63db\u6d41\u7a0b\n    User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n    Widget-&gt;&gt;Feature: .loadButtonTapped\n    Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Loading \u72c0\u614b\n    Feature-&gt;&gt;ConvertUC: execute(bookingCode)\n\n    ConvertUC-&gt;&gt;CCRepo: convertCode(bookingCode)\n    CCRepo-&gt;&gt;CCClient: convertCode(request)\n    CCClient-&gt;&gt;ConvertAPI: POST /orders/converter/code\n    Note over CCClient,ConvertAPI: Request: {bookingCode}\n\n    alt Convert API Success\n        ConvertAPI--&gt;&gt;CCClient: {bizCode: 10000, shareCode, successCnt, failCnt}\n        CCClient--&gt;&gt;CCRepo: Code2CodeVO\n        CCRepo--&gt;&gt;ConvertUC: ConvertResult\n\n        %% 3. \u539f\u6709 Load Code \u6d41\u7a0b - Check Liabilities\n        Note over ConvertUC,LiabAPI: \u539f\u6709 Load Code \u6d41\u7a0b - Check Liabilities\n        ConvertUC-&gt;&gt;BetslipRepo: checkLiabilities(shareCode)\n        BetslipRepo-&gt;&gt;BetslipClient: getLiabilities(shareCode)\n        BetslipClient-&gt;&gt;LiabAPI: GET /bookingCode/{shareCode}/liabilities\n        LiabAPI--&gt;&gt;BetslipClient: LiabilitiesDTO\n        BetslipClient--&gt;&gt;BetslipRepo: LiabilitiesDTO\n        BetslipRepo--&gt;&gt;ConvertUC: Liabilities\n\n        %% 3. \u539f\u6709 Load Code \u6d41\u7a0b - Get Betslip Data\n        Note over ConvertUC,ShareAPI: \u539f\u6709 Load Code \u6d41\u7a0b - Get Betslip Data\n        ConvertUC-&gt;&gt;BetslipRepo: getBetslipData(shareCode)\n        BetslipRepo-&gt;&gt;BetslipClient: getShareOrder(shareCode)\n        BetslipClient-&gt;&gt;ShareAPI: GET /orders/share/{shareCode}\n        ShareAPI--&gt;&gt;BetslipClient: BetslipDataDTO\n        BetslipClient--&gt;&gt;BetslipRepo: BetslipDataDTO\n        BetslipRepo--&gt;&gt;ConvertUC: BetslipData\n\n        ConvertUC--&gt;&gt;Feature: ConvertBookingCodeOutput\n        Feature-&gt;&gt;Betslip: \u8f09\u5165 selections\n        Betslip-&gt;&gt;User: \u986f\u793a Betslip\n\n        opt failCnt &gt; 0\n            Note over Betslip: \u90e8\u5206\u8f49\u63db\u5931\u6557\n            Betslip-&gt;&gt;User: \u986f\u793a Toast \"X selections failed to convert\"\n        end\n\n    else Convert API Error\n        ConvertAPI--&gt;&gt;CCClient: error response\n        CCClient--&gt;&gt;CCRepo: error\n        CCRepo--&gt;&gt;ConvertUC: error\n        ConvertUC--&gt;&gt;Feature: error\n        Feature-&gt;&gt;Widget: \u66f4\u65b0\u70ba Error \u72c0\u614b\n        Widget-&gt;&gt;User: \u986f\u793a\u932f\u8aa4\u8a0a\u606f\n    end</code></pre>"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#api","title":"API \u8abf\u7528\u9806\u5e8f","text":"\u9806\u5e8f API Method \u8aaa\u660e \u72c0\u614b ~~1~~ ~~<code>/orders/converter/config/providerCountries</code>~~ ~~<code>GET</code>~~ ~~\u53d6\u5f97 Provider Country \u8a2d\u5b9a~~ \u274c \u5ee2\u68c4 1 <code>/orders/converter/code</code> <code>POST</code> \u8f49\u63db Booking Code (\u53ea\u9700 bookingCode) \u2705 2 <code>/bookingCode/{shareCode}/liabilities</code> <code>GET</code> \u6aa2\u67e5 Liabilities\uff08\u65e2\u6709\u6d41\u7a0b\uff09 \u2705 3 <code>/orders/share/{shareCode}</code> <code>GET</code> \u53d6\u5f97 Betslip Data\uff08\u65e2\u6709\u6d41\u7a0b\uff09 \u2705"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#tooltip","title":"Tooltip \u5132\u5b58\u908f\u8f2f","text":""},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#tooltipstorage","title":"TooltipStorage","text":"<pre><code>struct TooltipStorage {\n    private let userDefaults: UserDefaults\n    private let key = \"CodeConverter.TooltipDismissed\"\n\n    var shouldShowTooltip: Bool {\n        !userDefaults.bool(forKey: key)\n    }\n\n    func dismissTooltip() {\n        userDefaults.set(true, forKey: key)\n    }\n}\n</code></pre>"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#device-id","title":"Device ID \u7d81\u5b9a\u8aaa\u660e","text":"\u9805\u76ee \u8aaa\u660e \u5132\u5b58\u4f4d\u7f6e UserDefaults (App Sandbox) Key <code>CodeConverter.TooltipDismissed</code> Value <code>Bool</code> (true = \u5df2\u95dc\u9589) \u8de8\u88dd\u7f6e \u4e0d\u540c\u6b65\uff08\u6bcf\u500b Device \u7368\u7acb\uff09 \u91cd\u88dd App \u6703\u91cd\u7f6e\uff08\u9996\u6b21\u5b89\u88dd\u986f\u793a Tooltip\uff09"},{"location":"01_Integrated%20Service-Level%20Sequence%20Diagram/01_full_integration_flow/#_3","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>GET /orders/converter/config/providerCountries</code> API BE \u65b0\u8a2d\u8a08\u4e0d\u518d\u9700\u8981 <code>LoadProviderConfigUseCase</code> UseCase \u7121\u9700\u8f09\u5165 Provider Config <code>BookieSelectorSheet</code> UI \u7121\u9700\u9078\u64c7 Bookie <code>BookieDropdownView</code> UI \u7121\u9700\u986f\u793a Bookie Dropdown <code>ProviderConfig</code> Domain Model \u7121\u9700 Provider \u8a2d\u5b9a <code>SelectedBookie</code> Domain Model \u7121\u9700 Bookie \u9078\u64c7 <code>.bookieDropdownTapped</code> Action \u7121\u9700\u89f8\u767c Bookie Dropdown <code>.bookieSelected</code> Action \u7121\u9700\u8655\u7406 Bookie \u9078\u64c7 <code>providerConfigs</code> State \u7121\u9700\u5132\u5b58 Provider \u8a2d\u5b9a <code>selectedBookie</code> State \u7121\u9700\u5132\u5b58\u5df2\u9078 Bookie <code>isBookieSelectorPresented</code> State \u7121\u9700\u63a7\u5236 Sheet \u986f\u793a"},{"location":"02_Architecture/","title":"02_Architecture","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter Phase 1 \u7684 Clean Architecture \u5206\u5c64\u7d50\u69cb\u8207\u4f9d\u8cf4\u65b9\u5411\u3002</p>"},{"location":"02_Architecture/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_clean_architecture_diagram.md Clean Architecture \u5206\u5c64\u5716\u8207\u4f9d\u8cf4\u8aaa\u660e"},{"location":"02_Architecture/01_clean_architecture_diagram/","title":"Clean Architecture \u5206\u5c64\u5716","text":""},{"location":"02_Architecture/01_clean_architecture_diagram/#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e BookieSelectorSheet \u79fb\u9664 \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u6d41\u7a0b LoadProviderConfigUseCase \u79fb\u9664 Config API \u5df2\u5ee2\u68c4 ProviderConfig \u79fb\u9664 \u4e0d\u518d\u9700\u8981 Provider \u8a2d\u5b9a TooltipView \u65b0\u589e \u4e00\u6b21\u6027\u8aaa\u660e Tooltip TooltipStorage \u65b0\u589e Tooltip \u72c0\u614b\u5132\u5b58 (UserDefaults)"},{"location":"02_Architecture/01_clean_architecture_diagram/#_1","title":"\u67b6\u69cb\u7e3d\u89bd","text":"<pre><code>flowchart TB\n    subgraph UI[\"UI Layer (SwiftUI)\"]\n        direction TB\n        LCW[LoadCodeWidgetView&lt;br/&gt;\u64f4\u5c55\u81ea LoadBookingCodeSectionView]\n        Tooltip[TooltipView&lt;br/&gt;\u65b0\u589e SwiftUI]\n        Toast[PartialErrorToast]\n    end\n\n    subgraph Domain[\"Domain Layer (TCA)\"]\n        direction TB\n        subgraph Feature[\"Feature (Thin Reducer)\"]\n            LCF[LoadCodeWidget.Feature&lt;br/&gt;\u64f4\u5c55\u81ea LoadBookingCodeSection.Feature]\n        end\n        subgraph UseCase[\"UseCase (Business Logic)\"]\n            CBC[ConvertBookingCodeUseCase]\n        end\n    end\n\n    subgraph DomainModel[\"Domain Model Layer\"]\n        direction TB\n        CR[ConvertResult]\n        WS[WidgetInputState]\n    end\n\n    subgraph Data[\"Data &amp; Infrastructure Layer\"]\n        direction TB\n        CCR[CodeConverterRepository]\n        CCC[CodeConverterClient]\n        CCA[CodeConverterAPI]\n        BR[BetslipRepository \u65e2\u6709]\n        BC[BetslipClient \u65e2\u6709]\n        BA[BetslipAPI \u65e2\u6709]\n        TS[TooltipStorage&lt;br/&gt;UserDefaults]\n    end\n\n    UI --&gt; Domain\n    Domain --&gt; DomainModel\n    Domain --&gt; Data\n    Data --&gt; DomainModel</code></pre>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_2","title":"\u5fa9\u7528\u7b56\u7565\uff08\u6838\u5fc3\uff09","text":""},{"location":"02_Architecture/01_clean_architecture_diagram/#loadbookingcodesectionview","title":"\u6700\u5927\u5316\u5fa9\u7528 LoadBookingCodeSectionView","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    LoadCodeWidgetView\uff08\u7c21\u5316\u7248\uff09                       \u2502\n\u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502    \u2502  \u64f4\u5c55\u81ea LoadBookingCodeSectionView \u7684\u7d50\u69cb                      \u2502 \u2502\n\u2502    \u2502                                                              \u2502 \u2502\n\u2502    \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502 \u2502\n\u2502    \u2502  \u2502 BookingCodeInput                                      \u2502   \u2502 \u2502\n\u2502    \u2502  \u2502 (\u64f4\u5c55\u81ea BookingCodeInputView)                          \u2502   \u2502 \u2502\n\u2502    \u2502  \u2502                                                       \u2502   \u2502 \u2502\n\u2502    \u2502  \u2502 + Error \u72c0\u614b\uff08\u7d05\u6846\uff09                                   \u2502   \u2502 \u2502\n\u2502    \u2502  \u2502 + \u6e05\u9664\u6309\u9215 \u2297                                          \u2502   \u2502 \u2502\n\u2502    \u2502  \u2502 + Loading \u63d0\u793a\u6587\u5b57                                     \u2502   \u2502 \u2502\n\u2502    \u2502  \u2502 + Load \u6309\u9215\u72c0\u614b                                        \u2502   \u2502 \u2502\n\u2502    \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502 \u2502\n\u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2502                                                                     \u2502\n\u2502    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502    \u2502  TooltipView\uff08\u65b0\u589e SwiftUI\uff09                                  \u2502 \u2502\n\u2502    \u2502  - \u9996\u6b21\u4f7f\u7528\u6642\u986f\u793a                                             \u2502 \u2502\n\u2502    \u2502  - \u4ee5 Device ID \u5224\u65b7\u662f\u5426\u986f\u793a                                  \u2502 \u2502\n\u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\u26a0\ufe0f \u8b8a\u66f4\u8aaa\u660e\uff1aBookie Dropdown \u548c BookieSelectorSheet \u5df2\u79fb\u9664</p>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_3","title":"\u5165\u53e3\u9ede\u8207\u66ff\u63db\u8a08\u756b","text":"\u5165\u53e3\u9ede \u73fe\u6709\u5be6\u4f5c \u66ff\u63db\u70ba \u9996\u9801 Widget <code>LoadBookingCodeSectionView</code> <code>LoadCodeWidgetView</code>\uff08\u539f\u5730\u64f4\u5c55\uff09+ Tooltip Code Center Load Code Tab <code>LoadCodeViewWrapper</code> \u2192 <code>LoadCodeViewController</code> (UIKit) <code>LoadCodeWidgetView</code> (SwiftUI) + Tooltip \u9996\u9801 Betslip (Empty) \u7121 / \u65e2\u6709\u7a7a\u72c0\u614b \u5d4c\u5165 <code>LoadCodeWidgetView</code> + Tooltip"},{"location":"02_Architecture/01_clean_architecture_diagram/#_4","title":"\u4f9d\u8cf4\u65b9\u5411","text":"<p>\u56b4\u683c\u9075\u5faa\u55ae\u5411\u4f9d\u8cf4\uff1a</p> <pre><code>UI \u2192 Feature \u2192 UseCase \u2192 Repository \u2192 Client \u2192 API\n</code></pre>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_5","title":"\u5143\u4ef6\u8b8a\u66f4\u6e05\u55ae","text":""},{"location":"02_Architecture/01_clean_architecture_diagram/#_6","title":"\u64f4\u5c55\u7684\u5143\u4ef6\uff08\u6700\u5c0f\u6539\u52d5\uff09","text":"\u5143\u4ef6 \u8b8a\u66f4\u985e\u578b \u8aaa\u660e <code>LoadBookingCodeSectionView</code> \u64f4\u5c55 \u2192 <code>LoadCodeWidgetView</code>\uff0c\u589e\u52a0\u66f4\u591a\u72c0\u614b <code>BookingCodeInputView</code> \u64f4\u5c55 \u589e\u52a0 Error \u72c0\u614b\u3001\u6e05\u9664\u6309\u9215\u3001Loading \u63d0\u793a <code>LoadBookingCodeSection.Feature</code> \u64f4\u5c55 \u2192 <code>LoadCodeWidget.Feature</code>\uff0c\u589e\u52a0 Convert API + Tooltip"},{"location":"02_Architecture/01_clean_architecture_diagram/#_7","title":"\u65b0\u589e\u7684\u5143\u4ef6","text":"\u5143\u4ef6 \u985e\u578b \u8aaa\u660e <code>TooltipView</code> SwiftUI View \u4e00\u6b21\u6027\u8aaa\u660e Tooltip <code>ConvertBookingCodeUseCase</code> UseCase Code2Code \u8f49\u63db <code>CodeConverterRepository</code> Repository Code Converter \u8cc7\u6599\u5b58\u53d6 <code>CodeConverterClient</code> Client HTTP \u901a\u8a0a <code>TooltipStorage</code> Storage Tooltip \u72c0\u614b\u5132\u5b58 (UserDefaults)"},{"location":"02_Architecture/01_clean_architecture_diagram/#_8","title":"\u5ee2\u68c4\u7684\u5143\u4ef6","text":"\u5143\u4ef6 \u539f\u56e0 ~~<code>BookieDropdownView</code>~~ \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie ~~<code>BookieSelectorSheet</code>~~ \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u5668 ~~<code>LoadProviderConfigUseCase</code>~~ Config API \u5df2\u5ee2\u68c4 <code>LoadCodeViewController</code> \u88ab <code>LoadCodeWidgetView</code> (SwiftUI) \u66ff\u63db <code>LoadCodeViewController.xib</code> \u96a8 ViewController \u4e00\u8d77\u5ee2\u68c4 <code>LoadCodeViewWrapper</code> \u4e0d\u518d\u9700\u8981 UIKit \u6a4b\u63a5"},{"location":"02_Architecture/01_clean_architecture_diagram/#_9","title":"\u6a21\u7d44\u5206\u7d44","text":"<pre><code>LoadBookingCodeSection/  (\u64f4\u5c55\u81ea LoadBookingCode/)\n\u251c\u2500\u2500 View/\n\u2502   \u251c\u2500\u2500 LoadCodeWidgetView.swift          (\u64f4\u5c55\u81ea LoadBookingCodeSectionView)\n\u2502   \u251c\u2500\u2500 BookingCodeInputView.swift        (\u64f4\u5c55\uff0c\u589e\u52a0\u72c0\u614b)\n\u2502   \u251c\u2500\u2500 TooltipView.swift                 (\u65b0\u589e)\n\u2502   \u2514\u2500\u2500 PartialErrorToast.swift           (\u65b0\u589e)\n\u251c\u2500\u2500 Feature/\n\u2502   \u2514\u2500\u2500 LoadCodeWidget+Feature.swift      (\u64f4\u5c55\u81ea LoadBookingCodeSection+Feature)\n\u251c\u2500\u2500 UseCase/\n\u2502   \u2514\u2500\u2500 ConvertBookingCodeUseCase.swift   (\u65b0\u589e)\n\u251c\u2500\u2500 Domain/\n\u2502   \u251c\u2500\u2500 ConvertResult.swift               (\u65b0\u589e)\n\u2502   \u2514\u2500\u2500 WidgetInputState.swift            (\u65b0\u589e)\n\u251c\u2500\u2500 Repository/\n\u2502   \u2514\u2500\u2500 CodeConverterRepository.swift     (\u65b0\u589e)\n\u251c\u2500\u2500 Client/\n\u2502   \u2514\u2500\u2500 CodeConverterClient.swift         (\u65b0\u589e)\n\u251c\u2500\u2500 Storage/\n\u2502   \u2514\u2500\u2500 TooltipStorage.swift              (\u65b0\u589e)\n\u2514\u2500\u2500 API/\n    \u2514\u2500\u2500 CodeConverterAPI.swift            (\u65b0\u589e)\n</code></pre>"},{"location":"02_Architecture/01_clean_architecture_diagram/#_10","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>BookieSelectorSheet</code> View \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie <code>BookieDropdownView</code> View \u4e0d\u518d\u9700\u8981\u986f\u793a Dropdown <code>LoadProviderConfigUseCase</code> UseCase Config API \u5df2\u5ee2\u68c4 <code>ProviderConfig</code> Domain Model \u4e0d\u518d\u9700\u8981 Provider \u8a2d\u5b9a <code>SelectedBookie</code> Domain Model \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7"},{"location":"03_Module%20Responsibility/","title":"03_Module Responsibility","text":"<p>\u672c\u7ae0\u7bc0\u5217\u51fa\u6240\u6709\u6a21\u7d44\u53ca\u5176\u8077\u8cac\u3002</p>"},{"location":"03_Module%20Responsibility/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_module_responsibility.md \u6240\u6709\u6a21\u7d44\u7684\u8077\u8cac\u5b9a\u7fa9\u8868\u683c"},{"location":"03_Module%20Responsibility/01_module_responsibility/","title":"Module Responsibility","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e Bookie \u76f8\u95dc\u5143\u4ef6\u79fb\u9664 <code>BookieDropdownView</code>, <code>BookieSelectorSheet</code> \u5df2\u5ee2\u68c4 Config \u76f8\u95dc\u79fb\u9664 <code>LoadProviderConfigUseCase</code>, Config API \u5df2\u5ee2\u68c4 Tooltip \u65b0\u589e \u65b0\u589e <code>TooltipView</code> \u548c <code>TooltipStorage</code>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#_1","title":"\u5fa9\u7528\u7b56\u7565\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         \u5fa9\u7528\u512a\u5148\u7d1a                                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  1. \u6700\u5927\u5fa9\u7528\uff1a\u64f4\u5c55\u73fe\u6709 LoadBookingCodeSectionView \u7d50\u69cb                   \u2502\n\u2502  2. \u6700\u5c0f\u6539\u52d5\uff1a\u4fdd\u6301\u73fe\u6709 API \u76f8\u5bb9\u6027\uff0c\u65b0\u589e\u529f\u80fd\u4ee5 optional \u65b9\u5f0f\u52a0\u5165           \u2502\n\u2502  3. \u6f38\u9032\u5f0f\u66ff\u63db\uff1a\u5148\u64f4\u5c55\uff0c\u518d\u9010\u6b65\u66ff\u63db LoadCodeViewController                \u2502\n\u2502  4. \u7c21\u5316\u6d41\u7a0b\uff1a\u4e0d\u518d\u9700\u8981 Bookie/Country \u9078\u64c7                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#view-modulesui-layer","title":"View Modules\uff08UI Layer\uff09","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#view","title":"\u64f4\u5c55\u7684 View","text":"View \u540d\u7a31 \u539f\u6a94\u6848 \u8b8a\u66f4\u985e\u578b \u8aaa\u660e LoadCodeWidgetView <code>LoadBookingCodeSectionView.swift</code> \u64f4\u5c55 1. \u589e\u52a0 <code>inputState</code> \u652f\u63f4 6 \u7a2e\u72c0\u614b2. \u589e\u52a0 Error \u8a0a\u606f\u986f\u793a3. \u589e\u52a0 Loading \u63d0\u793a\u6587\u5b574. \u79fb\u9664 Bookie Dropdown BookingCodeInputView <code>BookingCodeInputView</code> (private) \u64f4\u5c55 1. \u589e\u52a0 Error \u72c0\u614b\uff08\u7d05\u8272\u908a\u6846\uff092. \u589e\u52a0\u6e05\u9664\u6309\u9215 \u22973. Load \u6309\u9215\u7da0\u8272/\u7070\u8272\u72c0\u614b"},{"location":"03_Module%20Responsibility/01_module_responsibility/#view_1","title":"\u65b0\u589e\u7684 View","text":"View \u540d\u7a31 \u6846\u67b6 \u8077\u8cac TooltipView SwiftUI 1. \u9996\u6b21\u4f7f\u7528\u6642\u986f\u793a\u8aaa\u660e2. \u9ede\u64ca\u95dc\u9589\u5f8c\u6c38\u4e45\u4e0d\u986f\u793a PartialErrorToast SwiftUI 1. \u986f\u793a\u300cX selections failed to convert\u300d\u8b66\u544a"},{"location":"03_Module%20Responsibility/01_module_responsibility/#view_2","title":"\u5ee2\u68c4\u7684 View","text":"View \u540d\u7a31 \u539f\u56e0 ~~BookieDropdownView~~ \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie ~~BookieSelectorSheet~~ \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u5668"},{"location":"03_Module%20Responsibility/01_module_responsibility/#feature-modulesdomain-layer","title":"Feature Modules\uff08Domain Layer\uff09","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#feature","title":"\u64f4\u5c55\u7684 Feature","text":"\u6a21\u7d44\u540d\u7a31 \u539f\u6a94\u6848 \u8b8a\u66f4\u985e\u578b \u4f7f\u7528\u7684 UseCase LoadCodeWidget.Feature <code>LoadBookingCodeSection+Feature.swift</code> \u64f4\u5c55 1. ConvertBookingCodeUseCase\uff08\u65b0\u589e\uff092. \u65e2\u6709\u7684 loadBookingCode \u908f\u8f2f"},{"location":"03_Module%20Responsibility/01_module_responsibility/#state-loadbookingcodesectionstate","title":"State \u8b8a\u66f4\uff08\u64f4\u5c55\u81ea LoadBookingCodeSection.State\uff09","text":"\u5c6c\u6027 \u985e\u578b \u539f\u6709/\u65b0\u589e \u9810\u8a2d\u503c \u8aaa\u660e <code>bookingCode</code> String \u2705 \u539f\u6709 <code>\"\"</code> \u8f38\u5165\u7684 Booking Code <code>selectedCountry</code> Region \u2705 \u539f\u6709 <code>.current</code> \u539f\u6d41\u7a0b\u5099\u7528 <code>isLoading</code> Bool \u2705 \u539f\u6709 <code>false</code> Loading \u72c0\u614b <code>contentState</code> SectionContentState \u2705 \u539f\u6709 <code>.loaded</code> Section \u72c0\u614b <code>availableCountries</code> [Region] \u2705 \u539f\u6709 <code>[.ghana, .nigeria]</code> \u53ef\u7528\u570b\u5bb6 <code>enableCodeConverter</code> Bool \ud83c\udd95 \u65b0\u589e <code>true</code> \u662f\u5426\u555f\u7528 Code Converter <code>inputState</code> WidgetInputState \ud83c\udd95 \u65b0\u589e <code>.default</code> 6 \u7a2e\u8f38\u5165\u72c0\u614b <code>errorMessage</code> String? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u932f\u8aa4\u8a0a\u606f <code>convertResult</code> ConvertResult? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u8f49\u63db\u7d50\u679c <code>isTooltipVisible</code> Bool \ud83c\udd95 \u65b0\u589e <code>false</code> Tooltip \u662f\u5426\u986f\u793a ~~<code>selectedBookie</code>~~ ~~SelectedBookie?~~ \u274c \u5ee2\u68c4 - ~~\u5df2\u9078 Bookie~~ ~~<code>providerConfigs</code>~~ ~~[ProviderConfig]~~ \u274c \u5ee2\u68c4 - ~~Provider \u8a2d\u5b9a~~ ~~<code>isBookieSelectorPresented</code>~~ ~~Bool~~ \u274c \u5ee2\u68c4 - ~~Sheet \u986f\u793a~~"},{"location":"03_Module%20Responsibility/01_module_responsibility/#action-loadbookingcodesectionaction","title":"Action \u8b8a\u66f4\uff08\u64f4\u5c55\u81ea LoadBookingCodeSection.Action\uff09","text":"Action \u539f\u6709/\u65b0\u589e \u8aaa\u660e <code>.onAppear</code> \u2705 \u539f\u6709 \u9801\u9762\u51fa\u73fe <code>.bookingCodeChanged(String)</code> \u2705 \u539f\u6709 \u8f38\u5165\u8b8a\u66f4 <code>.countrySelected(Region)</code> \u2705 \u539f\u6709 \u9078\u64c7\u570b\u5bb6\uff08\u539f\u6d41\u7a0b\uff09 <code>.loadBookingCode</code> \u2705 \u539f\u6709 \u9ede\u64ca Load \u6309\u9215 <code>.bookingCodeLoadFailed(String)</code> \u2705 \u539f\u6709 \u8f09\u5165\u5931\u6557\uff08\u539f\u6d41\u7a0b\uff09 <code>.bookingCodeLoaded(CodeResult)</code> \u2705 \u539f\u6709 \u8f09\u5165\u6210\u529f\uff08\u539f\u6d41\u7a0b\uff09 <code>.inputFocused</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u805a\u7126 <code>.inputBlurred</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u5931\u7126 <code>.clearButtonTapped</code> \ud83c\udd95 \u65b0\u589e \u9ede\u64ca\u6e05\u9664\u6309\u9215 <code>.tooltipDismissed</code> \ud83c\udd95 \u65b0\u589e \u95dc\u9589 Tooltip <code>.convertCodeCompleted(Result)</code> \ud83c\udd95 \u65b0\u589e \u8f49\u63db\u5b8c\u6210 <code>.presentBetslip(shareCode, failCnt)</code> \ud83c\udd95 \u65b0\u589e \u8f09\u5165 Betslip ~~<code>.bookieDropdownTapped</code>~~ \u274c \u5ee2\u68c4 ~~\u9ede\u64ca Bookie Dropdown~~ ~~<code>.bookieSelected(provider, country)</code>~~ \u274c \u5ee2\u68c4 ~~\u9078\u64c7 Bookie + Country~~ ~~<code>.bookieSelectorDismissed</code>~~ \u274c \u5ee2\u68c4 ~~\u95dc\u9589 Sheet~~ ~~<code>.providerConfigLoaded(Result)</code>~~ \u274c \u5ee2\u68c4 ~~Config \u8f09\u5165\u5b8c\u6210~~"},{"location":"03_Module%20Responsibility/01_module_responsibility/#usecase-modules","title":"UseCase Modules","text":"UseCase \u540d\u7a31 \u72c0\u614b \u8077\u8cac Input Model Output Model \u4f7f\u7528\u7684 Repository ConvertBookingCodeUseCase \ud83c\udd95 \u65b0\u589e 1. \u57f7\u884c Code2Code \u8f49\u63db2. \u6574\u5408 Liabilities \u6aa2\u67e53. \u53d6\u5f97 Betslip Data <code>ConvertBookingCodeInput</code> <code>ConvertBookingCodeOutput</code> 1. CodeConverterRepository2. BetslipRepository\uff08\u65e2\u6709\uff09 ~~LoadProviderConfigUseCase~~ \u274c \u5ee2\u68c4 ~~\u53d6\u5f97 Provider Country \u8a2d\u5b9a~~ - - -"},{"location":"03_Module%20Responsibility/01_module_responsibility/#repository-modules","title":"Repository Modules","text":"Repository \u540d\u7a31 \u72c0\u614b \u8077\u8cac \u4f7f\u7528\u7684 Client CodeConverterRepository \ud83c\udd95 \u65b0\u589e 1. \u57f7\u884c Code2Code \u8f49\u63db2. DTO \u2192 Domain Model \u8f49\u63db CodeConverterClient BetslipRepository \u2705 \u65e2\u6709\u5fa9\u7528 1. Liabilities \u6aa2\u67e52. Betslip Data \u53d6\u5f97 BetslipClient"},{"location":"03_Module%20Responsibility/01_module_responsibility/#client-modules","title":"Client Modules","text":"Client \u540d\u7a31 \u72c0\u614b \u6280\u8853 \u4f7f\u7528\u7684 API CodeConverterClient \ud83c\udd95 \u65b0\u589e HTTP CodeConverterAPI BetslipClient \u2705 \u65e2\u6709\u5fa9\u7528 HTTP BetslipAPI"},{"location":"03_Module%20Responsibility/01_module_responsibility/#storage-modules","title":"Storage Modules","text":"Storage \u540d\u7a31 \u72c0\u614b \u6280\u8853 \u8aaa\u660e TooltipStorage \ud83c\udd95 \u65b0\u589e UserDefaults Tooltip \u986f\u793a\u72c0\u614b\u5132\u5b58\uff0c\u4ee5 Device ID \u5224\u65b7"},{"location":"03_Module%20Responsibility/01_module_responsibility/#api-modules","title":"API Modules","text":"API \u540d\u7a31 \u72c0\u614b Endpoints CodeConverterAPI \ud83c\udd95 \u65b0\u589e <code>POST /orders/converter/code</code> BetslipAPI \u2705 \u65e2\u6709\u5fa9\u7528 1. <code>GET /bookingCode/{shareCode}/liabilities</code>2. <code>GET /orders/share/{shareCode}</code> ~~Config API~~ \u274c \u5ee2\u68c4 ~~<code>GET /orders/converter/config/providerCountries</code>~~"},{"location":"03_Module%20Responsibility/01_module_responsibility/#_2","title":"\u66ff\u63db\u8a08\u756b","text":""},{"location":"03_Module%20Responsibility/01_module_responsibility/#phase-1-loadbookingcodesectionview","title":"Phase 1: \u64f4\u5c55 LoadBookingCodeSectionView","text":"<pre><code>// \u4fdd\u6301\u5411\u5f8c\u76f8\u5bb9\uff0c\u65b0\u529f\u80fd\u4ee5 optional \u65b9\u5f0f\u52a0\u5165\nstruct LoadCodeWidgetView: View {\n    let store: StoreOf&lt;LoadCodeWidget.Feature&gt;\n\n    // \u65b0\u589e\uff1a\u662f\u5426\u555f\u7528 Code Converter \u529f\u80fd\n    var enableCodeConverter: Bool = true\n\n    var body: some View {\n        // \u7c21\u5316\u7d50\u69cb\uff1a\u53ea\u6709\u8f38\u5165\u6846 + Load \u6309\u9215\n        // \u4e0d\u518d\u9700\u8981 Bookie Dropdown\n    }\n}\n</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#phase-2-loadcodeviewcontroller","title":"Phase 2: \u66ff\u63db LoadCodeViewController","text":"\u5165\u53e3\u9ede \u8b8a\u66f4 Code Center <code>LoadCodeViewWrapper</code> \u2192 \u76f4\u63a5\u4f7f\u7528 <code>LoadCodeWidgetView</code> \u9996\u9801 Widget \u539f\u5730\u66ff\u63db\uff0c\u7121\u9700\u6539\u52d5\u7236\u5c64 Betslip Empty \u65b0\u589e\u5d4c\u5165 <code>LoadCodeWidgetView</code>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#phase-3","title":"Phase 3: \u79fb\u9664\u820a\u7a0b\u5f0f\u78bc","text":"<pre><code>\u522a\u9664\uff1a\n- LoadCodeViewController.swift\n- LoadCodeViewController.xib\n- LoadCodeViewWrapper.swift\n- BookieDropdownView.swift (\u5982\u5df2\u5efa\u7acb)\n- BookieSelectorSheet.swift (\u5982\u5df2\u5efa\u7acb)\n</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#_3","title":"\u6a21\u7d44\u4f9d\u8cf4\u95dc\u4fc2","text":"<pre><code>graph TD\n    LCW[LoadCodeWidgetView] --&gt; LCF[LoadCodeWidget.Feature]\n    Tooltip[TooltipView] --&gt; LCF\n    LCF --&gt; CBCU[ConvertBookingCodeUseCase]\n    LCF --&gt; LCM[LoadCodeManager \u65e2\u6709]\n    LCF --&gt; TS[TooltipStorage]\n    CBCU --&gt; CCR[CodeConverterRepository]\n    CBCU --&gt; BR[BetslipRepository \u65e2\u6709]\n    CCR --&gt; CCC[CodeConverterClient]\n    BR --&gt; BC[BetslipClient \u65e2\u6709]\n    CCC --&gt; CCA[CodeConverterAPI]\n    BC --&gt; BA[BetslipAPI \u65e2\u6709]\n    TS --&gt; UD[UserDefaults]</code></pre>"},{"location":"03_Module%20Responsibility/01_module_responsibility/#_4","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>BookieDropdownView</code> View \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie <code>BookieSelectorSheet</code> View \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u5668 <code>LoadProviderConfigUseCase</code> UseCase Config API \u5df2\u5ee2\u68c4 <code>selectedBookie</code> State \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7 <code>providerConfigs</code> State \u4e0d\u518d\u9700\u8981 Config \u8cc7\u6599 <code>isBookieSelectorPresented</code> State \u4e0d\u518d\u9700\u8981 Sheet <code>bookieDropdownTapped</code> Action \u4e0d\u518d\u9700\u8981 Dropdown <code>bookieSelected</code> Action \u4e0d\u518d\u9700\u8981\u9078\u64c7 <code>providerConfigLoaded</code> Action Config API \u5df2\u5ee2\u68c4"},{"location":"04_Domain%20Model/","title":"04_Domain Model","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter Phase 1 \u7684 Domain Models\uff0c\u5305\u542b Entity \u548c Value Object\u3002</p>"},{"location":"04_Domain%20Model/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_domain_model.md Entity \u548c Value Object \u5b9a\u7fa9 02_domain_model_uml.md Domain Model UML \u95dc\u4fc2\u5716"},{"location":"04_Domain%20Model/01_domain_model/","title":"Domain Model","text":""},{"location":"04_Domain%20Model/01_domain_model/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e ProviderConfig \u5ee2\u68c4 \u4e0d\u518d\u9700\u8981 Provider Config \u8cc7\u6599 SelectedBookie \u5ee2\u68c4 \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie CountryCode \u7c21\u5316 \u4ecd\u4fdd\u7559\u4f46\u4e0d\u518d\u7528\u65bc Bookie \u9078\u64c7"},{"location":"04_Domain%20Model/01_domain_model/#_1","title":"\u6a21\u578b\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         Domain Models                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  ConvertResult         \u8f49\u63db\u7d50\u679c\uff08\u4f86\u81ea API\uff09                      \u2502\n\u2502  WidgetInputState      Widget \u8f38\u5165\u72c0\u614b\uff086 \u7a2e\u72c0\u614b\uff09               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                     \u65e2\u6709\u5fa9\u7528\u7684 Models                            \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  Region                \u73fe\u6709\u570b\u5bb6/\u5730\u5340 enum                        \u2502\n\u2502  LoadCodeModel.CodeResult  \u73fe\u6709\u8f09\u5165\u7d50\u679c                          \u2502\n\u2502  EventDetailOutcomeElement \u73fe\u6709\u9078\u9805\u5143\u7d20                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                     \u5ee2\u68c4\u7684 Models                                \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u274c ProviderConfig      \u5df2\u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981 Provider \u8a2d\u5b9a           \u2502\n\u2502  \u274c SelectedBookie      \u5df2\u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#domain-models","title":"\u65b0\u589e\u7684 Domain Models","text":""},{"location":"04_Domain%20Model/01_domain_model/#widgetinputstate","title":"WidgetInputState","text":"<p>\u5c0d\u61c9 Figma \u8a2d\u8a08\u7684 6 \u7a2e UI \u72c0\u614b</p> <pre><code>/// Widget \u8f38\u5165\u72c0\u614b\nenum WidgetInputState: Equatable {\n    /// \u9810\u8a2d\u72c0\u614b\uff1a\u7121\u8f38\u5165\u3001\u7121\u805a\u7126\n    case `default`\n\n    /// \u805a\u7126\u72c0\u614b\uff1a\u8f38\u5165\u6846\u6709\u7da0\u8272\u908a\u6846\n    case focus\n\n    /// \u8f38\u5165\u4e2d\uff1a\u6709\u6587\u5b57\u3001\u6709\u6e05\u9664\u6309\u9215\u3001Load \u6309\u9215\u70ba\u7da0\u8272\n    case typing\n\n    /// \u5df2\u586b\u5beb\uff1a\u6709\u6587\u5b57\u3001\u7121\u805a\u7126\n    case filled\n\n    /// \u8f09\u5165\u4e2d\uff1a\u986f\u793a Spinner + \u63d0\u793a\u6587\u5b57\n    case loading\n\n    /// \u932f\u8aa4\u72c0\u614b\uff1a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f\n    case error(message: String)\n\n    // MARK: - Computed Properties\n\n    /// \u8f38\u5165\u6846\u662f\u5426\u986f\u793a\u7da0\u8272\u908a\u6846\n    var showFocusBorder: Bool {\n        switch self {\n        case .focus, .typing: return true\n        default: return false\n        }\n    }\n\n    /// \u8f38\u5165\u6846\u662f\u5426\u986f\u793a\u7d05\u8272\u908a\u6846\n    var showErrorBorder: Bool {\n        if case .error = self { return true }\n        return false\n    }\n\n    /// \u662f\u5426\u986f\u793a\u6e05\u9664\u6309\u9215\n    var showClearButton: Bool {\n        switch self {\n        case .typing, .filled, .error: return true\n        default: return false\n        }\n    }\n\n    /// Load \u6309\u9215\u662f\u5426\u555f\u7528\n    var isLoadButtonEnabled: Bool {\n        switch self {\n        case .typing, .filled: return true\n        default: return false\n        }\n    }\n\n    /// \u662f\u5426\u70ba\u932f\u8aa4\u72c0\u614b\n    var isError: Bool {\n        if case .error = self { return true }\n        return false\n    }\n\n    /// \u53d6\u5f97\u932f\u8aa4\u8a0a\u606f\n    var errorMessage: String? {\n        if case let .error(message) = self { return message }\n        return nil\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#convertresult","title":"ConvertResult","text":"<p>\u5c0d\u61c9 API: <code>POST /orders/converter/code</code></p> <pre><code>/// \u8f49\u63db\u7d50\u679c\uff08\u4f86\u81ea API\uff09\nstruct ConvertResult: Equatable {\n    let shareCode: String\n    let successCnt: Int\n    let failCnt: Int\n\n    /// \u662f\u5426\u90e8\u5206\u5931\u6557\n    var hasPartialFailure: Bool {\n        failCnt &gt; 0 &amp;&amp; successCnt &gt; 0\n    }\n\n    /// \u662f\u5426\u5168\u90e8\u5931\u6557\n    var isAllFailed: Bool {\n        successCnt == 0 &amp;&amp; failCnt &gt; 0\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#models","title":"\u65e2\u6709\u5fa9\u7528\u7684 Models","text":""},{"location":"04_Domain%20Model/01_domain_model/#region","title":"Region\uff08\u7121\u9700\u64f4\u5c55\uff09","text":"<pre><code>// \u4fdd\u6301\u73fe\u6709 Region enum \u4e0d\u8b8a\n// \u4e0d\u518d\u9700\u8981\u5f9e CountryCode \u8f49\u63db\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#dto-domain-model","title":"DTO \u2192 Domain Model \u8f49\u63db","text":""},{"location":"04_Domain%20Model/01_domain_model/#codeconverterresponsedto-convertresult","title":"CodeConverterResponseDTO \u2192 ConvertResult","text":"<pre><code>/// API Response DTO\nstruct CodeConverterResponseDTO: Decodable {\n    let bizCode: Int\n    let message: String\n    let data: CodeConverterDataDTO?\n}\n\nstruct CodeConverterDataDTO: Decodable {\n    let shareCode: String\n    let successCnt: Int\n    let failCnt: Int\n}\n\nextension ConvertResult {\n    init(from dto: CodeConverterDataDTO) {\n        self.shareCode = dto.shareCode\n        self.successCnt = dto.successCnt\n        self.failCnt = dto.failCnt\n    }\n}\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#domain-models_1","title":"\u5ee2\u68c4\u7684 Domain Models","text":""},{"location":"04_Domain%20Model/01_domain_model/#providerconfig","title":"~~ProviderConfig~~ \u274c \u5ee2\u68c4","text":"<pre><code>// \u274c \u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981\n// \u539f\u7528\u9014\uff1a\u5c0d\u61c9 API: GET /orders/converter/config/providerCountries\n// struct ProviderConfig: Equatable, Identifiable {\n//     let id: String\n//     let provider: String\n//     let name: String\n//     let countries: [CountryCode]\n// }\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#selectedbookie","title":"~~SelectedBookie~~ \u274c \u5ee2\u68c4","text":"<pre><code>// \u274c \u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981\n// \u539f\u7528\u9014\uff1a\u5132\u5b58\u5df2\u9078\u64c7\u7684 Bookie\n// struct SelectedBookie: Equatable {\n//     let provider: String\n//     let name: String\n//     let country: CountryCode\n// }\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#countrycode","title":"~~CountryCode~~ \u274c \u5ee2\u68c4","text":"<pre><code>// \u274c \u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981\n// \u539f\u7528\u9014\uff1a\u570b\u5bb6\u4ee3\u78bc Value Object\n// enum CountryCode: String, Equatable, CaseIterable {\n//     case nigeria = \"NG\"\n//     case ghana = \"GH\"\n//     // ...\n// }\n</code></pre>"},{"location":"04_Domain%20Model/01_domain_model/#_2","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>ProviderConfig</code> Domain Model Config API \u5df2\u5ee2\u68c4 <code>SelectedBookie</code> Domain Model \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie <code>CountryCode</code> Value Object \u4e0d\u518d\u9700\u8981\u570b\u5bb6\u4ee3\u78bc <code>ProviderCountryDTO</code> DTO \u5c0d\u61c9 API \u5df2\u5ee2\u68c4"},{"location":"04_Domain%20Model/02_domain_model_uml/","title":"Domain Model UML","text":""},{"location":"04_Domain%20Model/02_domain_model_uml/#_1","title":"\u985e\u5225\u5716","text":"<pre><code>classDiagram\n    class ProviderConfig {\n        +String provider\n        +String name\n        +CountryCode[] countries\n        +isSingleCountry() Bool\n        +isAllCountries() Bool\n    }\n\n    class CountryCode {\n        &lt;&lt;enumeration&gt;&gt;\n        all\n        nigeria\n        kenya\n        uganda\n        ghana\n        zambia\n        tanzania\n        +displayName() String\n    }\n\n    class ConvertResult {\n        +String shareCode\n        +Int successCnt\n        +Int failCnt\n        +isFullSuccess() Bool\n        +isPartialSuccess() Bool\n        +isFullFailure() Bool\n    }\n\n    class WidgetInputState {\n        &lt;&lt;enumeration&gt;&gt;\n        default\n        focus\n        typing\n        filled\n        loading\n        error\n        +isLoadButtonEnabled() Bool\n    }\n\n    class SelectedBookie {\n        +String provider\n        +String name\n        +CountryCode country\n        +displayText() String\n    }\n\n    ProviderConfig \"1\" *-- \"1..*\" CountryCode : contains\n    SelectedBookie \"1\" -- \"1\" CountryCode : uses</code></pre>"},{"location":"04_Domain%20Model/02_domain_model_uml/#_2","title":"\u95dc\u4fc2\u8aaa\u660e","text":"\u95dc\u4fc2 \u8a9e\u610f\u5316\u95dc\u4fc2 \u6a19\u6e96 UML \u8aaa\u660e \u5be6\u4f5c\u65b9\u5f0f \u65b9\u5411 ProviderConfig \u2192 CountryCode contains Composition (*--) ProviderConfig \u5305\u542b\u591a\u500b CountryCode Array property ProviderConfig \u2192 CountryCode SelectedBookie \u2192 CountryCode uses Association (--) SelectedBookie \u4f7f\u7528\u4e00\u500b CountryCode Property SelectedBookie \u2192 CountryCode"},{"location":"04_Domain%20Model/02_domain_model_uml/#_3","title":"\u72c0\u614b\u5716","text":""},{"location":"04_Domain%20Model/02_domain_model_uml/#widgetinputstate","title":"WidgetInputState \u72c0\u614b\u8f49\u63db","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; Default\n    Default --&gt; Focus : \u9ede\u64ca\u8f38\u5165\u6846\n    Focus --&gt; Typing : \u958b\u59cb\u8f38\u5165\n    Focus --&gt; Default : \u5931\u53bb\u7126\u9ede\u4e14\u7121\u8f38\u5165\n    Typing --&gt; Filled : \u8f38\u5165\u5b8c\u6210\n    Typing --&gt; Focus : \u6e05\u7a7a\u8f38\u5165\n    Filled --&gt; Loading : \u9ede\u64ca Load\n    Filled --&gt; Typing : \u7e7c\u7e8c\u7de8\u8f2f\n    Loading --&gt; Error : API \u5931\u6557\n    Loading --&gt; [*] : API \u6210\u529f \u8f09\u5165 Betslip\n    Error --&gt; Typing : \u4fee\u6539\u8f38\u5165\n    Error --&gt; Loading : \u91cd\u65b0 Load</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/","title":"LoadBookingCodeSection - \u7248\u672c\u8b8a\u66f4\u7d00\u9304","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_14-2025-01-14-be","title":"\ud83d\udcc5 01_14 (2025-01-14) - BE \u65b0\u8a2d\u8a08\u66f4\u65b0 \u26a0\ufe0f","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#be","title":"\ud83d\udd04 BE \u65b0\u8a2d\u8a08\u8b8a\u66f4\u6458\u8981","text":"\u8b8a\u66f4\u9805\u76ee \u820a\u7248 \u65b0\u7248 Provider/Country \u9078\u64c7 \u9700\u5148\u9078\u64c7 Bookie \u274c \u5ee2\u68c4 - \u4e0d\u9700\u9078\u64c7 Config API <code>GET /orders/converter/config/providerCountries</code> \u274c \u5ee2\u68c4 Convert API Request <code>{provider, country, bookingCode}</code> <code>{bookingCode}</code> \u53ea\u9700 bookingCode Bookie Selector Sheet \u9700\u5be6\u4f5c \u274c \u5ee2\u68c4 - \u4e0d\u9700\u5be6\u4f5c \u6d41\u7a0b \u9078 Bookie \u2192 \u8f38\u5165 Code \u2192 \u8f49\u63db \u8f38\u5165 Code \u2192 \u8f49\u63db \u2192 \u8d70\u539f\u6709 load code \u6d41\u7a0b"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_1","title":"\u274c \u65b0\u5ee2\u68c4\u9805\u76ee","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>GET /orders/converter/config/providerCountries</code> API BE \u4e0d\u518d\u9700\u8981 <code>LoadProviderConfigUseCase</code> UseCase \u5c0d\u61c9 API \u5ee2\u68c4 <code>ProviderConfig</code> Domain Model \u5c0d\u61c9 API \u5ee2\u68c4 <code>SelectedBookie</code> Domain Model \u4e0d\u518d\u9700\u8981\u9078\u64c7 <code>CountryCode</code> Value Object \u4e0d\u518d\u9700\u8981 <code>selectedBookie</code> State State \u4e0d\u518d\u9700\u8981 <code>providerConfigs</code> State State \u4e0d\u518d\u9700\u8981 <code>isBookieSelectorPresented</code> State State \u4e0d\u518d\u9700\u8981 <code>bookieDropdownTapped</code> Action Action \u4e0d\u518d\u9700\u8981 <code>bookieSelected</code> Action Action \u4e0d\u518d\u9700\u8981 <code>bookieSelectorDismissed</code> Action Action \u4e0d\u518d\u9700\u8981 <code>provider</code> \u53c3\u6578 API Request BE \u81ea\u52d5\u8b58\u5225 <code>country</code> \u53c3\u6578 API Request BE \u81ea\u52d5\u8b58\u5225"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_2","title":"\u2705 \u4fdd\u7559\u7684\u529f\u80fd","text":"\u529f\u80fd \u8aaa\u660e 6 \u7a2e\u8f38\u5165\u72c0\u614b Default, Focus, Typing, Filled, Loading, Error BookingCodeInputView \u6838\u5fc3\u8f38\u5165\u5143\u4ef6 ConvertBookingCodeUseCase Code2Code \u8f49\u63db\uff08\u7c21\u5316\u7248\uff09 Betslip \u5c0e\u822a \u542b Partial Error Toast Tooltip \u9996\u6b21\u4f7f\u7528\u5f15\u5c0e (Device ID \u5132\u5b58)"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_3","title":"\ud83c\udd95 \u65b0\u589e\u9805\u76ee","text":"\u9805\u76ee \u8aaa\u660e <code>04_tooltip_display_logic.md</code> Tooltip \u986f\u793a\u908f\u8f2f\u5e8f\u5217\u5716 <code>isTooltipVisible</code> State Tooltip \u986f\u793a\u72c0\u614b <code>tooltipDismissed</code> Action \u95dc\u9589 Tooltip <code>TooltipStorage</code> Tooltip \u5132\u5b58\u908f\u8f2f (UserDefaults + Device ID)"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_4","title":"\ud83d\udcd0 \u7c21\u5316\u5f8c\u7684\u6d41\u7a0b","text":"<pre><code>\u820a\u6d41\u7a0b\uff08\u5df2\u5ee2\u68c4\uff09:\nUser \u2192 \u9078\u64c7 Bookie \u2192 \u8f38\u5165 Code \u2192 \u8f49\u63db\n\n\u65b0\u6d41\u7a0b:\nUser \u2192 (Tooltip \u9996\u6b21\u986f\u793a) \u2192 \u8f38\u5165 Code \u2192 POST /orders/converter/code \u2192 \u8d70\u539f\u6709 Load Code \u6d41\u7a0b\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_12-2025-01-12","title":"\ud83d\udcc5 01_12 (2025-01-12)","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#1info-icon-guidedialog","title":"\ud83c\udd95 \u65b0\u589e\u529f\u80fd 1\uff1aInfo Icon \u2192 GuideDialog","text":"\u9805\u76ee \u8aaa\u660e \u529f\u80fd \u9ede\u64ca Info Icon (\u24d8) \u5f48\u51fa\u8aaa\u660e Dialog \u6a19\u984c \"Import Booking Code\" \u5167\u5bb9 Bullet list \u8aaa\u660e\u652f\u63f4\u7684\u529f\u80fd \u6309\u9215 \"Ok\" Figma node-id <code>27536:84826</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#guidedialog","title":"\u5fa9\u7528\u73fe\u6709\u5143\u4ef6\uff1aGuideDialog","text":"<pre><code>FComUI/Sources/FComUI/GuideDialog/\n\u251c\u2500\u2500 View/\n\u2502   \u2514\u2500\u2500 GuideDialogView.swift\n\u251c\u2500\u2500 Model/\n\u2502   \u251c\u2500\u2500 GuideDialogViewState.swift  \u2190 ViewState, Page, Theme\n\u2502   \u2514\u2500\u2500 GuideDialogViewAction.swift\n\u2514\u2500\u2500 FComUIFactory+GuideDialog.swift \u2190 Factory method\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#2one-time-tooltip","title":"\ud83c\udd95 \u65b0\u589e\u529f\u80fd 2\uff1aOne-Time Tooltip","text":"\u9805\u76ee \u8aaa\u660e \u529f\u80fd Feature \u4e0a\u7dda\u5f8c\u986f\u793a\u4e00\u6b21\u6027\u63d0\u793a \u6587\u5b57 \"Supports booking codes from many platforms\" \u884c\u70ba \u9ede\u64ca\u5f8c\u6d88\u5931\uff0c\u6309 device ID \u5b58\u5132\u5230 local storage Figma node-id <code>27526:71304</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#tooltip","title":"\u5fa9\u7528\u73fe\u6709\u5143\u4ef6\uff1aTooltip","text":"<pre><code>FComUI/Sources/FComUI/Tooltip/\n\u251c\u2500\u2500 TooltipView.swift           \u2190 \u6838\u5fc3 View\n\u251c\u2500\u2500 Tooltip+Model.swift\n\u251c\u2500\u2500 ViewModels/\n\u2502   \u251c\u2500\u2500 TooltipViewState.swift  \u2190 Placement, Config\n\u2502   \u2514\u2500\u2500 TooltipViewAction.swift\n\u2514\u2500\u2500 Extensions/\n    \u2514\u2500\u2500 View+TooltipView.swift  \u2190 .showTooltip() modifier\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_5","title":"\u4f7f\u7528\u65b9\u5f0f","text":"<pre><code>// Tooltip: \u5916\u5c64\u52a0\u4e0a .tooltipOverlay()\uff0cWidget \u4e0a\u52a0\u4e0a .showTooltip(config:)\n// GuideDialog: \u7528 .fullScreenCover \u5305\u88dd FComUIFactory.createGuideDialogView()\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_09-2025-01-09-","title":"\ud83d\udcc5 01_09 (2025-01-09) - \u7576\u524d\u7248\u672c","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_6","title":"\ud83d\udd04 \u9700\u6c42\u8b8a\u66f4\u6458\u8981","text":"\u8b8a\u66f4\u985e\u578b \u8aaa\u660e \u7c21\u5316\u6d41\u7a0b \u79fb\u9664 Bookie/Country \u9078\u64c7\u5668\uff0c\u4f7f\u7528\u8005\u76f4\u63a5\u8f38\u5165 Booking Code UI \u8b8a\u66f4 \u6309\u9215\u6587\u5b57 \"Load\" \u2192 \"Import\"\uff0cPlaceholder \u8b8a\u66f4 \u65b0\u589e\u5143\u4ef6 Info Tip Icon (\u24d8) \u79fb\u9664\u5143\u4ef6 BookieDropdownView, BookieSelectorSheet"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_7","title":"\u274c \u5df2\u79fb\u9664\u7684\u529f\u80fd","text":"\u529f\u80fd \u539f TDD \u6587\u4ef6 \u72c0\u614b Bookie Selector Sheet <code>01_view_implementation.md</code> \u274c \u4e0d\u9700\u5be6\u4f5c BookieDropdownView <code>01_view_implementation.md</code> \u274c \u4e0d\u9700\u5be6\u4f5c CountryDropdownView \u64f4\u5c55 <code>01_view_implementation.md</code> \u274c \u4e0d\u9700\u5be6\u4f5c LoadProviderConfigUseCase <code>07_UseCase</code> \u274c \u4e0d\u9700\u5be6\u4f5c 1.0.3 Bookie Selection \u756b\u9762 <code>03_state_to_figma_mapping.md</code> \u274c \u5df2\u79fb\u9664 1.0.4 Type Done \u756b\u9762 <code>03_state_to_figma_mapping.md</code> \u274c \u5df2\u79fb\u9664"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_8","title":"\u2705 \u4fdd\u7559\u7684\u529f\u80fd","text":"\u529f\u80fd \u8aaa\u660e 6 \u7a2e\u8f38\u5165\u72c0\u614b Default, Focus, Typing, Filled, Loading, Error LoadBookingCodeSectionView \u64f4\u5c55 \u6838\u5fc3 View \u7d50\u69cb\u4e0d\u8b8a BookingCodeInputView \u64f4\u5c55 \u589e\u52a0\u72c0\u614b\u3001\u6e05\u9664\u6309\u9215 ConvertBookingCodeUseCase Code2Code \u8f49\u63db Betslip \u5c0e\u822a \u542b Partial Error Toast"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_9","title":"\ud83c\udd95 \u65b0\u589e\u5167\u5bb9","text":"\u9805\u76ee \u6a94\u6848 UI \u66ff\u63db\u7b56\u7565 (01_09) <code>05_ui_replacement_strategy_01_09.md</code> Info Tip Icon 16px\uff0c\u9ede\u64ca\u986f\u793a\u63d0\u793a \u7c21\u5316\u7684 State/Action \u79fb\u9664 Bookie \u76f8\u95dc\u5c6c\u6027"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_10","title":"\ud83d\udcd0 \u5143\u4ef6\u7d50\u69cb\u5c0d\u6bd4","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_01","title":"\u820a\u7248 (01_01)","text":"<pre><code>LoadBookingCodeSectionView\n\u251c\u2500\u2500 HStack\n\u2502   \u251c\u2500\u2500 BookieDropdownView \u2190 \u274c \u79fb\u9664\n\u2502   \u2514\u2500\u2500 BookingCodeInputView\n\u2514\u2500\u2500 BookieSelectorSheet \u2190 \u274c \u79fb\u9664\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_09","title":"\u65b0\u7248 (01_09)","text":"<pre><code>LoadBookingCodeSectionView\n\u251c\u2500\u2500 VStack\n\u2502   \u251c\u2500\u2500 HStack (Input Row)\n\u2502   \u2502   \u251c\u2500\u2500 Input Container\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TextField\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 Clear Button\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 Import Button\n\u2502   \u2502   \u2514\u2500\u2500 Info Tip Icon \u2190 \ud83c\udd95 \u65b0\u589e\n\u2502   \u2514\u2500\u2500 Helper Text (Loading/Error)\n\u2514\u2500\u2500 (\u7121 Sheet)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_01-2025-01-01-","title":"\ud83d\udcc5 01_01 (2025-01-01) - \u820a\u7248","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_11","title":"\u529f\u80fd\u63cf\u8ff0","text":"<ul> <li>\u5b8c\u6574 Bookie + Country \u9078\u64c7\u5668</li> <li>Bottom Sheet \u96d9\u6b04\u9078\u64c7\u5668</li> <li>LoadProviderConfigUseCase \u53d6\u5f97 Provider Config</li> <li>\u7528\u6236\u9700\u9078\u64c7 Bookie \u5f8c\u624d\u80fd Load</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_12","title":"\u76f8\u95dc\u6a94\u6848","text":"\u6a94\u6848 \u8aaa\u660e <code>01_view_implementation.md</code> \u5305\u542b BookieDropdownView, BookieSelectorSheet <code>02_view_design_specs.md</code> \u820a\u7248 Design Tokens <code>03_state_to_figma_mapping.md</code> \u5305\u542b 1.0.3, 1.0.4 \u756b\u9762 <code>04_figma_to_design_system_mapping.md</code> Figma \u2192 Code \u5c0d\u7167"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_13","title":"\ud83d\udcda \u5982\u4f55\u4f7f\u7528","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#01_10","title":"\u5982\u679c\u4f60\u5728\u5be6\u4f5c 01_09 \u7248\u672c","text":"<ol> <li>\u512a\u5148\u53c3\u8003\uff1a<code>05_ui_replacement_strategy_01_09.md</code></li> <li>\u5ffd\u7565\uff1a</li> <li><code>01_view_implementation.md</code> \u4e2d\u7684 BookieDropdownView, BookieSelectorSheet</li> <li><code>03_state_to_figma_mapping.md</code> \u4e2d\u7684 1.0.3, 1.0.4, Bookie Selector \u90e8\u5206</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_14","title":"\u5982\u679c\u4f60\u9700\u8981\u56de\u9867\u820a\u7248\u8a2d\u8a08","text":"<ol> <li>\u53c3\u8003 <code>Docs/02_Design/01_01/</code> \u8cc7\u6599\u593e</li> <li>\u4f7f\u7528 <code>01_view_implementation.md</code> \u5b8c\u6574\u5167\u5bb9</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/00_version_changelog/#_15","title":"\ud83d\udd17 \u5feb\u901f\u5c0e\u822a","text":"\u6587\u4ef6 \u7248\u672c \u7528\u9014 05_ui_replacement_strategy_01_09.md 01_09 \u2b50 UI \u66ff\u63db\u7b56\u7565 01_view_implementation.md 01_01 View \u5be6\u4f5c (\u90e8\u5206\u5df2\u904e\u6642) 03_state_to_figma_mapping.md \u5df2\u66f4\u65b0 State \u2194 Figma \u5c0d\u7167 02_view_design_specs.md 01_01 Design Specs (\u90e8\u5206\u5df2\u904e\u6642)"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/","title":"View Implementation: \u5fa9\u7528\u7b56\u7565\u8a73\u89e3","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e BookieDropdownView \u79fb\u9664 \u4e0d\u518d\u9700\u8981 Bookie Dropdown BookieSelectorSheet \u79fb\u9664 \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u5668 TooltipView \u65b0\u589e \u9996\u6b21\u4f7f\u7528\u6642\u986f\u793a\u5f15\u5c0e Tooltip Widget \u7d50\u69cb\u7c21\u5316 \u53ea\u5305\u542b\u8f38\u5165\u6846 + Load \u6309\u9215"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#_1","title":"\u5fa9\u7528\u7b56\u7565\u7e3d\u89bd","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                   LoadCodeWidgetView \u5fa9\u7528\u7b56\u7565\uff08\u7c21\u5316\u7248\uff09                 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u6838\u5fc3\u539f\u5247\uff1a\u6700\u5927\u5316\u5fa9\u7528 LoadBookingCodeSectionView \u7684\u7d50\u69cb               \u2502\n\u2502                                                                        \u2502\n\u2502  1. \u4fdd\u6301\u539f\u6709 API \u76f8\u5bb9\u6027\uff08\u4e0d\u7834\u58de\u73fe\u6709\u547c\u53eb\u65b9\uff09                           \u2502\n\u2502  2. \u65b0\u529f\u80fd\u4ee5 optional flag \u65b9\u5f0f\u52a0\u5165                                   \u2502\n\u2502  3. \u7c21\u5316\u7d50\u69cb\uff1a\u79fb\u9664 Bookie Dropdown                                    \u2502\n\u2502  4. \u65b0\u589e Tooltip \u5143\u4ef6                                                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#vs","title":"\u73fe\u6709 vs \u65b0\u589e\u5c0d\u7167","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#loadbookingcodesectionview-loadcodewidgetview","title":"LoadBookingCodeSectionView \u2192 LoadCodeWidgetView","text":"<pre><code>// \u73fe\u6709\nstruct LoadBookingCodeSectionView: View {\n    let store: StoreOf&lt;LoadBookingCodeSection.Feature&gt;\n    @FocusState private var isTextFieldFocused: Bool\n\n    var body: some View {\n        VStack(spacing: 0) {\n            HStack(spacing: 8) {\n                CountryDropdownView(...)      // \u2190 \u79fb\u9664\n                BookingCodeInputView(...)     // \u2190 \u5fa9\u7528\uff0c\u589e\u52a0\u72c0\u614b\n            }\n        }\n    }\n}\n\n// \u65b0\u589e\uff08\u7c21\u5316\u7248\uff09\nstruct LoadCodeWidgetView: View {\n    let store: StoreOf&lt;LoadCodeWidget.Feature&gt;\n    @FocusState private var isTextFieldFocused: Bool\n\n    var body: some View {\n        WithPerceptionTracking {\n            ZStack(alignment: .top) {\n                VStack(spacing: 0) {\n                    // \u4e3b\u8981\u8f38\u5165\u5340\uff08\u7c21\u5316\uff1a\u53ea\u6709\u8f38\u5165\u6846\uff09\n                    BookingCodeInputView(...)   // \u2190 \u64f4\u5c55\uff0c\u589e\u52a0\u72c0\u614b\n\n                    // Loading \u63d0\u793a\u6587\u5b57\n                    if let hintText = store.loadingHintText {\n                        LoadingHintView(text: hintText)\n                    }\n\n                    // \u932f\u8aa4\u8a0a\u606f\n                    if let errorMessage = store.errorMessage {\n                        ErrorMessageView(message: errorMessage)\n                    }\n                }\n\n                // Tooltip\uff08\u9996\u6b21\u4f7f\u7528\u6642\u986f\u793a\uff09\n                if store.isTooltipVisible {\n                    TooltipView(onDismiss: {\n                        store.send(.tooltipDismissed)\n                    })\n                    .offset(y: -50)\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#_2","title":"\u5b50\u5143\u4ef6\u8b8a\u66f4\u8a73\u89e3","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#1-countrydropdownview-bookiedropdownview","title":"~~1. CountryDropdownView \u2192 BookieDropdownView~~ \u274c \u5df2\u5ee2\u68c4","text":"<p>\u4e0d\u518d\u9700\u8981\uff1aBE \u65b0\u8a2d\u8a08\u4e0d\u9700\u8981\u9078\u64c7 Provider/Country</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#1-bookingcodeinputview","title":"1. BookingCodeInputView \u64f4\u5c55","text":"\u529f\u80fd \u539f\u6709 \u65b0\u589e Focus \u7da0\u8272\u908a\u6846 \u2705 \u2705 Loading Spinner \u2705 \u2705 Error \u7d05\u8272\u908a\u6846 \u274c \u2705 \u6e05\u9664\u6309\u9215 \u2297 \u274c \u2705 Load \u6309\u9215\u984f\u8272 \u56fa\u5b9a \u52d5\u614b\uff08\u7da0/\u7070\uff09 <pre><code>// \u64f4\u5c55\u5f8c\nprivate struct BookingCodeInputView: View {\n    let bookingCode: String\n    let inputState: WidgetInputState\n    var isTextFieldFocused: FocusState&lt;Bool&gt;.Binding\n    let onTextChange: (String) -&gt; Void\n    let onSubmit: () -&gt; Void\n    let onClear: () -&gt; Void\n    let onFocus: () -&gt; Void\n    let onBlur: () -&gt; Void\n\n    var body: some View {\n        ZStack {\n            // \u80cc\u666f\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color.backgroundType1Secondary)\n\n            HStack(spacing: 8) {\n                // \u8f38\u5165\u6846\n                TextField(\"Booking Code\", text: .init(\n                    get: { bookingCode },\n                    set: { onTextChange($0) }\n                ))\n                .font(.system(size: 14))\n                .textFieldStyle(PlainTextFieldStyle())\n                .focused(isTextFieldFocused)\n                .tint(.brandSecondary)\n                .onSubmit {\n                    onSubmit()\n                    isTextFieldFocused.wrappedValue = false\n                }\n                .onChange(of: isTextFieldFocused.wrappedValue) { newValue in\n                    if newValue {\n                        onFocus()\n                    } else {\n                        onBlur()\n                    }\n                }\n                .submitLabel(.done)\n                .textInputAutocapitalization(.never)\n                .autocorrectionDisabled()\n                .padding(.leading, 16)\n\n                Spacer(minLength: 0)\n\n                // \u6e05\u9664\u6309\u9215\n                if inputState.showClearButton {\n                    Button(action: onClear) {\n                        Image(systemName: \"xmark.circle.fill\")\n                            .foregroundColor(.gray)\n                    }\n                }\n\n                // Load \u6309\u9215 / Spinner\n                if inputState == .loading {\n                    ProgressView()\n                        .scaleEffect(0.8)\n                        .padding(.trailing, 8)\n                } else {\n                    Button(action: onSubmit) {\n                        Text(\"Load\")\n                            .font(.system(size: 14, weight: .semibold))\n                            .foregroundColor(inputState.isLoadButtonEnabled ? .black : .gray)\n                            .padding(.horizontal, 16)\n                            .padding(.vertical, 8)\n                            .background(\n                                RoundedRectangle(cornerRadius: 6)\n                                    .fill(inputState.isLoadButtonEnabled ? Color.brandSecondary : Color.gray.opacity(0.3))\n                            )\n                    }\n                    .disabled(!inputState.isLoadButtonEnabled)\n                    .padding(.trailing, 8)\n                }\n            }\n        }\n        // \u908a\u6846\u984f\u8272\uff08\u6839\u64da\u72c0\u614b\uff09\n        .overlay(\n            RoundedRectangle(cornerRadius: 10)\n                .stroke(borderColor, lineWidth: inputState.showErrorBorder ? 1 : 2)\n        )\n    }\n\n    private var borderColor: Color {\n        if inputState.showErrorBorder {\n            return .warningPrimary\n        } else if inputState.showFocusBorder {\n            return .brandSecondary\n        }\n        return .clear\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#2","title":"2. \u65b0\u589e\u5143\u4ef6","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#tooltipview","title":"TooltipView","text":"<pre><code>private struct TooltipView: View {\n    let onDismiss: () -&gt; Void\n\n    var body: some View {\n        HStack(spacing: 8) {\n            Image(systemName: \"lightbulb.fill\")\n                .foregroundColor(.yellow)\n                .font(.system(size: 14))\n\n            Text(\"Insert a booking code from any provider\")\n                .font(.system(size: 12))\n                .foregroundColor(.white)\n\n            Spacer()\n\n            Button(action: onDismiss) {\n                Image(systemName: \"xmark\")\n                    .foregroundColor(.white.opacity(0.7))\n                    .font(.system(size: 12))\n            }\n        }\n        .padding(.horizontal, 12)\n        .padding(.vertical, 10)\n        .background(\n            RoundedRectangle(cornerRadius: 8)\n                .fill(Color.black.opacity(0.85))\n        )\n        .shadow(color: .black.opacity(0.2), radius: 8, x: 0, y: 4)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#loadinghintview","title":"LoadingHintView","text":"<pre><code>private struct LoadingHintView: View {\n    let text: String\n\n    var body: some View {\n        Text(text)\n            .font(.system(size: 12))\n            .foregroundColor(.textType1Primary)\n            .multilineTextAlignment(.leading)\n            .padding(.top, 8)\n            .padding(.horizontal, 8)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#errormessageview","title":"ErrorMessageView","text":"<pre><code>private struct ErrorMessageView: View {\n    let message: String\n\n    var body: some View {\n        Text(message)\n            .font(.system(size: 12))\n            .foregroundColor(.warningPrimary)\n            .multilineTextAlignment(.leading)\n            .padding(.top, 8)\n            .padding(.horizontal, 8)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#view","title":"\u5b8c\u6574 View \u7d50\u69cb\uff08\u7c21\u5316\u7248\uff09","text":"<pre><code>struct LoadCodeWidgetView: View {\n    @Perception.Bindable var store: StoreOf&lt;LoadCodeWidget.Feature&gt;\n    @FocusState private var isTextFieldFocused: Bool\n\n    var body: some View {\n        WithPerceptionTracking {\n            ZStack(alignment: .top) {\n                // \u4e3b\u8981 Widget\n                VStack(spacing: 0) {\n                    // \u80cc\u666f\u5bb9\u5668\n                    HStack(spacing: 8) {\n                        BookingCodeInputView(\n                            bookingCode: store.bookingCode,\n                            inputState: store.inputState,\n                            isTextFieldFocused: $isTextFieldFocused,\n                            onTextChange: { store.send(.bookingCodeChanged($0)) },\n                            onSubmit: { store.send(.loadBookingCode) },\n                            onClear: { store.send(.clearButtonTapped) },\n                            onFocus: { store.send(.inputFocused) },\n                            onBlur: { store.send(.inputBlurred) }\n                        )\n                    }\n                    .padding(8)\n                    .background(\n                        RoundedRectangle(cornerRadius: 10)\n                            .fill(Color.backgroundType1Tertiary)\n                    )\n\n                    // Loading \u63d0\u793a\n                    if let hintText = store.loadingHintText {\n                        LoadingHintView(text: hintText)\n                    }\n\n                    // \u932f\u8aa4\u8a0a\u606f\n                    if let errorMessage = store.errorMessage {\n                        ErrorMessageView(message: errorMessage)\n                    }\n                }\n\n                // Tooltip\n                if store.isTooltipVisible {\n                    TooltipView(onDismiss: {\n                        store.send(.tooltipDismissed)\n                    })\n                    .padding(.horizontal, 8)\n                    .offset(y: -60)\n                    .transition(.opacity.combined(with: .move(edge: .top)))\n                }\n            }\n            .animation(.easeInOut(duration: 0.2), value: store.isTooltipVisible)\n            .onAppear {\n                store.send(.onAppear)\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#_3","title":"\u5ee2\u68c4\u7684\u5143\u4ef6","text":"\u5143\u4ef6 \u539f\u56e0 ~~<code>BookieDropdownView</code>~~ \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie ~~<code>BookieSelectorSheet</code>~~ \u4e0d\u518d\u9700\u8981 Bookie \u9078\u64c7\u5668 ~~<code>CountryDropdownView</code> \u64f4\u5c55~~ \u4e0d\u518d\u9700\u8981 Country \u9078\u64c7"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/01_view_implementation/#preview","title":"Preview","text":"<pre><code>#Preview(\"Default\") {\n    LoadCodeWidgetView(\n        store: Store(initialState: LoadCodeWidget.State()) {\n            LoadCodeWidget.Feature()\n        }\n    )\n    .padding()\n    .background(Color.backgroundType1Primary)\n}\n\n#Preview(\"With Tooltip\") {\n    LoadCodeWidgetView(\n        store: Store(initialState: LoadCodeWidget.State(isTooltipVisible: true)) {\n            LoadCodeWidget.Feature()\n        }\n    )\n    .padding()\n    .background(Color.backgroundType1Primary)\n}\n\n#Preview(\"Loading\") {\n    LoadCodeWidgetView(\n        store: Store(initialState: LoadCodeWidget.State(\n            bookingCode: \"3RA3FA\",\n            inputState: .loading\n        )) {\n            LoadCodeWidget.Feature()\n        }\n    )\n    .padding()\n    .background(Color.backgroundType1Primary)\n}\n\n#Preview(\"Error\") {\n    LoadCodeWidgetView(\n        store: Store(initialState: LoadCodeWidget.State(\n            bookingCode: \"INVALID\",\n            inputState: .error(message: \"We couldn't find this booking code. Please check and try again.\"),\n            errorMessage: \"We couldn't find this booking code. Please check and try again.\"\n        )) {\n            LoadCodeWidget.Feature()\n        }\n    )\n    .padding()\n    .background(Color.backgroundType1Primary)\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/","title":"View Design Specs\uff08Figma \u8a2d\u8a08\u898f\u683c\uff09","text":"<p>\u4f86\u6e90\uff1aFigma File Key <code>SvcTlADMZ7gUPIa7nN2hT1</code> \u53c3\u8003\uff1a<code>Phase1_Design_Specs.md</code>, <code>Figma_Nodes_Phase1.md</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_1","title":"\ud83d\udccb \u76ee\u9304","text":"<ol> <li>Design Tokens</li> <li>Load Code Widget</li> <li>Bookie Selector Bottom Sheet</li> <li>Toast Message (Partial Error)</li> <li>Icons</li> <li>\u97ff\u61c9\u5f0f\u898f\u5247</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#design-tokens","title":"\ud83c\udfa8 Design Tokens","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#colors","title":"\u984f\u8272 (Colors)","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#brand","title":"\u54c1\u724c\u8272 (Brand)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c SwiftUI \u7528\u9014 <code>brand/brand_secondary</code> <code>#9ff611</code> <code>.brandSecondary</code> CTA \u6309\u9215\u3001\u9078\u4e2d\u72c0\u614b\u3001Focus \u908a\u6846 <code>brand/brand_secondary_disable</code> <code>#343247</code> - \u7981\u7528\u72c0\u614b\u6309\u9215\u80cc\u666f <code>brand/brand_tertiary</code> <code>#100e26</code> - \u6df1\u8272\u80cc\u666f\u3001Bottom Sheet \u80cc\u666f"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#background","title":"\u80cc\u666f\u8272 (Background)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c SwiftUI \u7528\u9014 <code>background_type1_primary</code> <code>#1c1a31</code> <code>.backgroundType1Primary</code> \u4e3b\u80cc\u666f <code>background_type1_secondary</code> <code>#100e26</code> <code>.backgroundType1Secondary</code> \u8f38\u5165\u6846\u80cc\u666f\u3001Dropdown \u80cc\u666f <code>background_type1_tertiary</code> <code>#28263c</code> <code>.backgroundType1Tertiary</code> Widget \u5916\u6846\u80cc\u666f"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#text","title":"\u6587\u5b57\u8272 (Text)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c \u7528\u9014 <code>text_type1_primary</code> <code>#e7e7e9</code> \u4e3b\u8981\u6587\u5b57\uff08\u8f38\u5165\u7684 Booking Code\uff09 <code>text_type1_secondary</code> <code>#878693</code> \u6b21\u8981\u6587\u5b57\uff08Placeholder\u3001\u6a19\u7c64\uff09 <code>text_type1_tertiary</code> <code>#ffffff</code> \u767d\u8272\u6587\u5b57\uff08Bookie \u9078\u9805\uff09 <code>text_disable_type1_primary</code> <code>#9c9bab</code> \u7981\u7528\u72c0\u614b\u6587\u5b57"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#warning","title":"\u8b66\u544a/\u932f\u8aa4 (Warning)","text":"\u8b8a\u6578\u540d\u7a31 Hex \u503c \u7528\u9014 <code>warning_primary</code> <code>#fb4d3d</code> \u932f\u8aa4\u908a\u6846\u3001\u932f\u8aa4\u6587\u5b57\u3001Toast \u80cc\u666f"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#typography","title":"\u5b57\u578b (Typography)","text":"\u6a23\u5f0f\u540d\u7a31 Font Weight Size Line Height \u7528\u9014 <code>Body/B1_M</code> Roboto Medium (500) 14px 20px \u4e2d\u578b\u6309\u9215\u3001\u6a19\u7c64 <code>Body/B1_B</code> Roboto Bold (700) 14px auto Bookie \u9078\u9805\u6587\u5b57 <code>Body/B2_M</code> Roboto Medium (500) 12px 16px Load \u6309\u9215 <code>Body/B2_R</code> Roboto Regular (400) 12px auto \u932f\u8aa4\u8a0a\u606f\u3001\u63d0\u793a\u6587\u5b57 <p>SwiftUI \u5c0d\u7167\uff1a</p> <pre><code>// Body/B1_M (14px Medium)\n.font(.system(size: 14, weight: .medium))\n\n// Body/B2_M (12px Medium) - Load \u6309\u9215\n.font(.system(size: 12, weight: .medium))\n\n// Body/B2_R (12px Regular) - \u932f\u8aa4\u8a0a\u606f\n.font(.system(size: 12, weight: .regular))\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#border-radius","title":"\u5713\u89d2 (Border Radius)","text":"\u5143\u4ef6 \u503c SwiftUI Widget \u5916\u6846 <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code> \u8f38\u5165\u6846 <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code> Load \u6309\u9215 <code>2px</code> <code>RoundedRectangle(cornerRadius: 2)</code> Bottom Sheet \u9802\u90e8 <code>10px</code> <code>.cornerRadius(10, corners: [.topLeft, .topRight])</code> Bookie \u9078\u9805\u6309\u9215 <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code> Toast Message <code>10px</code> <code>RoundedRectangle(cornerRadius: 10)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#spacing","title":"\u9593\u8ddd (Spacing)","text":"\u5143\u4ef6 \u5c6c\u6027 \u503c SwiftUI Widget \u5916\u6846 padding <code>8px</code> <code>.padding(8)</code> Widget \u5916\u6846 gap <code>8px</code> <code>HStack(spacing: 8)</code> \u8f38\u5165\u6846 padding <code>12px 14px</code> <code>.padding(.horizontal, 14).padding(.vertical, 12)</code> Load \u6309\u9215 padding <code>12px</code> <code>.padding(12)</code> Load \u6309\u9215 height <code>28px</code> <code>.frame(height: 28)</code> Bookie Dropdown width <code>104px</code> <code>.frame(width: 104)</code> Bookie Dropdown height <code>44px</code> <code>.frame(height: 44)</code> Input Container height <code>44px</code> <code>.frame(height: 44)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#shadows","title":"\u9670\u5f71 (Shadows)","text":"\u5143\u4ef6 \u503c SwiftUI Toast Message <code>0px 4px 12px rgba(28, 26, 49, 0.25)</code> <code>.shadow(color: Color(hex: \"#1c1a31\").opacity(0.25), radius: 12, x: 0, y: 4)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#load-code-widget","title":"\ud83e\udde9 Load Code Widget","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_2","title":"\u5143\u4ef6\u7d50\u69cb","text":"<pre><code>Load Code Widget (\u5916\u6846)                    \u2190 10px \u5713\u89d2, #28263c \u80cc\u666f, 8px padding\n\u251c\u2500\u2500 Bookie Dropdown (\u5de6\u5074)                \u2190 104px \u00d7 44px, #100e26 \u80cc\u666f\n\u2502   \u251c\u2500\u2500 Bookie \u540d\u7a31 (\u5982 \"F.com\")          \u2190 #e7e7e9, 14px Medium\n\u2502   \u251c\u2500\u2500 Country \u540d\u7a31 (\u5982 \"NG\")            \u2190 #878693, 12px Regular\n\u2502   \u2514\u2500\u2500 \u4e0b\u62c9\u7bad\u982d icon                      \u2190 12px, #ffffff\n\u2514\u2500\u2500 Input Container (\u53f3\u5074)                \u2190 flex: 1, 44px \u9ad8, #100e26 \u80cc\u666f\n    \u251c\u2500\u2500 Placeholder / \u8f38\u5165\u6587\u5b57             \u2190 #878693 (placeholder) / #e7e7e9 (\u8f38\u5165)\n    \u251c\u2500\u2500 \u6e05\u9664\u6309\u9215 (Typing/Filled/Error)     \u2190 20px, #878693\n    \u2514\u2500\u2500 Load \u6309\u9215                          \u2190 28px \u9ad8, 2px \u5713\u89d2\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#6-figma-node-id","title":"6 \u7a2e\u72c0\u614b - Figma Node ID \u5c0d\u7167","text":"\u72c0\u614b Figma Node ID \u8f38\u5165\u6846\u908a\u6846 Load \u6309\u9215 \u984d\u5916\u5143\u7d20 Default <code>26769:88873</code> \u7121 \u7070\u8272 <code>#343247</code> - Focus <code>26769:88868</code> \u7da0\u8272 <code>#9ff611</code> 1px \u7070\u8272 <code>#343247</code> \u7da0\u8272\u6e38\u6a19 Typing <code>26769:88869</code> \u7da0\u8272 <code>#9ff611</code> 1px \u7da0\u8272 <code>#9ff611</code> \u6e05\u9664\u6309\u9215 \u2297 Filled <code>26769:88870</code> \u7121 \u7da0\u8272 <code>#9ff611</code> \u6e05\u9664\u6309\u9215 \u2297 Loading <code>26769:88872</code> \u7121 \u7070\u8272 + Spinner Loading \u63d0\u793a\u6587\u5b57 Error <code>26769:88871</code> \u7d05\u8272 <code>#fb4d3d</code> 1px \u7da0\u8272 <code>#9ff611</code> \u932f\u8aa4\u8a0a\u606f\uff08\u7d05\u8272\uff09"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#default","title":"Default \u72c0\u614b","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\n\u2502  \u2502 F.com     \u25bc  \u2502  \u2502 Booking Code              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502 \u2502\n\u2502  \u2502 NG           \u2502  \u2502                           \u2502 Load \u2502  \u2502 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2500\u2500\u2518 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u5916\u6846\nRoundedRectangle(cornerRadius: 10)\n    .fill(Color(hex: \"#28263c\"))  // background_type1_tertiary\n\n// Load \u6309\u9215 (\u7981\u7528)\nText(\"Load\")\n    .font(.system(size: 12, weight: .medium))\n    .foregroundColor(Color(hex: \"#9c9bab\"))  // text_disable_type1_primary\n    .padding(.horizontal, 12)\n    .frame(height: 28)\n    .background(\n        RoundedRectangle(cornerRadius: 2)\n            .fill(Color(hex: \"#343247\"))  // brand_secondary_disable\n    )\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#focus","title":"Focus \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - Input Container\uff1a<code>border: 1px solid #9ff611</code> - \u6e38\u6a19\uff1a<code>#9ff611</code>, 1px \u00d7 14px</p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u8f38\u5165\u6846\u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color(hex: \"#9ff611\"), lineWidth: 1)\n)\n\n// TextField \u6e38\u6a19\u984f\u8272\n.tint(Color(hex: \"#9ff611\"))\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#typing","title":"Typing \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - \u4fdd\u6301\u7da0\u8272\u908a\u6846 - \u986f\u793a\u6e05\u9664\u6309\u9215 \u2297\uff0820px\uff0c#878693\uff09 - Load \u6309\u9215\u8b8a\u70ba\u7da0\u8272\u555f\u7528</p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u6e05\u9664\u6309\u9215\nButton(action: onClear) {\n    Image(systemName: \"xmark.circle.fill\")\n        .resizable()\n        .frame(width: 20, height: 20)\n        .foregroundColor(Color(hex: \"#878693\"))\n}\n\n// Load \u6309\u9215 (\u555f\u7528)\nText(\"Load\")\n    .font(.system(size: 12, weight: .medium))\n    .foregroundColor(Color(hex: \"#100e26\"))  // brand_tertiary\n    .padding(.horizontal, 12)\n    .frame(height: 28)\n    .background(\n        RoundedRectangle(cornerRadius: 2)\n            .fill(Color(hex: \"#9ff611\"))  // brand_secondary\n    )\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#loading","title":"Loading \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - \u79fb\u9664\u908a\u6846 - Load \u6309\u9215\u8b8a\u70ba Loading Spinner - \u986f\u793a\u63d0\u793a\u6587\u5b57</p> <p>\u63d0\u793a\u6587\u5b57\uff1a <pre><code>\"Conversion may take up to 10 seconds, please stay here and wait for the result.\"\n</code></pre></p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// Loading Spinner\nProgressView()\n    .progressViewStyle(CircularProgressViewStyle(tint: Color.white))\n    .scaleEffect(0.8)\n\n// \u63d0\u793a\u6587\u5b57\nText(\"Conversion may take up to 10 seconds, please stay here and wait for the result.\")\n    .font(.system(size: 12, weight: .regular))\n    .foregroundColor(Color(hex: \"#e7e7e9\"))\n    .padding(.top, 8)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#error","title":"Error \u72c0\u614b","text":"<p>\u8b8a\u5316\uff1a - Input Container\uff1a<code>border: 1px solid #fb4d3d</code>\uff08\u7d05\u8272\uff09 - \u986f\u793a\u932f\u8aa4\u6587\u5b57\uff08\u7d05\u8272\uff09 - \u4fdd\u6301\u6e05\u9664\u6309\u9215 - Load \u6309\u9215\u4fdd\u6301\u7da0\u8272\uff08\u53ef\u91cd\u8a66\uff09</p> <p>\u932f\u8aa4\u6587\u5b57\uff1a <pre><code>\"We couldn't find this booking code on [BookieName]. Please check and try again.\"\n</code></pre></p> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>// \u7d05\u8272\u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color(hex: \"#fb4d3d\"), lineWidth: 1)\n)\n\n// \u932f\u8aa4\u6587\u5b57\nText(errorMessage)\n    .font(.system(size: 12, weight: .regular))\n    .foregroundColor(Color(hex: \"#fb4d3d\"))\n    .padding(.top, 8)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#bookie-selector-bottom-sheet","title":"\ud83d\udcf1 Bookie Selector Bottom Sheet","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#figma-node-ids","title":"Figma Node IDs","text":"\u5834\u666f Node ID \u958b\u555f\u9078\u55ae <code>26753:64425</code> \u591a\u570b\u5bb6 Bookie <code>26753:74664</code> \u9078\u64c7 Country <code>26753:78142</code> \u9ede\u64ca mask \u95dc\u9589 <code>26753:81632</code> \u9078\u64c7\u5b8c\u6210 <code>26753:85011</code> Scroll Bookie List <code>26748:63554</code> Bookie with Country <code>26748:63712</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_3","title":"\u5143\u4ef6\u7d50\u69cb","text":"<pre><code>Bottom Sheet                               \u2190 #100e26 \u80cc\u666f, 10px \u9802\u90e8\u5713\u89d2\n\u251c\u2500\u2500 \u62d6\u66f3\u689d (Drag Handle)                   \u2190 #d9d9d9, 60px \u00d7 4px, 18px \u5713\u89d2\n\u251c\u2500\u2500 \u6a19\u984c\u5217\n\u2502   \u251c\u2500\u2500 \"Bookie\" \u6a19\u7c64                       \u2190 #878693, 14px Medium\n\u2502   \u2514\u2500\u2500 \"Country\" \u6a19\u7c64                      \u2190 #878693, 14px Medium\n\u251c\u2500\u2500 \u96d9\u6b04\u9078\u64c7\u5668\n\u2502   \u251c\u2500\u2500 Bookie \u5217\u8868 (\u5de6\u6b04)\n\u2502   \u2514\u2500\u2500 Country \u5217\u8868 (\u53f3\u6b04)\n\u2514\u2500\u2500 \u6f38\u5c64\u906e\u7f69 (Fade Out Mask)                \u2190 #100e26 0% \u2192 100%, 12px \u9ad8\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_4","title":"\u6a23\u5f0f\u898f\u683c","text":"<p>Bottom Sheet \u5bb9\u5668\uff1a</p> <pre><code>.background(Color(hex: \"#100e26\"))\n.cornerRadius(10, corners: [.topLeft, .topRight])\n.padding(.horizontal, 12)\n.padding(.top, 6)\n.padding(.bottom, 16)\n</code></pre> <p>\u62d6\u66f3\u689d\uff1a</p> <pre><code>RoundedRectangle(cornerRadius: 18)\n    .fill(Color(hex: \"#d9d9d9\"))\n    .frame(width: 60, height: 4)\n</code></pre> <p>Bookie \u9078\u9805\u6309\u9215\uff1a</p> \u72c0\u614b \u80cc\u666f\u8272 \u6587\u5b57\u8272 \u672a\u9078\u4e2d <code>#464272</code> (50% opacity) <code>#ffffff</code> \u9078\u4e2d <code>#9ff611</code> <code>#464272</code> <pre><code>// \u672a\u9078\u4e2d\nRoundedRectangle(cornerRadius: 10)\n    .fill(Color(hex: \"#464272\").opacity(0.5))\n\n// \u9078\u4e2d\nRoundedRectangle(cornerRadius: 10)\n    .fill(Color(hex: \"#9ff611\"))\n</code></pre> <p>\u9078\u9805\u6309\u9215\u5c3a\u5bf8\uff1a</p> <pre><code>.frame(height: 40)\n.padding(.horizontal, 12)\n</code></pre> <p>\u5217\u9593\u8ddd\uff1a <code>8px</code> \u6b04\u9593\u8ddd\uff1a <code>12px</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_5","title":"\u6f38\u5c64\u906e\u7f69","text":"<pre><code>LinearGradient(\n    gradient: Gradient(colors: [\n        Color(hex: \"#100e26\").opacity(0),\n        Color(hex: \"#100e26\")\n    ]),\n    startPoint: .top,\n    endPoint: .bottom\n)\n.frame(height: 12)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#bookie-country","title":"Bookie \u6e05\u55ae + Country \u5c0d\u61c9","text":"Bookie \u652f\u63f4\u7684 Country \u9078\u64c7\u884c\u70ba F.com NG, GH \u9700\u9078 Country Sporty NG, GH \u9700\u9078 Country MSport NG, TZ \u9700\u9078 Country Bet9ja NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589 Bangbet NG, GH, TZ, KE, UG \u9700\u9078 Country BetKing NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589 1xBet NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589 Betway NG \u2705 \u81ea\u52d5\u9078 NG \u4e26\u95dc\u9589"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#toast-message-partial-error","title":"\ud83d\udd14 Toast Message (Partial Error)","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#figma-node-id","title":"Figma Node ID","text":"<p><code>26428:71769</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_6","title":"\u8996\u89ba\u898f\u683c","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u26a0  2 selections failed to convert                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>SwiftUI \u5be6\u4f5c\uff1a</p> <pre><code>struct PartialErrorToast: View {\n    let failedCount: Int\n\n    var body: some View {\n        HStack(spacing: 4) {\n            Image(\"icon/exclamtion/2\")  // 12px\n                .resizable()\n                .frame(width: 12, height: 12)\n                .foregroundColor(Color(hex: \"#e7e7e9\"))\n\n            Text(\"\\(failedCount) selection\\(failedCount &gt; 1 ? \"s\" : \"\") failed to convert\")\n                .font(.system(size: 12, weight: .regular))\n                .foregroundColor(Color(hex: \"#e7e7e9\"))\n        }\n        .padding(.horizontal, 16)\n        .padding(.vertical, 12)\n        .background(\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color(hex: \"#fb4d3d\"))\n        )\n        .shadow(\n            color: Color(hex: \"#1c1a31\").opacity(0.25),\n            radius: 12,\n            x: 0,\n            y: 4\n        )\n    }\n}\n</code></pre> <p>\u4f4d\u7f6e\uff1a \u87a2\u5e55\u5e95\u90e8\uff0c\u8ddd\u96e2\u5de6\u53f3 <code>10px</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#icons","title":"\ud83d\uddbc\ufe0f Icons","text":"Icon \u540d\u7a31 \u7528\u9014 \u5c3a\u5bf8 \u984f\u8272 <code>icon/arrow_3/down</code> Dropdown \u4e0b\u62c9\u7bad\u982d 12px <code>#ffffff</code> <code>icon/loading</code> Load \u6309\u9215 Loading 12px - <code>icon/cancel</code> (xmark.circle.fill) \u6e05\u9664\u8f38\u5165\u6846 20px <code>#878693</code> <code>icon/exclamtion/2</code> Toast \u8b66\u544a 12px <code>#e7e7e9</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#_7","title":"\ud83d\udcd0 \u97ff\u61c9\u5f0f\u898f\u5247","text":"<p>\u26a0\ufe0f \u8a2d\u8a08\u57fa\u65bc 360px \u5bec\u5ea6</p> \u5143\u4ef6 \u5bec\u5ea6\u898f\u5247 SwiftUI Load Code Widget \u6eff\u7248 - padding <code>.frame(maxWidth: .infinity)</code> Bookie Dropdown \u56fa\u5b9a <code>104px</code> <code>.frame(width: 104)</code> Input Container \u5f48\u6027\u586b\u6eff <code>.frame(maxWidth: .infinity)</code> Bottom Sheet \u6eff\u7248 <code>.frame(maxWidth: .infinity)</code> Toast Message \u6eff\u7248 - 20px <code>.padding(.horizontal, 10)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#checklist","title":"\u2705 \u5be6\u4f5c Checklist","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#load-code-widget_1","title":"Load Code Widget","text":"<ul> <li> \u5916\u6846\u5bb9\u5668\uff08#28263c, 10px \u5713\u89d2, 8px padding\uff09</li> <li> Bookie Dropdown\uff08104px \u00d7 44px\uff09</li> <li> Input Container\uff0844px \u9ad8\uff09</li> <li> 6 \u7a2e\u72c0\u614b\u5207\u63db</li> <li> \u6e05\u9664\u6309\u9215 \u2297</li> <li> Load \u6309\u9215\uff08\u555f\u7528/\u7981\u7528\u72c0\u614b\uff09</li> <li> Focus \u908a\u6846\uff08#9ff611\uff09</li> <li> Error \u908a\u6846\uff08#fb4d3d\uff09</li> <li> Loading \u63d0\u793a\u6587\u5b57</li> <li> Error \u8a0a\u606f\u6587\u5b57</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#bookie-selector","title":"Bookie Selector","text":"<ul> <li> Bottom Sheet \u5bb9\u5668\uff08#100e26\uff09</li> <li> \u62d6\u66f3\u689d\uff0860px \u00d7 4px\uff09</li> <li> \u96d9\u6b04\u9078\u64c7\u5668</li> <li> \u9078\u4e2d/\u672a\u9078\u4e2d\u72c0\u614b</li> <li> \u6f38\u5c64\u906e\u7f69</li> <li> \u55ae\u4e00\u570b\u5bb6\u81ea\u52d5\u95dc\u9589</li> <li> \u591a\u570b\u5bb6\u9078\u64c7\u6d41\u7a0b</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/02_view_design_specs/#toast-message","title":"Toast Message","text":"<ul> <li> \u5bb9\u5668\uff08#fb4d3d, 10px \u5713\u89d2\uff09</li> <li> Warning icon</li> <li> \u52d5\u614b\u6587\u5b57</li> <li> \u9670\u5f71\u6548\u679c</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/","title":"State \u2194 Figma Node Mapping","text":"<p>\u7528\u9014\uff1a\u8b93 AI \u5728\u5be6\u4f5c\u6642\u900f\u904e Figma MCP \u81ea\u52d5\u6293\u53d6\u5c0d\u61c9\u72c0\u614b\u7684\u8a2d\u8a08\u898f\u683c File Key\uff1a<code>SvcTlADMZ7gUPIa7nN2hT1</code> \u7248\u672c\uff1a01_09 (2025-01-09) - \u5df2\u79fb\u9664 Bookie Selector</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#01_09","title":"\u26a0\ufe0f 01_09 \u7248\u672c\u8b8a\u66f4","text":"\u9805\u76ee \u820a\u7248 (01_01) \u65b0\u7248 (01_09) \u6309\u9215\u6587\u5b57 \"Load\" \"Import\" Placeholder \"Booking Code\" \"Paste any booking code\" Bookie Selector \u2705 \u6709 \u274c \u79fb\u9664 Info Tip Icon \u274c \u6c92\u6709 \u2705 \u65b0\u589e"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#widgetinputstate-figma-node-mapping","title":"\ud83d\udd17 WidgetInputState \u2192 Figma Node Mapping","text":"State Enum Figma Node ID \u89f8\u767c\u689d\u4ef6 (Action/Condition) \u5c0d\u61c9 UI \u8b8a\u5316 <code>.default</code> <code>26769:88873</code> \u521d\u59cb\u72c0\u614b / <code>.inputBlurred</code> + \u7121\u8f38\u5165 \u7121\u908a\u6846\u3001Import \u7070\u8272 <code>.focus</code> <code>26769:88868</code> <code>.inputFocused</code> + \u7121\u8f38\u5165 \u7da0\u8272\u908a\u6846\u3001\u6e38\u6a19 <code>.typing</code> <code>26769:88869</code> <code>.bookingCodeChanged</code> + \u6709\u8f38\u5165 + \u805a\u7126 \u7da0\u8272\u908a\u6846\u3001\u6e05\u9664\u6309\u9215\u3001Import \u7da0\u8272 <code>.filled</code> <code>26769:88870</code> <code>.inputBlurred</code> + \u6709\u8f38\u5165 \u7121\u908a\u6846\u3001\u6e05\u9664\u6309\u9215\u3001Import \u7da0\u8272 <code>.loading</code> <code>26769:88872</code> <code>.loadBookingCode</code> \u57f7\u884c\u4e2d \u7121\u908a\u6846\u3001Spinner\u3001\u63d0\u793a\u6587\u5b57 <code>.error(message)</code> <code>26769:88871</code> <code>.convertCodeCompleted(.failure)</code> \u7d05\u8272\u908a\u6846\u3001\u932f\u8aa4\u8a0a\u606f\u3001Import \u7da0\u8272"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#figma-node-mapping-01_09","title":"\ud83d\udcf1 \u4e3b\u6d41\u7a0b\u756b\u9762 \u2192 Figma Node Mapping (01_09 \u7c21\u5316\u7248)","text":"\u6d41\u7a0b\u6b65\u9a5f \u756b\u9762 Figma Node ID \u5c0d\u61c9 Feature Action 1.0.0 \u9996\u9801 Default <code>26453:93262</code> \u521d\u59cb\u72c0\u614b 1.0.1 \u9996\u9801 Focus <code>26453:94175</code> <code>.inputFocused</code> 1.0.2 \u9996\u9801 Typing <code>26453:95089</code> <code>.bookingCodeChanged(\"...\")</code> ~~1.0.3~~ ~~Bookie \u9078\u64c7\u5668~~ - \u274c \u5df2\u79fb\u9664 ~~1.0.4~~ ~~\u8f38\u5165\u5b8c\u6210~~ - \u274c \u5df2\u79fb\u9664 1.0.5 Loading <code>26453:96003</code> <code>.loadBookingCode</code> 1.0.6 Error <code>26453:96916</code> <code>.convertCodeCompleted(.failure)</code> 1.0.8 Betslip <code>26428:71768</code> <code>.presentBetslip</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#bookie-selector-sheet-figma-node-mapping","title":"~~\ud83e\udde9 Bookie Selector Sheet \u2192 Figma Node Mapping~~","text":"<p>\u274c 01_09 \u7248\u672c\u5df2\u79fb\u9664\u6b64\u529f\u80fd Bookie Selector Sheet \u4e0d\u518d\u9700\u8981\uff0cAPI \u6703\u81ea\u52d5\u5224\u65b7 Bookie</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#toast-figma-node-mapping","title":"\ud83d\udd14 Toast \u2192 Figma Node Mapping","text":"Toast \u985e\u578b Figma Node ID \u89f8\u767c\u689d\u4ef6 Partial Error <code>26428:71769</code> <code>convertResult.failCnt &gt; 0 &amp;&amp; convertResult.successCnt &gt; 0</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#ai","title":"\ud83e\udd16 AI \u5be6\u4f5c\u5de5\u4f5c\u6d41\u7a0b","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#step-1-tdd-state-mapping","title":"Step 1: \u8b80\u53d6 TDD \u53d6\u5f97 State Mapping","text":"<pre><code>\u8b80\u53d6: 03_state_to_figma_mapping.md\n\u53d6\u5f97: WidgetInputState \u2192 Figma Node ID \u5c0d\u7167\u8868\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#step-2-figma-mcp","title":"Step 2: \u900f\u904e Figma MCP \u6293\u53d6\u8a2d\u8a08","text":"<pre><code>\u5c0d\u65bc\u6bcf\u500b\u9700\u8981\u5be6\u4f5c\u7684 State:\n  1. \u5f9e mapping \u8868\u53d6\u5f97 Figma Node ID\n  2. \u547c\u53eb mcp_Figma_get_design_context(fileKey, nodeId)\n  3. \u53d6\u5f97\u8a72\u72c0\u614b\u7684\u8a73\u7d30\u8a2d\u8a08\u898f\u683c\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#step-3-tdd-stateaction","title":"Step 3: \u6839\u64da TDD \u7684 State/Action \u5be6\u4f5c","text":"<pre><code>\u6839\u64da 06_Feature State and Action:\n  1. \u5be6\u4f5c WidgetInputState enum\n  2. \u5be6\u4f5c\u72c0\u614b\u8f49\u63db\u908f\u8f2f (Reducer)\n  3. \u5728 View \u4e2d\u6839\u64da inputState \u6e32\u67d3\u5c0d\u61c9 UI\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#figma-mcp","title":"\ud83d\udccb \u5be6\u4f5c\u6642\u7684 Figma MCP \u547c\u53eb\u7bc4\u4f8b","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#default","title":"\u6293\u53d6 Default \u72c0\u614b\u8a2d\u8a08","text":"<pre><code>{\n  \"tool\": \"mcp_Figma_get_design_context\",\n  \"params\": {\n    \"fileKey\": \"SvcTlADMZ7gUPIa7nN2hT1\",\n    \"nodeId\": \"26769:88873\",\n    \"clientLanguages\": \"swift\",\n    \"clientFrameworks\": \"swiftui\"\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#error","title":"\u6293\u53d6 Error \u72c0\u614b\u8a2d\u8a08","text":"<pre><code>{\n  \"tool\": \"mcp_Figma_get_design_context\",\n  \"params\": {\n    \"fileKey\": \"SvcTlADMZ7gUPIa7nN2hT1\",\n    \"nodeId\": \"26769:88871\",\n    \"clientLanguages\": \"swift\",\n    \"clientFrameworks\": \"swiftui\"\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#bookie-selector","title":"\u6293\u53d6 Bookie Selector \u8a2d\u8a08","text":"<pre><code>{\n  \"tool\": \"mcp_Figma_get_design_context\",\n  \"params\": {\n    \"fileKey\": \"SvcTlADMZ7gUPIa7nN2hT1\",\n    \"nodeId\": \"26748:63712\",\n    \"clientLanguages\": \"swift\",\n    \"clientFrameworks\": \"swiftui\"\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#_1","title":"\u26a1 \u5feb\u901f\u5c0d\u7167\u8868\uff08\u5be6\u4f5c\u7528\uff09","text":"<pre><code>// WidgetInputState \u2192 Figma Node ID\nextension WidgetInputState {\n    var figmaNodeId: String {\n        switch self {\n        case .default:        return \"26769:88873\"\n        case .focus:          return \"26769:88868\"\n        case .typing:         return \"26769:88869\"\n        case .filled:         return \"26769:88870\"\n        case .loading:        return \"26769:88872\"\n        case .error:          return \"26769:88871\"\n        }\n    }\n}\n\n// \u4e3b\u6d41\u7a0b\u756b\u9762\u5c0d\u61c9\nenum LoadBookingCodeSectionScreen {\n    case homepage_default     // 26453:93262\n    case homepage_focus       // 26453:94175\n    case homepage_typing      // 26453:95089\n    case bookie_selector      // 26479:188518\n    case homepage_filled      // 26479:195612\n    case homepage_loading     // 26453:96003\n    case homepage_error       // 26453:96916\n    case betslip_result       // 26428:71768\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/03_state_to_figma_mapping/#state-figma-node-01_09","title":"\ud83d\udd04 State \u8f49\u63db\u5716 + Figma Node (01_09 \u7c21\u5316\u7248)","text":"<pre><code>stateDiagram-v2\n    [*] --&gt; default: \u521d\u59cb\u5316\n\n    default --&gt; focus: inputFocused\n    note right of default: 26769:88873\n\n    focus --&gt; typing: bookingCodeChanged (\u6709\u8f38\u5165)\n    focus --&gt; default: inputBlurred (\u7121\u8f38\u5165)\n    note right of focus: 26769:88868\n\n    typing --&gt; focus: clearButtonTapped\n    typing --&gt; filled: inputBlurred\n    typing --&gt; loading: loadBookingCode (Import \u6309\u9215)\n    note right of typing: 26769:88869\n\n    filled --&gt; focus: inputFocused\n    filled --&gt; typing: bookingCodeChanged\n    filled --&gt; loading: loadBookingCode (Import \u6309\u9215)\n    note right of filled: 26769:88870\n\n    loading --&gt; default: convertCodeCompleted (success) \u2192 Betslip\n    loading --&gt; error: convertCodeCompleted (failure)\n    note right of loading: 26769:88872\n\n    error --&gt; typing: bookingCodeChanged\n    error --&gt; focus: clearButtonTapped\n    note right of error: 26769:88871</code></pre> <p>01_09 \u8b8a\u66f4\uff1a\u79fb\u9664\u4e86 Bookie Selector \u76f8\u95dc\u7684\u72c0\u614b\u8f49\u63db</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/","title":"Figma \u2192 DesignSystem Mapping","text":"<p>\u76ee\u7684\uff1a\u5c07 Figma \u8a2d\u8a08\u898f\u683c\u5c0d\u61c9\u5230 codebase \u73fe\u6709\u7684 DesignSystem \u984f\u8272/\u6a23\u5f0f \u4f86\u6e90\uff1a<code>DesignSystem/Sources/Colors/</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#_1","title":"\ud83c\udfa8 \u984f\u8272\u5c0d\u7167\u8868","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#brand","title":"\u54c1\u724c\u8272 (Brand)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>brand/brand_secondary</code> <code>#9FF611</code> \u2705 <code>Color.brandSecondary</code> <code>.foregroundColor(.brandSecondary)</code> <code>brand/brand_secondary_disable</code> <code>#343247</code> \u2705 <code>Color.brandSecondaryDisable</code> <code>.background(Color.brandSecondaryDisable)</code> <code>brand/brand_tertiary</code> <code>#100E26</code> \u2705 <code>Color.brandTertiary</code> <code>.background(Color.brandTertiary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#background","title":"\u80cc\u666f\u8272 (Background)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>background_type1_primary</code> <code>#1C1A31</code> \u2705 <code>Color.backgroundType1Primary</code> <code>.background(Color.backgroundType1Primary)</code> <code>background_type1_secondary</code> <code>#100E26</code> \u2705 <code>Color.backgroundType1Secondary</code> <code>.background(Color.backgroundType1Secondary)</code> <code>background_type1_tertiary</code> <code>#28263C</code> \u2705 <code>Color.backgroundType1Tertiary</code> <code>.background(Color.backgroundType1Tertiary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#text","title":"\u6587\u5b57\u8272 (Text)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>text_type1_primary</code> <code>#E7E7E9</code> \u2705 <code>Color.textType1Primary</code> <code>.foregroundColor(.textType1Primary)</code> <code>text_type1_secondary</code> <code>#878693</code> \u2705 <code>Color.textType1Secondary</code> <code>.foregroundColor(.textType1Secondary)</code> <code>text_type1_tertiary</code> <code>#FFFFFF</code> \u2705 <code>Color.textType1Tertiary</code> <code>.foregroundColor(.textType1Tertiary)</code> <code>text_disable_type1_primary</code> <code>#9C9BAB</code> \u2705 <code>Color.textDisableType1Primary</code> <code>.foregroundColor(.textDisableType1Primary)</code> <code>text_type2_secondary</code> <code>#E7E7E9</code> \u2705 <code>Color.textType2Secondary</code> <code>.foregroundColor(.textType2Secondary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#line","title":"\u7dda\u689d/\u908a\u6846 (Line)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>line_type1_primary</code> <code>#332F59</code> \u2705 <code>Color.lineType1Primary</code> <code>.stroke(Color.lineType1Primary)</code> <code>line_type1_secondary</code> <code>#464272</code> \u2705 <code>Color.lineType1Secondary</code> <code>.stroke(Color.lineType1Secondary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#warning","title":"\u8b66\u544a/\u932f\u8aa4 (Warning)","text":"Figma \u8b8a\u6578 Hex (Dark) DesignSystem SwiftUI \u4f7f\u7528 <code>warning_primary</code> <code>#FB4D3D</code> \u2705 <code>Color.warningPrimary</code> <code>.foregroundColor(.warningPrimary)</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#_2","title":"\ud83e\udde9 \u5143\u4ef6\u5c0d\u7167\u8868","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#load-code-widget","title":"Load Code Widget","text":"<pre><code>// \u5916\u6846\u80cc\u666f\n.background(Color.backgroundType1Tertiary)  // #28263C\n\n// Dropdown / Input \u80cc\u666f\n.background(Color.backgroundType1Secondary)  // #100E26\n\n// Focus \u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color.brandSecondary, lineWidth: 1)  // #9FF611\n)\n\n// Error \u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color.warningPrimary, lineWidth: 1)  // #FB4D3D\n)\n\n// Placeholder \u6587\u5b57\n.foregroundColor(.textType1Secondary)  // #878693\n\n// \u8f38\u5165\u6587\u5b57\n.foregroundColor(.textType1Primary)  // #E7E7E9\n\n// \u6e38\u6a19\u984f\u8272\n.tint(.brandSecondary)  // #9FF611\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#load","title":"Load \u6309\u9215","text":"<pre><code>// \u555f\u7528\u72c0\u614b\nText(\"Load\")\n    .foregroundColor(.brandTertiary)  // #100E26 (\u6df1\u8272\u80cc\u666f\u4e0a\u7684\u6587\u5b57)\n    .background(Color.brandSecondary)  // #9FF611\n\n// \u7981\u7528\u72c0\u614b\nText(\"Load\")\n    .foregroundColor(.textDisableType1Primary)  // #9C9BAB\n    .background(Color.brandSecondaryDisable)  // #343247\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#_3","title":"\u6e05\u9664\u6309\u9215","text":"<pre><code>Image(systemName: \"xmark.circle.fill\")\n    .foregroundColor(.textType1Secondary)  // #878693\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#error","title":"Error \u8a0a\u606f","text":"<pre><code>Text(errorMessage)\n    .foregroundColor(.warningPrimary)  // #FB4D3D\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#bookie-selector-sheet","title":"Bookie Selector Sheet","text":"<pre><code>// Sheet \u80cc\u666f\n.background(Color.brandTertiary)  // #100E26\n\n// \u672a\u9078\u4e2d\u6309\u9215\n.background(Color.lineType1Secondary.opacity(0.5))  // #464272 @ 50%\n.foregroundColor(.textType1Tertiary)  // #FFFFFF\n\n// \u9078\u4e2d\u6309\u9215\n.background(Color.brandSecondary)  // #9FF611\n.foregroundColor(.lineType1Secondary)  // #464272\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#toast-partial-error","title":"Toast (Partial Error)","text":"<pre><code>HStack(spacing: 4) {\n    Image(\"icon/exclamtion/2\")\n        .foregroundColor(.textType2Secondary)  // #E7E7E9\n    Text(\"\\(count) selections failed to convert\")\n        .foregroundColor(.textType2Secondary)  // #E7E7E9\n}\n.background(Color.warningPrimary)  // #FB4D3D\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#_4","title":"\u26a0\ufe0f \u7f3a\u5c11\u7684\u984f\u8272\uff08\u9700\u78ba\u8a8d\uff09","text":"<p>\u4ee5\u4e0b\u984f\u8272\u5728 Figma \u8a2d\u8a08\u7a3f\u4e2d\u51fa\u73fe\uff0c\u4f46\u5728 DesignSystem \u4e2d\u53ef\u80fd\u9700\u8981\u78ba\u8a8d\uff1a</p> Figma \u7528\u9014 Hex \u5efa\u8b70 DesignSystem \u5c0d\u61c9 \u62d6\u66f3\u689d (Drag Handle) <code>#D9D9D9</code> \u53ef\u80fd\u9700\u65b0\u589e\u6216\u4f7f\u7528 <code>.indicator</code> \u6f38\u5c64\u906e\u7f69 <code>#100E26</code> \u2192 transparent \u4f7f\u7528 <code>Color.brandTertiary</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#_5","title":"\ud83d\udccb \u5feb\u901f\u5c0d\u7167\u6e05\u55ae","text":"<pre><code>// === \u54c1\u724c\u8272 ===\nColor.brandSecondary          // #9FF611 - Focus \u908a\u6846\u3001CTA \u6309\u9215\nColor.brandSecondaryDisable   // #343247 - \u7981\u7528\u6309\u9215\nColor.brandTertiary           // #100E26 - \u6df1\u8272\u80cc\u666f\n\n// === \u80cc\u666f\u8272 ===\nColor.backgroundType1Primary   // #1C1A31 - \u4e3b\u80cc\u666f\nColor.backgroundType1Secondary // #100E26 - \u8f38\u5165\u6846\u80cc\u666f\nColor.backgroundType1Tertiary  // #28263C - Widget \u5916\u6846\n\n// === \u6587\u5b57\u8272 ===\nColor.textType1Primary         // #E7E7E9 - \u4e3b\u6587\u5b57\nColor.textType1Secondary       // #878693 - \u6b21\u6587\u5b57\u3001Placeholder\nColor.textType1Tertiary        // #FFFFFF - \u767d\u8272\u6587\u5b57\nColor.textDisableType1Primary  // #9C9BAB - \u7981\u7528\u6587\u5b57\n\n// === \u8b66\u544a ===\nColor.warningPrimary           // #FB4D3D - \u932f\u8aa4\u908a\u6846\u3001\u932f\u8aa4\u6587\u5b57\n\n// === \u7dda\u689d ===\nColor.lineType1Secondary       // #464272 - Bookie \u9078\u9805\u80cc\u666f\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/04_figma_to_design_system_mapping/#tdd-vs-designsystem","title":"\ud83d\udd04 TDD \u539f\u59cb\u898f\u683c vs DesignSystem \u5c0d\u7167","text":"TDD \u539f\u59cb\u5beb\u6cd5 \u61c9\u6539\u70ba <code>Color(hex: \"#9ff611\")</code> <code>Color.brandSecondary</code> <code>Color(hex: \"#343247\")</code> <code>Color.brandSecondaryDisable</code> <code>Color(hex: \"#100e26\")</code> <code>Color.brandTertiary</code> \u6216 <code>Color.backgroundType1Secondary</code> <code>Color(hex: \"#28263c\")</code> <code>Color.backgroundType1Tertiary</code> <code>Color(hex: \"#e7e7e9\")</code> <code>Color.textType1Primary</code> <code>Color(hex: \"#878693\")</code> <code>Color.textType1Secondary</code> <code>Color(hex: \"#9c9bab\")</code> <code>Color.textDisableType1Primary</code> <code>Color(hex: \"#fb4d3d\")</code> <code>Color.warningPrimary</code> <code>Color(hex: \"#464272\")</code> <code>Color.lineType1Secondary</code> <code>Color(hex: \"#ffffff\")</code> <code>Color.textType1Tertiary</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/","title":"UI \u5c64\u66ff\u63db\u7b56\u7565\uff1aLoadBookingCodeSectionView \u2192 LoadCodeViewController","text":"<p>\u7248\u672c\uff1a01_09 (2025-01-09) \u8b8a\u66f4\u539f\u56e0\uff1a\u9700\u6c42\u8abf\u6574\uff0c\u7c21\u5316 Bookie \u9078\u64c7\u6d41\u7a0b \u5c08\u6ce8\uff1aUI \u5c64\u66ff\u63db</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#tdd-01_01","title":"\u26a0\ufe0f \u8207 TDD \u820a\u7248 (01_01) \u7684\u4e3b\u8981\u5dee\u7570","text":"\u9805\u76ee \u820a\u7248 (01_01) \u65b0\u7248 (01_09) \u5f71\u97ff BookieDropdownView \u2705 \u9700\u8981 \u274c \u79fb\u9664 \u4e0d\u9700\u5be6\u4f5c BookieSelectorSheet \u2705 \u9700\u8981 \u274c \u79fb\u9664 \u4e0d\u9700\u5be6\u4f5c CountryDropdownView \u2705 \u9700\u8981 \u274c \u79fb\u9664 \u4e0d\u9700\u64f4\u5c55 Info Tip Icon \u274c \u6c92\u6709 \u2705 \u65b0\u589e \u9700\u5be6\u4f5c \u6309\u9215\u6587\u5b57 \"Load\" \"Import\" \u6587\u5b57\u8b8a\u66f4 Placeholder \"Booking Code\" \"Paste any booking code\" \u6587\u5b57\u8b8a\u66f4 \u5143\u4ef6\u4f48\u5c40 HStack (Dropdown + Input) \u53ea\u6709 Input Row \u7d50\u69cb\u7c21\u5316"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#01_09","title":"\ud83d\udcd0 \u7c21\u5316\u5f8c\u7684\u5143\u4ef6\u7d50\u69cb (01_09)","text":"<pre><code>LoadBookingCodeSectionView\n\u251c\u2500\u2500 VStack\n\u2502   \u251c\u2500\u2500 Input Row (HStack)\n\u2502   \u2502   \u251c\u2500\u2500 Input Container (ZStack)\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 TextField (placeholder / \u8f38\u5165\u6587\u5b57)\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 Clear Icon \u2297 (\u689d\u4ef6\u986f\u793a)\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 Import Button / Loading Spinner\n\u2502   \u2502   \u2514\u2500\u2500 Info Tip Icon \u24d8 (16px)\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 Helper Text (\u689d\u4ef6\u986f\u793a)\n\u2502       \u251c\u2500\u2500 Loading: \"Conversion may take up to 10 seconds...\"\n\u2502       \u2514\u2500\u2500 Error: \"We couldn't find this booking code...\"\n\u2514\u2500\u2500 (\u7121 Sheet\uff0c\u5df2\u79fb\u9664 Bookie Selector)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#state-bookie","title":"\ud83d\udd04 State \u7c21\u5316\uff08\u79fb\u9664 Bookie \u76f8\u95dc\uff09","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#state01_01","title":"\u539f\u6709 State\uff0801_01\uff09","text":"<pre><code>struct State: Equatable {\n    // \u539f\u6709\n    var bookingCode: String = \"\"\n    var selectedCountry: Region = .current      // \u2190 \u4fdd\u7559\u5411\u5f8c\u76f8\u5bb9\n    var isLoading: Bool = false\n\n    // Code Converter (01_01)\n    var enableCodeConverter: Bool = true\n    var selectedBookie: SelectedBookie?         // \u274c \u79fb\u9664\n    var providerConfigs: [ProviderConfig] = []  // \u274c \u79fb\u9664\n    var inputState: WidgetInputState = .default // \u2705 \u4fdd\u7559\n    var isBookieSelectorPresented: Bool = false // \u274c \u79fb\u9664\n    var errorMessage: String?                   // \u2705 \u4fdd\u7559\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#state01_09","title":"\u7c21\u5316\u5f8c State\uff0801_09\uff09","text":"<pre><code>@ObservableState\nstruct State: Equatable {\n    // ========== \u6838\u5fc3\u5c6c\u6027 ==========\n    var bookingCode: String = \"\"\n    var inputState: WidgetInputState = .default\n    var errorMessage: String?\n\n    // ========== \u5411\u5f8c\u76f8\u5bb9\uff08\u5982\u6709\u9700\u8981\uff09 ==========\n    var isLoading: Bool = false\n    var selectedCountry: Region = .current\n    var enableCodeConverter: Bool = true\n\n    // ========== \u5df2\u79fb\u9664 ==========\n    // var selectedBookie: SelectedBookie?\n    // var providerConfigs: [ProviderConfig] = []\n    // var isBookieSelectorPresented: Bool = false\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#action","title":"\ud83c\udfaf Action \u7c21\u5316","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#action_1","title":"\u9700\u4fdd\u7559\u7684 Action","text":"<pre><code>enum Action: Equatable {\n    // \u539f\u6709\uff08\u4fdd\u6301\u76f8\u5bb9\uff09\n    case onAppear\n    case bookingCodeChanged(String)\n    case loadBookingCode\n    case bookingCodeLoadFailed(String)\n    case bookingCodeLoaded(LoadCodeModel.CodeResult)\n\n    // \u8f38\u5165\u76f8\u95dc\n    case inputFocused\n    case inputBlurred\n    case clearButtonTapped\n    case infoTipTapped          // \ud83c\udd95 \u65b0\u589e\n\n    // Code Converter\n    case convertCodeCompleted(Result&lt;ConvertBookingCodeOutput, Error&gt;)\n    case presentBetslip(shareCode: String, failCnt: Int)\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#action_2","title":"\u5df2\u79fb\u9664\u7684 Action","text":"<pre><code>// \u274c \u4e0d\u518d\u9700\u8981\n// case bookieDropdownTapped\n// case bookieSelectorDismissed\n// case bookieSelected(provider: String, country: CountryCode)\n// case providerConfigLoaded(Result&lt;[ProviderConfig], Error&gt;)\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#view","title":"\ud83e\udde9 View \u5be6\u4f5c\uff08\u7c21\u5316\u7248\uff09","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#loadbookingcodesectionviewswift","title":"LoadBookingCodeSectionView.swift","text":"<pre><code>struct LoadBookingCodeSectionView: View {\n    let store: StoreOf&lt;LoadBookingCodeSection.Feature&gt;\n    @FocusState private var isTextFieldFocused: Bool\n\n    var body: some View {\n        WithPerceptionTracking {\n            VStack(spacing: 4) {\n                // \u4e3b\u8f38\u5165\u5340\n                inputRow\n\n                // Loading / Error \u63d0\u793a\n                helperTextView\n            }\n            .padding(8)\n            .background(\n                RoundedRectangle(cornerRadius: 10)\n                    .fill(Color.backgroundType1Tertiary) // #28263c\n            )\n        }\n    }\n\n    // MARK: - Input Row\n    private var inputRow: some View {\n        HStack(spacing: 8) {\n            inputContainer\n            infoTipIcon\n        }\n    }\n\n    // MARK: - Input Container\n    private var inputContainer: some View {\n        HStack(spacing: 8) {\n            // TextField\n            TextField(\"Paste any booking code\", text: $store.bookingCode.sending(\\.bookingCodeChanged))\n                .font(.custom(\"Roboto\", size: 14))\n                .foregroundColor(Color.textType1Primary)    // #e7e7e9\n                .tint(Color.brandSecondary)                  // #9ff611\n                .focused($isTextFieldFocused)\n                .onSubmit { store.send(.loadBookingCode) }\n                .onChange(of: isTextFieldFocused) { newValue in\n                    store.send(newValue ? .inputFocused : .inputBlurred)\n                }\n                .textInputAutocapitalization(.never)\n                .autocorrectionDisabled()\n\n            // Clear Button\n            if store.inputState.showClearButton {\n                Button { store.send(.clearButtonTapped) } label: {\n                    Image(systemName: \"xmark.circle.fill\")\n                        .foregroundColor(Color.textType1Secondary) // #878693\n                        .frame(width: 20, height: 20)\n                }\n            }\n\n            // Import Button / Loading\n            importButton\n        }\n        .padding(.horizontal, 12)\n        .frame(height: 44)\n        .background(\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color.backgroundType1Secondary) // #100e26\n        )\n        .overlay(\n            RoundedRectangle(cornerRadius: 10)\n                .stroke(borderColor, lineWidth: 2)\n        )\n    }\n\n    // MARK: - Import Button\n    @ViewBuilder\n    private var importButton: some View {\n        if store.inputState == .loading {\n            ProgressView()\n                .progressViewStyle(CircularProgressViewStyle(tint: Color.brandSecondary))\n                .frame(width: 12, height: 12)\n                .padding(.horizontal, 12)\n        } else {\n            Button { store.send(.loadBookingCode) } label: {\n                Text(\"Import\")\n                    .font(.custom(\"Roboto-Medium\", size: 12))\n                    .foregroundColor(store.isImportButtonEnabled\n                        ? Color.brandTertiary           // #100e26\n                        : Color.textDisableType1Primary // #9c9bab\n                    )\n                    .padding(.horizontal, 12)\n                    .frame(height: 28)\n                    .background(\n                        RoundedRectangle(cornerRadius: 2)\n                            .fill(store.isImportButtonEnabled\n                                ? Color.brandSecondary         // #9ff611\n                                : Color.brandSecondaryDisable  // #343247\n                            )\n                    )\n            }\n            .disabled(!store.isImportButtonEnabled)\n        }\n    }\n\n    // MARK: - Info Tip Icon\n    private var infoTipIcon: some View {\n        Button { store.send(.infoTipTapped) } label: {\n            Image(\"icon/tip/1\") // \u6216 systemName\n                .foregroundColor(Color.textType1Secondary) // #878693\n                .frame(width: 16, height: 16)\n        }\n    }\n\n    // MARK: - Helper Text\n    @ViewBuilder\n    private var helperTextView: some View {\n        if store.inputState == .loading {\n            Text(\"Conversion may take up to 10 seconds, please stay here and wait for the result.\")\n                .font(.custom(\"Roboto\", size: 12))\n                .foregroundColor(Color.textType1Primary) // #e7e7e9\n                .multilineTextAlignment(.leading)\n                .frame(maxWidth: .infinity, alignment: .leading)\n                .padding(.top, 4)\n        }\n\n        if let error = store.errorMessage {\n            Text(error)\n                .font(.custom(\"Roboto\", size: 12))\n                .foregroundColor(Color.warningPrimary) // #fb4d3d\n                .multilineTextAlignment(.leading)\n                .frame(maxWidth: .infinity, alignment: .leading)\n                .padding(.top, 4)\n        }\n    }\n\n    // MARK: - Border Color\n    private var borderColor: Color {\n        switch store.inputState {\n        case .focus, .typing:\n            return Color.brandSecondary  // #9ff611\n        case .error:\n            return Color.warningPrimary  // #fb4d3d\n        default:\n            return Color.clear\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#computed-properties","title":"\ud83d\udccb Computed Properties\uff08\u7c21\u5316\u7248\uff09","text":"<pre><code>extension LoadBookingCodeSection.State {\n    /// Import \u6309\u9215\u662f\u5426\u555f\u7528\n    var isImportButtonEnabled: Bool {\n        !bookingCode.isEmpty &amp;&amp; inputState.isImportButtonEnabled\n    }\n\n    /// \u662f\u5426\u986f\u793a\u6e05\u9664\u6309\u9215\n    var showClearButton: Bool {\n        !bookingCode.isEmpty &amp;&amp; inputState.showClearButton\n    }\n}\n\nextension WidgetInputState {\n    var isImportButtonEnabled: Bool {\n        switch self {\n        case .typing, .filled, .error: return true\n        default: return false\n        }\n    }\n\n    var showClearButton: Bool {\n        switch self {\n        case .typing, .filled, .error: return true\n        default: return false\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#_1","title":"\ud83d\uddd1\ufe0f \u53ef\u522a\u9664\u7684\u6a94\u6848/\u5143\u4ef6","text":"\u6a94\u6848 \u539f\u56e0 <code>BookieDropdownView.swift</code> \u4e0d\u9700\u5be6\u4f5c\uff08\u5df2\u79fb\u9664 Bookie Selector\uff09 <code>BookieSelectorSheet.swift</code> \u4e0d\u9700\u5be6\u4f5c\uff08\u5df2\u79fb\u9664 Bookie Selector\uff09 <code>CountryDropdownView.swift</code> \u64f4\u5c55\u908f\u8f2f \u4e0d\u9700\u64f4\u5c55 <code>LoadProviderConfigUseCase.swift</code> \u4e0d\u9700 Provider Config API"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#loadcodeviewcontroller","title":"\ud83d\udd04 \u66ff\u63db LoadCodeViewController \u7684\u6b65\u9a5f","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#phase-1-loadbookingcodesectionview","title":"Phase 1: \u64f4\u5c55 LoadBookingCodeSectionView","text":"<pre><code>// 1. \u66f4\u65b0 BookingCodeInputView \u2192 \u589e\u52a0 6 \u7a2e\u72c0\u614b\n// 2. \u65b0\u589e Info Tip Icon\n// 3. \u65b0\u589e Helper Text View (Loading / Error)\n// 4. \u66f4\u65b0\u6309\u9215\u6587\u5b57 \"Load\" \u2192 \"Import\"\n// 5. \u66f4\u65b0 Placeholder \u6587\u5b57\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#phase-2-feature-tca","title":"Phase 2: \u66f4\u65b0 Feature (TCA)","text":"<pre><code>// 1. State \u589e\u52a0 inputState, errorMessage\n// 2. Action \u589e\u52a0 inputFocused, inputBlurred, clearButtonTapped, infoTipTapped\n// 3. Reducer \u589e\u52a0\u72c0\u614b\u8f49\u63db\u908f\u8f2f\n// 4. \u79fb\u9664 Bookie \u76f8\u95dc\u908f\u8f2f\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#phase-3","title":"Phase 3: \u66ff\u63db\u5165\u53e3\u9ede","text":"\u5165\u53e3\u9ede \u73fe\u6709 \u66ff\u63db\u70ba \u9996\u9801 Widget <code>LoadBookingCodeSectionView</code> \u539f\u5730\u64f4\u5c55 Code Center <code>LoadCodeViewWrapper</code> \u2192 <code>LoadCodeViewController</code> <code>LoadBookingCodeSectionView</code> (UIHostingController) Betslip Empty \u7121 \u5d4c\u5165 <code>LoadBookingCodeSectionView</code>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#phase-4","title":"Phase 4: \u6e05\u7406","text":"<pre><code>// 1. \u79fb\u9664 LoadCodeViewController.swift  \u2705 \u53ef\u76f4\u63a5\u522a\u9664\n// 2. \u79fb\u9664 LoadCodeViewController.xib     \u2705 \u53ef\u76f4\u63a5\u522a\u9664\n// 3. \u79fb\u9664 LoadCodeViewWrapper.swift\n</code></pre> <p>\u26a0\ufe0f \u78ba\u8a8d\uff1a<code>LoadCodeViewController.swift</code> \u548c <code>LoadCodeViewController.xib</code> \u53ef\u76f4\u63a5\u79fb\u9664\uff0c\u7121\u4f9d\u8cf4\u554f\u984c</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#design-tokens","title":"\ud83d\udcd0 Design Tokens \u5feb\u901f\u53c3\u8003","text":"<pre><code>extension Color {\n    // Background\n    static let backgroundType1Tertiary = Color(hex: \"#28263c\")\n    static let backgroundType1Secondary = Color(hex: \"#100e26\")\n\n    // Text\n    static let textType1Primary = Color(hex: \"#e7e7e9\")\n    static let textType1Secondary = Color(hex: \"#878693\")\n    static let textDisableType1Primary = Color(hex: \"#9c9bab\")\n\n    // Brand\n    static let brandSecondary = Color(hex: \"#9ff611\")\n    static let brandTertiary = Color(hex: \"#100e26\")\n    static let brandSecondaryDisable = Color(hex: \"#343247\")\n\n    // Warning\n    static let warningPrimary = Color(hex: \"#fb4d3d\")\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#info-icon-guidedialog-2025-01-12","title":"\ud83c\udd95 Info Icon \u2192 GuideDialog (2025-01-12 \u65b0\u589e)","text":"<p>\u9ede\u64ca Info Icon (\u24d8) \u5f48\u51fa\u8aaa\u660e Dialog</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#figma","title":"Figma \u8cc7\u8a0a","text":"\u9805\u76ee \u503c Frame node-id <code>27536:81442</code> Dialog node-id <code>27536:84826</code> \u6a19\u984c \"Import Booking Code\" \u5167\u5bb9 Bullet list \u8aaa\u660e \u6309\u9215 \"Ok\""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#guidedialog","title":"\u5fa9\u7528\u73fe\u6709 GuideDialog \u5143\u4ef6","text":"<pre><code>// \u8def\u5f91: FComUI/Sources/FComUI/GuideDialog/\n\n// 1. \u5b9a\u7fa9 Action\ncase infoTipTapped  // \u9ede\u64ca Info Icon\n\n// 2. \u5728 Reducer \u4e2d\u8655\u7406\ncase .infoTipTapped:\n    state.isGuideDialogPresented = true\n    return .none\n\n// 3. \u5728 View \u4e2d\u986f\u793a Dialog\n.fullScreenCover(isPresented: $store.isGuideDialogPresented) {\n    FComUIFactory.createGuideDialogView(\n        viewState: .init(\n            pages: [\n                .init(\n                    title: \"Import Booking Code\",\n                    description: \"\"\"\n                    \u2022 Paste a booking code to load its selections into your betslip.\n                    \u2022 Supports our codes and codes from other betting sites.\n                    \"\"\",\n                    contentSource: .image(.asset(name: \"\"))\n                )\n            ],\n            finalButtonTitle: \"Ok\",\n            theme: .init(\n                backgroundStyle: .absoluteType1,\n                titleStyle: .h3m,\n                descriptionStyle: .h4r\n            ),\n            contentTopPadding: 0\n        ),\n        viewAction: .init(\n            onDoneButtonTapped: {\n                store.send(.guideDialogDismissed)\n            }\n        )\n    )\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#state","title":"State \u65b0\u589e","text":"<pre><code>// \u65b0\u589e State \u5c6c\u6027\nvar isGuideDialogPresented: Bool = false\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#action_3","title":"Action \u65b0\u589e","text":"<pre><code>// \u65b0\u589e Action\ncase infoTipTapped\ncase guideDialogDismissed\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#one-time-tooltip-2025-01-12","title":"\ud83c\udd95 One-Time Tooltip (2025-01-12 \u65b0\u589e)","text":"<p>Feature \u4e0a\u7dda\u5f8c\u986f\u793a\u4e00\u6b21\u6027\u63d0\u793a\uff0c\u6309 device ID \u5b58\u5132</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#figma_1","title":"Figma \u8cc7\u8a0a","text":"\u9805\u76ee \u503c Frame node-id <code>27526:67890</code> Tooltip node-id <code>27526:71304</code> \u6587\u5b57 \"Supports booking codes from many platforms\" \u4f4d\u7f6e Widget \u4e0b\u65b9 (downLeading)"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#tooltip","title":"\u5fa9\u7528\u73fe\u6709 Tooltip \u5143\u4ef6","text":"<pre><code>// \u8def\u5f91: FComUI/Sources/FComUI/Tooltip/\n\n// \u4f7f\u7528\u65b9\u5f0f\nimport FComUI\n\nstruct SomeParentView: View {\n    @State private var showTooltip = !CodeConverterTooltipStorage.hasShown\n    @State private var widgetFrame: CGRect = .zero\n\n    var body: some View {\n        VStack {\n            LoadBookingCodeSectionView(...)\n                .showTooltip(config: Tooltip.TooltipSwiftUIConfig(\n                    isPresented: $showTooltip,\n                    anchorFrame: $widgetFrame,\n                    placement: .downLeading,\n                    description: \"Supports booking codes from many platforms\",\n                    onClose: {\n                        CodeConverterTooltipStorage.markAsShown()\n                    },\n                    duration: 0  // \u4e0d\u81ea\u52d5\u6d88\u5931\n                ))\n        }\n        .tooltipOverlay()  // \u5fc5\u9808\u5728\u5916\u5c64\u52a0\u4e0a\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#tooltip_1","title":"Tooltip \u5132\u5b58\u908f\u8f2f","text":"<pre><code>struct CodeConverterTooltipStorage {\n    private static let key = \"code_converter_tooltip_shown\"\n\n    static var hasShown: Bool {\n        UserDefaults.standard.bool(forKey: key)\n    }\n\n    static func markAsShown() {\n        UserDefaults.standard.set(true, forKey: key)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#tooltip-figma","title":"Tooltip \u6a23\u5f0f (\u5df2\u5f9e Figma \u78ba\u8a8d)","text":"\u5c6c\u6027 \u503c \u80cc\u666f\u8272 <code>#4d5fae</code> (hint_background_type1) \u6587\u5b57\u8272 <code>#e7e7e9</code> \u5b57\u578b Body/B2_R (Roboto Regular 12px) \u5713\u89d2 4px Padding 12px \u00d7 6px \u7bad\u982d \u5411\u4e0a\uff0c16\u00d712px"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#checklist","title":"\u2705 \u9a57\u8b49 Checklist","text":"<ul> <li> 6 \u7a2e\u8f38\u5165\u72c0\u614b\u6b63\u78ba\u6e32\u67d3 (Default, Focus, Typing, Filled, Loading, Error)</li> <li> Import \u6309\u9215\u72c0\u614b\u6b63\u78ba (\u555f\u7528/\u7981\u7528/Loading)</li> <li> Clear \u6309\u9215\u689d\u4ef6\u986f\u793a</li> <li> Info Tip Icon \u9ede\u64ca\u4e8b\u4ef6</li> <li> Helper Text \u6b63\u78ba\u986f\u793a (Loading/Error)</li> <li> \u908a\u6846\u984f\u8272\u6b63\u78ba (\u7da0\u8272 Focus/Typing, \u7d05\u8272 Error)</li> <li> Design Tokens \u6b63\u78ba\u5957\u7528</li> <li> \u66ff\u63db LoadCodeViewController \u5f8c\u529f\u80fd\u6b63\u5e38</li> <li> One-Time Tooltip \u9996\u6b21\u986f\u793a\u4e26\u6b63\u78ba\u5132\u5b58\u72c0\u614b (2025-01-12 \u65b0\u589e)</li> <li> Info Icon \u2192 GuideDialog \u9ede\u64ca\u5f48\u51fa\u8aaa\u660e Dialog (2025-01-12 \u65b0\u589e)</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/05_ui_replacement_strategy_01_09/#figma-node-id","title":"\ud83d\udd17 \u76f8\u95dc Figma Node ID","text":"\u72c0\u614b node-id Default <code>26769:88873</code> Focus <code>26769:88868</code> Typing <code>26769:88869</code> Filled <code>26769:88870</code> Loading <code>26769:88872</code> Error <code>26769:88871</code> <p>\u6b64\u6587\u4ef6\u6839\u64da 2025-01-09 Figma \u8a2d\u8a08\u66f4\u65b0</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/","title":"Code Converter Widget - UI Only Implementation Plan","text":"<p>\u6700\u5f8c\u66f4\u65b0: 2026-01-13</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_1","title":"\u6982\u8ff0","text":"<p>\u5c07 \"Load Booking Code\" \u529f\u80fd\u7d71\u4e00\u70ba\u65b0\u7684 \"Code Converter Widget\"\uff0c\u521d\u671f\u53ea\u66ff\u63db UI\uff0c\u4fdd\u7559\u65e2\u6709 API \u908f\u8f2f\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_2","title":"\u67b6\u69cb\u6c7a\u7b56","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#option-a-view","title":"Option A\uff08\u274c \u4e0d\u63a1\u7528\uff09\uff1a\u64f4\u5c55\u73fe\u6709 View","text":"<ul> <li>\u4fee\u6539 <code>LoadBookingCodeSectionView</code></li> <li>\u98a8\u96aa\uff1a\u5f71\u97ff\u73fe\u6709\u908f\u8f2f\uff0c\u96e3\u4ee5\u56de\u6efe</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#option-b-widget","title":"Option B\uff08\u2705 \u63a1\u7528\uff09\uff1a\u5efa\u7acb\u65b0\u7684 Widget","text":"<ul> <li>\u65b0\u5efa <code>CodeConverterWidget</code> \u8cc7\u6599\u593e</li> <li>Feature Flag \u63a7\u5236\u5207\u63db</li> <li>\u512a\u9ede\uff1a\u9694\u96e2\u98a8\u96aa\uff0c\u6613\u65bc A/B \u6e2c\u8a66</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_3","title":"\u6a94\u6848\u7d50\u69cb\u898f\u5283","text":"<pre><code>FCom/Home Tab/HomeListView/LoadBookingCode/\n\u251c\u2500\u2500 CodeConverterWidget/\n\u2502   \u251c\u2500\u2500 CodeConverterConfig.swift          # Feature Flag\n\u2502   \u251c\u2500\u2500 WidgetInputState.swift             # \u8f38\u5165\u72c0\u614b enum\n\u2502   \u251c\u2500\u2500 CodeConverterWidget+Feature.swift  # TCA State/Action/Reducer\n\u2502   \u251c\u2500\u2500 CodeConverterWidgetView.swift      # SwiftUI View\n\u2502   \u2514\u2500\u2500 CodeConverterTooltipStorage.swift  # Tooltip \u986f\u793a\u8a18\u9304\n\u2514\u2500\u2500 LoadBookingCodeSectionView.swift       # \u820a\u7248\uff08\u4fdd\u7559\uff09\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_4","title":"\u5be6\u4f5c\u6b65\u9a5f","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-0-feature-flag","title":"Step 0: Feature Flag \u2705","text":"<ul> <li>\u5efa\u7acb <code>CodeConverterConfig.swift</code></li> <li>\u4f7f\u7528 <code>@Persisted</code> \u5b58\u5132\u5230 UserDefaults</li> <li>DEBUG mode \u53ef\u5f37\u5236\u958b\u555f</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-1-widgetinputstate","title":"Step 1: WidgetInputState \u2705","text":"<ul> <li>\u5b9a\u7fa9\u8f38\u5165\u6846\u7684\u8996\u89ba\u72c0\u614b enum</li> <li>Cases: default, focus, typing, filled, loading, error</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-2-stateaction","title":"Step 2: State/Action \u5b9a\u7fa9 \u2705","text":"<ul> <li>\u5b9a\u7fa9 TCA State \u8207 Action</li> <li>\u6574\u5408\u5230 <code>CodeConverterWidget+Feature.swift</code></li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-3-reducer","title":"Step 3: Reducer \u5be6\u4f5c \u2705","text":"<ul> <li>\u8907\u7528 <code>LoadCodeManager</code> \u8655\u7406 API</li> <li>\u8655\u7406\u8f38\u5165\u3001\u63d0\u4ea4\u3001\u932f\u8aa4\u7b49 Action</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-4-view","title":"Step 4: View \u5be6\u4f5c \u2705","text":"<ul> <li>SwiftUI View \u5c0d\u61c9 Figma \u8a2d\u8a08</li> <li>\u5305\u542b TextField\u3001Import Button\u3001Info Icon\u3001Error Message</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-5-tooltip-storage","title":"Step 5: Tooltip Storage \u2705","text":"<ul> <li>\u4e00\u6b21\u6027 tooltip \u986f\u793a\u908f\u8f2f</li> <li>UserDefaults \u5132\u5b58\u5df2\u986f\u793a\u72c0\u614b</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-6-homelistview","title":"Step 6: HomeListView \u6574\u5408 \u2705","text":"<ul> <li>\u6839\u64da Feature Flag \u5207\u63db\u65b0\u820a UI</li> <li>Guide Dialog \u4f7f\u7528 FCDialog overlay</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-7-code-center","title":"Step 7: Code Center \u6574\u5408 \u2705","text":"<ul> <li>Dependency Injection \u6a21\u5f0f</li> <li>\u8fd4\u56de <code>CodeConverterWidgetViews</code> struct</li> <li>Dialog overlay \u52a0\u5728 CodeCenterContainerView \u6839\u5c64\u7d1a</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#tca-clean-architecture","title":"\u67b6\u69cb\u6c7a\u7b56\uff08TCA + Clean Architecture\uff09","text":"<pre><code>// \u2705 \u7b26\u5408 TCA\uff1a\u4f7f\u7528 Effect \u9694\u96e2 side effects\nReduce { state, action in\n    case .bookingCodeLoaded(let result):\n        return .run { _ in  // Side effects \u5728 Effect \u4e2d\n            await addSelectionsToBetslip(result)\n            await presentBetslipViewController()\n        }\n}\n</code></pre> <p>\u70ba\u4ec0\u9ebc\u7b26\u5408\u67b6\u69cb\uff1a 1. Single Source of Truth: State \u53ea\u5b58\u5728\u65bc Store 2. Unidirectional Data Flow: View \u2192 Action \u2192 Reducer \u2192 State \u2192 View 3. Pure Reducer: Reducer \u672c\u8eab\u662f\u7d14\u51fd\u6578\uff0cside effects \u5728 <code>.run</code> Effect \u4e2d 4. Dependency Injection: \u901a\u904e <code>CodeCenterDependencies</code> \u6ce8\u5165\uff0c\u6a21\u7d44\u9593\u89e3\u8026</p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-8-betslip","title":"Step 8: Betslip \u6574\u5408 \ud83d\udea7 \u9032\u884c\u4e2d","text":"<p>\u76ee\u6a19: \u66ff\u63db <code>BetslipViewController</code> \u4e2d\u7684 <code>LoadCodeViewController</code></p> <p>\u65b0\u5efa\u6a94\u6848: - <code>FCom/Betslip/Main/BetslipCodeConverterIntegration.swift</code></p> <p>\u4fee\u6539\u6a94\u6848: - <code>FCom/Betslip/Main/BetslipViewController.swift</code></p> <p>\u6574\u5408\u65b9\u5f0f: <pre><code>// BetslipCodeConverterConfig\nstruct BetslipCodeConverterConfig {\n    let onHeightChange: (CGFloat) -&gt; Void\n    let onBookingCodeLoaded: (LoadCodeModel.CodeResult) -&gt; Void\n    let onDismiss: () -&gt; Void\n}\n\n// \u5275\u5efa Views\nstatic func createViews(config: BetslipCodeConverterConfig) -&gt; BetslipCodeConverterViews\n</code></pre></p> <p>\u26a0\ufe0f \u91cd\u8981\u63d0\u9192\uff1a \u7576\u5f9e stash pop \u51fa Step 8 \u7684\u6539\u52d5\u5f8c\uff0c\u9700\u8981 \u624b\u52d5\u5728 Xcode \u4e2d\u52a0\u5165\u4ee5\u4e0b\u6a94\u6848\uff1a</p> <pre><code>FCom/Betslip/Main/BetslipCodeConverterIntegration.swift\n</code></pre> <p>\u6b65\u9a5f\uff1a 1. \u5728 Xcode \u4e2d\u627e\u5230 <code>FCom/Betslip/Main/</code> \u8cc7\u6599\u593e 2. \u53f3\u9375 \u2192 Add Files to \"FCom\"... 3. \u9078\u64c7 <code>BetslipCodeConverterIntegration.swift</code> 4. \u78ba\u4fdd Target \u52fe\u9078 FCom</p> <p>Stash \u547d\u4ee4: <pre><code># Pop stash\ngit stash pop \"stash@{0}\"\n\n# \u6216\u67e5\u770b stash list\ngit stash list\n</code></pre></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#step-9-deep-link","title":"Step 9: Deep Link \u6574\u5408\uff08\u5f85\u898f\u5283\uff09","text":"<p>\u76ee\u6a19: \u66ff\u63db <code>CurrentTabRouter</code> \u4e2d\u7684 <code>LoadCodeViewController</code></p>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#checklist","title":"\u9a57\u6536 Checklist","text":""},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#ui-states","title":"UI States","text":"<ul> <li> Default \u72c0\u614b</li> <li> Focus \u72c0\u614b\uff08\u85cd\u6846\uff09</li> <li> Typing \u72c0\u614b\uff08\u986f\u793a\u6e05\u9664\u6309\u9215\uff09</li> <li> Loading \u72c0\u614b\uff08Spinner\uff09</li> <li> Error \u72c0\u614b\uff08\u7d05\u6846 + \u932f\u8aa4\u8a0a\u606f\uff09</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#interactions","title":"Interactions","text":"<ul> <li> \u8f38\u5165\u904e\u6ffe\uff08\u53ea\u5141\u8a31\u82f1\u6578\uff09</li> <li> Import \u6309\u9215 enable/disable</li> <li> Clear \u6309\u9215\u529f\u80fd</li> <li> Info icon \u2192 Guide Dialog</li> <li> Tooltip \u4e00\u6b21\u6027\u986f\u793a</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#design","title":"Design","text":"<ul> <li> \u984f\u8272\u3001\u5b57\u9ad4\u3001\u9593\u8ddd\u5c0d\u61c9 Figma</li> <li> Dialog \u7f6e\u4e2d + \u80cc\u666f\u8499\u7248</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#feature-flag","title":"Feature Flag","text":"<ul> <li> \u958b\u555f\u6642\u986f\u793a\u65b0 UI</li> <li> \u95dc\u9589\u6642\u986f\u793a\u820a UI</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_5","title":"\u6ce8\u610f\u4e8b\u9805","text":"<ol> <li>LoadCodeManager \u8907\u7528: \u4e0d\u8981\u91cd\u65b0\u5be6\u4f5c API \u908f\u8f2f</li> <li>\u932f\u8aa4\u8655\u7406: \u4f7f\u7528 <code>manager.mapErrorToMessage(error)</code></li> <li>Guide Dialog: \u4f7f\u7528 <code>FCDialog</code>\uff0c\u4e0d\u662f <code>GuideDialogView</code></li> <li>Tooltip Overlay: \u9700\u8981 <code>.tooltipOverlay()</code> modifier</li> <li>\u4e0d\u8981\u522a\u9664\u820a\u6a94\u6848: <code>LoadBookingCodeSectionView</code> \u7b49\u4fdd\u7559</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_6","title":"\u98a8\u96aa\u8a55\u4f30","text":"\u98a8\u96aa \u7b49\u7d1a \u7de9\u89e3\u65b9\u6848 Feature Flag \u5931\u6548 \u4f4e \u9810\u8a2d false\uff0c\u6f38\u9032\u958b\u555f \u65b0\u820a UI \u884c\u70ba\u4e0d\u4e00\u81f4 \u4e2d \u8907\u7528 LoadCodeManager Xcode project \u885d\u7a81 \u4f4e \u624b\u52d5\u52a0\u5165\u6a94\u6848\u63d0\u9192"},{"location":"05_Module%20Sequence%20Diagram/LoadBookingCodeSection/06_ui_only_implementation_plan/#_7","title":"\u6642\u9593\u9810\u4f30","text":"<ul> <li>Step 0-6: \u2705 \u5df2\u5b8c\u6210</li> <li>Step 7: \u2705 \u5df2\u5b8c\u6210</li> <li>Step 8: \ud83d\udea7 \u9032\u884c\u4e2d\uff08stash \u72c0\u614b\uff09</li> <li>Step 9: \u23f3 \u5f85\u898f\u5283</li> </ul> <p>\u7e3d\u9810\u4f30: 4-4.5 \u5929</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/","title":"Module Sequence Diagrams - LoadBookingCodeSection","text":"<p>\u672c\u8cc7\u6599\u593e\u5305\u542b LoadBookingCodeSection Feature \u7684\u6a21\u7d44\u5e8f\u5217\u5716\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e Config API \u5ee2\u68c4 <code>01_data_initialization_load_provider_config.md</code> \u5df2\u5ee2\u68c4 Bookie Selection \u5ee2\u68c4 <code>03_data_interaction_bookie_selection.md</code> \u5df2\u5ee2\u68c4 Tooltip \u65b0\u589e <code>04_tooltip_display_logic.md</code> \u65b0\u589e"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u985e\u578b \u72c0\u614b \u8aaa\u660e 01_data_initialization_load_provider_config.md Data Initialization \u274c \u5ee2\u68c4 ~~\u8f09\u5165 Provider Config \u6d41\u7a0b~~ 02_data_interaction_convert_code.md Data Interaction \u2705 \u66f4\u65b0 Code2Code \u8f49\u63db\u6d41\u7a0b (\u7c21\u5316\u7248) 03_data_interaction_bookie_selection.md Data Interaction \u274c \u5ee2\u68c4 ~~Bookie \u9078\u64c7\u6d41\u7a0b~~ 04_tooltip_display_logic.md UI Logic \ud83c\udd95 \u65b0\u589e Tooltip \u986f\u793a\u908f\u8f2f"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/#_2","title":"\u7c21\u5316\u5f8c\u7684\u6d41\u7a0b","text":"<pre><code>\u820a\u6d41\u7a0b\uff08\u5df2\u5ee2\u68c4\uff09:\nUser \u2192 \u9078\u64c7 Bookie \u2192 \u8f38\u5165 Code \u2192 \u8f49\u63db\n\n\u65b0\u6d41\u7a0b:\nUser \u2192 (Tooltip \u9996\u6b21\u986f\u793a) \u2192 \u8f38\u5165 Code \u2192 \u8f49\u63db \u2192 \u539f\u6709 Load Code \u6d41\u7a0b\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/","title":"~~Module Sequence Diagram: Load Provider Config~~ \u274c \u5ee2\u68c4","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_1","title":"\u26a0\ufe0f \u6b64\u6587\u4ef6\u5df2\u5ee2\u68c4","text":"\u9805\u76ee \u8aaa\u660e \u5ee2\u68c4\u539f\u56e0 BE \u65b0\u8a2d\u8a08\u4e0d\u518d\u9700\u8981 Provider Config API \u5ee2\u68c4\u65e5\u671f 2025-01 \u66ff\u4ee3\u65b9\u6848 \u7121\u9700\u66ff\u4ee3\uff0c\u76f4\u63a5\u8f38\u5165 Booking Code \u5373\u53ef\u8f49\u63db"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_2","title":"\u5ee2\u68c4\u5167\u5bb9","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_3","title":"~~\u539f\u89f8\u767c\u6642\u6a5f~~","text":"<p>~~\u7528\u6236\u9ede\u64ca Bookie Dropdown \u6642\uff0c\u8f09\u5165 Provider Config \u4e26\u986f\u793a Bookie Selector Sheet\u3002~~</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#api","title":"~~\u539f API~~","text":"<pre><code>\u274c \u5ee2\u68c4: GET /orders/converter/config/providerCountries\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_4","title":"~~\u539f\u6d41\u7a0b~~","text":"<pre><code>\u274c \u5ee2\u68c4: \nUser \u2192 \u9ede\u64ca Bookie Dropdown \u2192 \u8f09\u5165 Config \u2192 \u958b\u555f Bookie Selector Sheet\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_5","title":"\u65b0\u6587\u4ef6\u4f4d\u7f6e","text":"<p>Tooltip \u76f8\u95dc\u908f\u8f2f\u8acb\u53c3\u8003\uff1a</p> <ul> <li>04_tooltip_display_logic.md</li> </ul>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/01_data_initialization_load_provider_config/#_6","title":"\u76f8\u95dc\u5ee2\u68c4\u9805\u76ee","text":"\u9805\u76ee \u985e\u578b <code>LoadProviderConfigUseCase</code> UseCase <code>ProviderConfig</code> Domain Model <code>ProviderCountryConfigDTO</code> DTO <code>BookieSelectorSheet</code> UI <code>BookieDropdownView</code> UI <code>.bookieDropdownTapped</code> Action <code>providerConfigs</code> State <code>isBookieSelectorPresented</code> State"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/","title":"Module Sequence Diagram: Convert Booking Code (Code2Code)","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#_1","title":"\u89f8\u767c\u6642\u6a5f","text":"<p>\u7528\u6236\u8f38\u5165 Booking Code \u5f8c\u9ede\u64ca Load \u6309\u9215\uff0c\u57f7\u884c Code2Code \u8f49\u63db\u6d41\u7a0b\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u820a\u7248 \u65b0\u7248 Request \u53c3\u6578 <code>{provider, country, bookingCode}</code> <code>{bookingCode}</code> \u53ea\u9700 bookingCode Provider/Country \u9700\u5148\u9078\u64c7 Bookie \u274c \u79fb\u9664 - BE \u81ea\u52d5\u8b58\u5225 \u5f8c\u7e8c\u6d41\u7a0b \u81ea\u884c\u8655\u7406 \u8d70\u539f\u6709 load code \u6d41\u7a0b"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#1-user-facing-sequence-diagram","title":"1\ufe0f\u20e3 User-Facing Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a\u5f9e\u7528\u6236\u8996\u89d2\u7684\u5b8c\u6574\u8f49\u63db\u6d41\u7a0b\uff0c\u5305\u542b Figma \u8a2d\u8a08\u5c0d\u61c9\u3002</p> <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Betslip as Betslip\n    end\n\n    participant BE as Backend\n\n    %% \u8f38\u5165 Booking Code\n    rect rgb(240, 255, 240)\n        note over User,Widget: \u8f38\u5165 Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.1 Focus\n        User-&gt;&gt;Widget: \u9ede\u64ca\u8f38\u5165\u6846\n        Widget-&gt;&gt;User: \u986f\u793a Focus \u72c0\u614b (\u7da0\u8272\u908a\u6846)\n        note over Widget: \ud83d\udcd0 Figma: 1.0.2 Typing\n        User-&gt;&gt;Widget: \u8f38\u5165\u4efb\u610f Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.4 Filled\n        Widget-&gt;&gt;User: \u986f\u793a Filled \u72c0\u614b (Load \u6309\u9215\u555f\u7528)\n    end\n\n    %% \u8f49\u63db\u6d41\u7a0b\n    rect rgb(255, 245, 238)\n        note over User,BE: \u8f49\u63db\u6d41\u7a0b\n        User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n        note over Widget: \ud83d\udcd0 Figma: 1.0.5 Loading\n        Widget-&gt;&gt;User: \u986f\u793a Loading \u72c0\u614b\n        note right of Widget: \"Conversion may take up to 10 seconds...\"\n\n        Widget-&gt;&gt;BE: POST /orders/converter/code\n        note over Widget,BE: Request: {bookingCode}\n\n        alt Convert API Success\n            BE--&gt;&gt;Widget: {bizCode: 10000, data: {shareCode, successCnt, failCnt}}\n            note over Widget: \u8a18\u9304 failCnt \u7528\u65bc\u5f8c\u7e8c Toast \u986f\u793a\n\n            %% Check Liabilities [\u539f\u6709\u6d41\u7a0b]\n            note over Widget,BE: Check Liabilities [\u539f\u6709 Load Code \u6d41\u7a0b]\n            Widget-&gt;&gt;BE: GET /bookingCode/[shareCode]/liabilities\n\n            alt Liabilities API Success\n                BE--&gt;&gt;Widget: {isTrusted: true/false}\n\n                %% Get Betslip Data [\u539f\u6709\u6d41\u7a0b]\n                note over Widget,BE: Get Betslip Data [\u539f\u6709 Load Code \u6d41\u7a0b]\n                Widget-&gt;&gt;BE: GET /orders/share/[shareCode]\n\n                alt Share API Success\n                    BE--&gt;&gt;Widget: {betslipData: selections}\n\n                    %% \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget,Betslip: \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget: \ud83d\udcd0 Figma: 1.0.8 Success\n                    Widget-&gt;&gt;Betslip: Pop up Betslip (\u8f09\u5165 selections)\n                    note over Betslip: \ud83d\udcd0 Figma: Betslip Success\n                    Betslip-&gt;&gt;User: \u986f\u793a Betslip\n\n                    opt failCnt &gt; 0 (\u90e8\u5206\u8f49\u63db\u5931\u6557)\n                        note over Betslip: \ud83d\udcd0 Figma: Betslip Partial\n                        Betslip-&gt;&gt;User: \u986f\u793a Toast \"\u26a0 X selections failed to convert\"\n                    end\n\n                else Share API Failure\n                    BE--&gt;&gt;Widget: error response\n                    Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n                end\n\n            else Liabilities API Failure\n                BE--&gt;&gt;Widget: error response\n                Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n            end\n\n        else Convert API Error\n            note over Widget: \ud83d\udcd0 Figma: 1.0.6 Error\n            BE--&gt;&gt;Widget: error response\n            Widget-&gt;&gt;User: \u986f\u793a Error \u72c0\u614b (Stop)\n        end\n    end</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Betslip as Betslip\n    end\n\n    participant BE as Backend\n\n    %% \u8f38\u5165 Booking Code\n    rect rgb(240, 255, 240)\n        note over User,Widget: \u8f38\u5165 Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.1 Focus\n        User-&gt;&gt;Widget: \u9ede\u64ca\u8f38\u5165\u6846\n        Widget-&gt;&gt;User: \u986f\u793a Focus \u72c0\u614b (\u7da0\u8272\u908a\u6846)\n        note over Widget: \ud83d\udcd0 Figma: 1.0.2 Typing\n        User-&gt;&gt;Widget: \u8f38\u5165\u4efb\u610f Booking Code\n        note over Widget: \ud83d\udcd0 Figma: 1.0.4 Filled\n        Widget-&gt;&gt;User: \u986f\u793a Filled \u72c0\u614b (Load \u6309\u9215\u555f\u7528)\n    end\n\n    %% \u8f49\u63db\u6d41\u7a0b\n    rect rgb(255, 245, 238)\n        note over User,BE: \u8f49\u63db\u6d41\u7a0b\n        User-&gt;&gt;Widget: \u9ede\u64ca Load \u6309\u9215\n        note over Widget: \ud83d\udcd0 Figma: 1.0.5 Loading\n        Widget-&gt;&gt;User: \u986f\u793a Loading \u72c0\u614b\n        note right of Widget: \"Conversion may take up to 10 seconds...\"\n\n        Widget-&gt;&gt;BE: POST /orders/converter/code\n        note over Widget,BE: Request: {bookingCode}\n\n        alt Convert API Success\n            BE--&gt;&gt;Widget: {bizCode: 10000, data: {shareCode, successCnt, failCnt}}\n            note over Widget: \u8a18\u9304 failCnt \u7528\u65bc\u5f8c\u7e8c Toast \u986f\u793a\n\n            %% Check Liabilities [\u539f\u6709\u6d41\u7a0b]\n            note over Widget,BE: Check Liabilities [\u539f\u6709 Load Code \u6d41\u7a0b]\n            Widget-&gt;&gt;BE: GET /bookingCode/[shareCode]/liabilities\n\n            alt Liabilities API Success\n                BE--&gt;&gt;Widget: {isTrusted: true/false}\n\n                %% Get Betslip Data [\u539f\u6709\u6d41\u7a0b]\n                note over Widget,BE: Get Betslip Data [\u539f\u6709 Load Code \u6d41\u7a0b]\n                Widget-&gt;&gt;BE: GET /orders/share/[shareCode]\n\n                alt Share API Success\n                    BE--&gt;&gt;Widget: {betslipData: selections}\n\n                    %% \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget,Betslip: \u5f48\u51fa Betslip \u4e26\u4e14\u986f\u793a\u8f49\u63db\u7d50\u679c\n                    note over Widget: \ud83d\udcd0 Figma: 1.0.8 Success\n                    Widget-&gt;&gt;Betslip: Pop up Betslip (\u8f09\u5165 selections)\n                    note over Betslip: \ud83d\udcd0 Figma: Betslip Success\n                    Betslip-&gt;&gt;User: \u986f\u793a Betslip\n\n                    opt failCnt &gt; 0 (\u90e8\u5206\u8f49\u63db\u5931\u6557)\n                        note over Betslip: \ud83d\udcd0 Figma: Betslip Partial\n                        Betslip-&gt;&gt;User: \u986f\u793a Toast \"\u26a0 X selections failed to convert\"\n                    end\n\n                else Share API Failure\n                    BE--&gt;&gt;Widget: error response\n                    Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n                end\n\n            else Liabilities API Failure\n                BE--&gt;&gt;Widget: error response\n                Widget-&gt;&gt;User: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI (Stop)\n            end\n\n        else Convert API Error\n            note over Widget: \ud83d\udcd0 Figma: 1.0.6 Error\n            BE--&gt;&gt;Widget: error response\n            Widget-&gt;&gt;User: \u986f\u793a Error \u72c0\u614b (Stop)\n        end\n    end\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#figma-frame","title":"Figma Frame \u5c0d\u61c9\u8868","text":"\u6d41\u7a0b\u968e\u6bb5 Figma Frame Node ID Widget \u72c0\u614b \u8f38\u5165\u6846\u805a\u7126 1.0.1 <code>26769:88868</code> Focus \u6b63\u5728\u8f38\u5165 1.0.2 - Typing \u8f38\u5165\u5b8c\u6210 1.0.4 <code>26453:93265</code> Filled \u8f49\u63db\u4e2d 1.0.5 - Loading \u8f49\u63db\u5931\u6557 1.0.6 - Error \u8f49\u63db\u6210\u529f 1.0.8 <code>26453:93267</code> \u2192 Betslip Betslip \u6210\u529f - <code>26428:71768</code> failCnt == 0 Betslip \u90e8\u5206\u6210\u529f - <code>26428:71769</code> failCnt &gt; 0"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#api","title":"API \u8abf\u7528\u9806\u5e8f","text":"\u9806\u5e8f API Method Figma \u72c0\u614b \u5931\u6557\u8655\u7406 1 <code>/orders/converter/code</code> <code>POST</code> 1.0.5 Loading 1.0.6 Error 2 <code>/bookingCode/[shareCode]/liabilities</code> <code>GET</code> [\u539f\u6709\u6d41\u7a0b] Betslip \u65e2\u6709\u932f\u8aa4 UI 3 <code>/orders/share/[shareCode]</code> <code>GET</code> [\u539f\u6709\u6d41\u7a0b] Betslip \u65e2\u6709\u932f\u8aa4 UI"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#2-codebase-level-sequence-diagram","title":"2\ufe0f\u20e3 Codebase-Level Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a Clean Architecture \u5404\u5c64\u4e4b\u9593\u7684\u547c\u53eb\u95dc\u4fc2\u3002</p> <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n    participant CCClient as CodeConverterClient\n    participant ConvertAPI as POST /orders/converter/code\n    participant BSRepo as BetslipRepository (\u65e2\u6709)\n    participant BSClient as BetslipClient (\u65e2\u6709)\n    participant LiabAPI as GET /bookingCode/{shareCode}/liabilities\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Note over Feature: \u6aa2\u67e5 enableCodeConverter&lt;br/&gt;+ \u8f38\u5165\u7684 Code\n\n    Feature-&gt;&gt;Feature: state.inputState = .loading\n    Feature-&gt;&gt;Feature: state.isLoading = true\n\n    Feature-&gt;&gt;UC: execute(input)\n    Note right of Feature: input = ConvertBookingCodeInput(bookingCode)\n\n    %% Step 1: Code2Code \u8f49\u63db\n    UC-&gt;&gt;CCRepo: convertCode(bookingCode)\n    CCRepo-&gt;&gt;CCClient: postConvertCode(request)\n    CCClient-&gt;&gt;ConvertAPI: POST request {bookingCode}\n    ConvertAPI--&gt;&gt;CCClient: 200 OK with CodeConverterResponseDTO\n    CCClient--&gt;&gt;CCRepo: CodeConverterResponseDTO\n    Note over CCRepo: DTO \u2192 Domain Model\n    CCRepo--&gt;&gt;UC: ConvertResult\n\n    %% Step 2: Liabilities \u6aa2\u67e5 (\u4f7f\u7528 shareCode) - \u539f\u6709\u6d41\u7a0b\n    UC-&gt;&gt;BSRepo: checkLiabilities(shareCode)\n    BSRepo-&gt;&gt;BSClient: fetchLiabilities(shareCode)\n    BSClient-&gt;&gt;LiabAPI: GET /bookingCode/{shareCode}/liabilities\n    LiabAPI--&gt;&gt;BSClient: 200 OK\n    BSClient--&gt;&gt;BSRepo: LiabilitiesDTO\n    BSRepo--&gt;&gt;UC: LiabilitiesResult\n\n    %% Step 3: \u56de\u50b3\u7d50\u679c\n    UC--&gt;&gt;Feature: .success(ConvertBookingCodeOutput)\n\n    Feature-&gt;&gt;Feature: state.isLoading = false\n    Feature-&gt;&gt;Feature: state.inputState = .filled\n    Feature-&gt;&gt;Feature: state.bookingCode = \"\"\n    Feature-&gt;&gt;Feature: state.convertResult = output.convertResult\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt)\n\n    Note over UI: \u5c0e\u822a\u81f3 Betslip Page</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n    participant CCClient as CodeConverterClient\n    participant ConvertAPI as POST /orders/converter/code\n    participant BSRepo as BetslipRepository (\u65e2\u6709)\n    participant BSClient as BetslipClient (\u65e2\u6709)\n    participant LiabAPI as GET /bookingCode/{shareCode}/liabilities\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Note over Feature: \u6aa2\u67e5 enableCodeConverter&lt;br/&gt;+ \u8f38\u5165\u7684 Code\n\n    Feature-&gt;&gt;Feature: state.inputState = .loading\n    Feature-&gt;&gt;Feature: state.isLoading = true\n\n    Feature-&gt;&gt;UC: execute(input)\n    Note right of Feature: input = ConvertBookingCodeInput(bookingCode)\n\n    %% Step 1: Code2Code \u8f49\u63db\n    UC-&gt;&gt;CCRepo: convertCode(bookingCode)\n    CCRepo-&gt;&gt;CCClient: postConvertCode(request)\n    CCClient-&gt;&gt;ConvertAPI: POST request {bookingCode}\n    ConvertAPI--&gt;&gt;CCClient: 200 OK with CodeConverterResponseDTO\n    CCClient--&gt;&gt;CCRepo: CodeConverterResponseDTO\n    Note over CCRepo: DTO \u2192 Domain Model\n    CCRepo--&gt;&gt;UC: ConvertResult\n\n    %% Step 2: Liabilities \u6aa2\u67e5 (\u4f7f\u7528 shareCode) - \u539f\u6709\u6d41\u7a0b\n    UC-&gt;&gt;BSRepo: checkLiabilities(shareCode)\n    BSRepo-&gt;&gt;BSClient: fetchLiabilities(shareCode)\n    BSClient-&gt;&gt;LiabAPI: GET /bookingCode/{shareCode}/liabilities\n    LiabAPI--&gt;&gt;BSClient: 200 OK\n    BSClient--&gt;&gt;BSRepo: LiabilitiesDTO\n    BSRepo--&gt;&gt;UC: LiabilitiesResult\n\n    %% Step 3: \u56de\u50b3\u7d50\u679c\n    UC--&gt;&gt;Feature: .success(ConvertBookingCodeOutput)\n\n    Feature-&gt;&gt;Feature: state.isLoading = false\n    Feature-&gt;&gt;Feature: state.inputState = .filled\n    Feature-&gt;&gt;Feature: state.bookingCode = \"\"\n    Feature-&gt;&gt;Feature: state.convertResult = output.convertResult\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt)\n\n    Note over UI: \u5c0e\u822a\u81f3 Betslip Page\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#api-requestresponse","title":"API Request/Response","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#convert-code-request","title":"Convert Code Request","text":"<pre><code>POST /orders/converter/code\nContent-Type: application/json\nAuthorization: Bearer {token}\n\n{\n  \"bookingCode\": \"3RA3FA\"\n}\n</code></pre> <p>\u26a0\ufe0f \u6ce8\u610f: <code>provider</code> \u548c <code>country</code> \u53c3\u6578\u5df2\u79fb\u9664\uff0cBE \u6703\u81ea\u52d5\u8b58\u5225\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#convert-code-response-200-ok","title":"Convert Code Response (200 OK)","text":"<pre><code>{\n  \"bizCode\": 10000,\n  \"message\": \"success\",\n  \"data\": {\n    \"shareCode\": \"FCOM123ABC\",\n    \"successCnt\": 3,\n    \"failCnt\": 1\n  }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#partial-failure","title":"Partial Failure \u6d41\u7a0b","text":"<p>\u7576\u90e8\u5206 selections \u8f49\u63db\u5931\u6557\u6642 (<code>failCnt &gt; 0</code>)\uff1a</p> <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant Betslip as BetslipPage\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt: 2)\n\n    Note over UI: failCnt &gt; 0\uff0c\u986f\u793a Partial Error Toast\n\n    UI-&gt;&gt;UI: \u986f\u793a \"2 selections failed to convert\" Toast\n\n    UI-&gt;&gt;Betslip: \u5c0e\u822a\u81f3 Betslip\uff08\u50c5\u8f09\u5165\u6210\u529f\u7684 selections\uff09</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#error-handling","title":"Error Handling","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#1-code-not-found-cc002","title":"1. Code Not Found (CC002)","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n    participant CCRepo as CodeConverterRepository\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Feature-&gt;&gt;UC: execute(input)\n\n    UC-&gt;&gt;CCRepo: convertCode(bookingCode)\n    CCRepo--&gt;&gt;UC: throw CodeConverterError.codeNotFound\n\n    UC--&gt;&gt;Feature: .failure(CodeConverterError.codeNotFound)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"We couldn't find this booking code. Please check and try again.\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u986f\u793a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#2-all-selections-failed-cc003","title":"2. All Selections Failed (CC003)","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n\n    Note over Feature: convertResult.isAllFailed == true\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"All selections failed to convert\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u986f\u793a\u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f&lt;br/&gt;\u4e0d\u5c0e\u822a\u81f3 Betslip</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#3-network-error","title":"3. Network Error","text":"<pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant UC as ConvertBookingCodeUseCase\n\n    UI-&gt;&gt;Feature: .loadBookingCode\n\n    Feature-&gt;&gt;UC: execute(input)\n\n    UC--&gt;&gt;Feature: .failure(NetworkError)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"Network error. Please try again.\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#state","title":"State \u8b8a\u66f4\u5c0d\u7167","text":"\u968e\u6bb5 inputState isLoading bookingCode errorMessage \u9ede\u64ca Load <code>.loading</code> <code>true</code> \"3RA3FA\" <code>nil</code> \u6210\u529f <code>.filled</code> <code>false</code> <code>\"\"</code> <code>nil</code> \u5931\u6557 <code>.error(msg)</code> <code>false</code> \"3RA3FA\" \"We couldn't...\""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#code","title":"Code \u5be6\u4f5c\u53c3\u8003","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#usecase","title":"UseCase","text":"<pre><code>struct ConvertBookingCodeUseCase {\n    @Dependency(\\.codeConverterRepository) var codeConverterRepo\n    @Dependency(\\.betslipRepository) var betslipRepo  // \u65e2\u6709\n\n    func execute(_ input: ConvertBookingCodeInput) async -&gt; Result&lt;ConvertBookingCodeOutput, Error&gt; {\n        do {\n            // Step 1: Code2Code \u8f49\u63db\uff08\u53ea\u9700 bookingCode\uff09\n            let convertResult = try await codeConverterRepo.convertCode(\n                bookingCode: input.bookingCode\n            )\n\n            // \u6aa2\u67e5\u662f\u5426\u5168\u90e8\u5931\u6557\n            guard !convertResult.isAllFailed else {\n                throw CodeConverterError.allSelectionsFailed\n            }\n\n            // Step 2: Liabilities \u6aa2\u67e5\uff08\u4f7f\u7528\u8fd4\u56de\u7684 shareCode\uff09- \u539f\u6709\u6d41\u7a0b\n            let liabilities = try await betslipRepo.checkLiabilities(\n                shareCode: convertResult.shareCode\n            )\n\n            return .success(ConvertBookingCodeOutput(\n                convertResult: convertResult,\n                liabilities: liabilities\n            ))\n        } catch {\n            return .failure(error)\n        }\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#inputoutput-model","title":"Input/Output Model","text":"<pre><code>struct ConvertBookingCodeInput {\n    let bookingCode: String\n\n    // \u5df2\u79fb\u9664\n    // let provider: String\n    // let country: String\n}\n\nstruct ConvertBookingCodeOutput: Equatable {\n    let convertResult: ConvertResult\n    let liabilities: LiabilitiesResult\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/02_data_interaction_convert_code/#_2","title":"\u5ee2\u68c4\u9805\u76ee","text":"\u9805\u76ee \u8aaa\u660e <code>provider</code> \u53c3\u6578 \u4e0d\u518d\u9700\u8981\u50b3\u905e <code>country</code> \u53c3\u6578 \u4e0d\u518d\u9700\u8981\u50b3\u905e <code>selectedBookie</code> \u6aa2\u67e5 \u4e0d\u518d\u9700\u8981"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/","title":"~~Module Sequence Diagram: Bookie Selection~~ \u274c \u5ee2\u68c4","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_1","title":"\u26a0\ufe0f \u6b64\u6587\u4ef6\u5df2\u5ee2\u68c4","text":"\u9805\u76ee \u8aaa\u660e \u5ee2\u68c4\u539f\u56e0 BE \u65b0\u8a2d\u8a08\u4e0d\u518d\u9700\u8981\u9078\u64c7 Provider/Country \u5ee2\u68c4\u65e5\u671f 2025-01 \u66ff\u4ee3\u65b9\u6848 \u7121\u9700\u66ff\u4ee3\uff0c\u76f4\u63a5\u8f38\u5165\u4efb\u610f Booking Code \u5373\u53ef\u8f49\u63db"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_2","title":"\u5ee2\u68c4\u5167\u5bb9","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_3","title":"~~\u539f\u60c5\u5883\u8aaa\u660e~~","text":"<p>~~\u7576\u7528\u6236\u5f9e Bookie Selector Sheet \u9078\u64c7 Bookie \u6642\uff0c\u6709\u4e09\u7a2e\u60c5\u6cc1\uff1a~~</p> <ol> <li>~~ALL \u570b\u5bb6 Provider\uff1a\u5982 Fcom\uff0cCountry \u9810\u8a2d\u70ba ALL\uff0c\u7121\u9700\u9078\u64c7~~</li> <li>~~\u55ae\u4e00\u570b\u5bb6 Bookie\uff1a\u5982 Bet9ja\uff0cCountry \u81ea\u52d5\u9078\u5b9a\uff0c\u7121\u9700\u9078\u64c7~~</li> <li>~~\u591a\u570b\u5bb6 Bookie\uff1a\u5982 MSport\uff0c\u9700\u8981\u5148\u9078\u64c7 Country~~</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_4","title":"~~\u539f\u6d41\u7a0b~~","text":"<pre><code>\u274c \u5ee2\u68c4:\nUser \u2192 \u9ede\u64ca Bookie Dropdown \u2192 \u8f09\u5165 Config \u2192 \u958b\u555f Sheet \u2192 \u9078\u64c7 Provider \u2192 \u9078\u64c7 Country \u2192 Submit\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_5","title":"\u65b0\u6d41\u7a0b","text":"<pre><code>\u2705 \u65b0\u6d41\u7a0b:\nUser \u2192 \u8f38\u5165\u4efb\u610f Booking Code \u2192 \u9ede\u64ca Load \u2192 BE \u81ea\u52d5\u8b58\u5225 Provider/Country\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_6","title":"\u76f8\u95dc\u5ee2\u68c4\u9805\u76ee","text":"\u9805\u76ee \u985e\u578b <code>BookieSelectorSheet</code> UI <code>BookieDropdownView</code> UI <code>CountryListView</code> UI <code>.bookieSelected</code> Action <code>.bookieSelectorDismissed</code> Action <code>.bookieDropdownTapped</code> Action <code>selectedBookie</code> State <code>isBookieSelectorPresented</code> State <code>providerConfigs</code> State <code>SelectedBookie</code> Domain Model <code>ProviderConfig</code> Domain Model <code>GET /orders/converter/config/providerCountries</code> API"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#_7","title":"\u5c0d\u958b\u767c\u7684\u5f71\u97ff","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#ui","title":"\u79fb\u9664\u7684 UI \u5143\u4ef6","text":"<ol> <li>\u274c <code>BookieSelectorSheet</code> - \u4e0d\u9700\u8981\u5be6\u4f5c</li> <li>\u274c <code>BookieDropdownView</code> - \u4e0d\u9700\u8981\u64f4\u5c55 <code>CountryDropdownView</code></li> <li>\u274c Provider/Country \u9078\u64c7\u908f\u8f2f - \u5168\u90e8\u79fb\u9664</li> </ol>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#state","title":"\u7c21\u5316\u7684 State","text":"<pre><code>// \u820a\u7248 State\uff08\u5df2\u5ee2\u68c4\uff09\nstruct State {\n    var selectedBookie: SelectedBookie?           // \u274c \u79fb\u9664\n    var providerConfigs: [ProviderConfig] = []    // \u274c \u79fb\u9664\n    var isBookieSelectorPresented: Bool = false   // \u274c \u79fb\u9664\n}\n\n// \u65b0\u7248 State\nstruct State {\n    var bookingCode: String = \"\"\n    var inputState: WidgetInputState = .default\n    var isTooltipVisible: Bool = false  // \u65b0\u589e\n    // ... \u5176\u4ed6\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/03_data_interaction_bookie_selection/#action","title":"\u7c21\u5316\u7684 Action","text":"<pre><code>// \u820a\u7248 Action\uff08\u5df2\u5ee2\u68c4\uff09\nenum Action {\n    case bookieDropdownTapped      // \u274c \u79fb\u9664\n    case bookieSelectorDismissed   // \u274c \u79fb\u9664\n    case bookieSelected(...)       // \u274c \u79fb\u9664\n    case providerConfigLoaded(...) // \u274c \u79fb\u9664\n}\n\n// \u65b0\u7248 Action\nenum Action {\n    case bookingCodeChanged(String)\n    case loadBookingCode\n    case tooltipDismissed  // \u65b0\u589e\n    // ... \u5176\u4ed6\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/","title":"Module Sequence Diagram: Tooltip Display Logic","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#_1","title":"\u89f8\u767c\u6642\u6a5f","text":"<p>Load Code Widget \u51fa\u73fe\u6642\uff0c\u6aa2\u67e5\u662f\u5426\u9700\u8981\u986f\u793a\u5f15\u5c0e Tooltip\u3002</p>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#1-user-facing-sequence-diagram","title":"1\ufe0f\u20e3 User-Facing Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a\u5f9e\u7528\u6236\u8996\u89d2\u7684 Tooltip \u986f\u793a\u6d41\u7a0b\u3002</p> <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Tooltip as Tooltip View\n    end\n\n    participant Storage as Device Storage\n\n    %% Widget \u51fa\u73fe\n    rect rgb(255, 250, 240)\n        note over User,Storage: Tooltip \u986f\u793a\u908f\u8f2f\n        note over Widget: \ud83d\udcd0 Figma: 1.0.0 Homepage Load Code Tooltip\n\n        Widget-&gt;&gt;Storage: \u6aa2\u67e5 Device ID \u662f\u5426\u5df2\u95dc\u9589 Tooltip\n\n        alt \u9996\u6b21\u4f7f\u7528\uff08\u672a\u95dc\u9589\u904e\uff09\n            Storage--&gt;&gt;Widget: shouldShowTooltip = true\n            Widget-&gt;&gt;Tooltip: \u986f\u793a Tooltip\n            note over Tooltip: \ud83d\udca1 \"Insert a booking code from any provider\"\n\n            User-&gt;&gt;Tooltip: \u9ede\u64ca\u95dc\u9589\u6309\u9215 (\u2715)\n            Tooltip-&gt;&gt;Storage: \u5132\u5b58 Device ID\uff08\u6a19\u8a18\u5df2\u95dc\u9589\uff09\n            Tooltip--&gt;&gt;Widget: \u96b1\u85cf Tooltip\n            note over Widget: Tooltip \u4e0d\u518d\u986f\u793a\n\n        else \u5df2\u95dc\u9589\u904e\n            Storage--&gt;&gt;Widget: shouldShowTooltip = false\n            note over Widget: \u4e0d\u986f\u793a Tooltip\n        end\n    end</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    actor User\n\n    box rgb(173, 216, 230) App\n        participant Widget as Load Code Widget\n        participant Tooltip as Tooltip View\n    end\n\n    participant Storage as Device Storage\n\n    %% Widget \u51fa\u73fe\n    rect rgb(255, 250, 240)\n        note over User,Storage: Tooltip \u986f\u793a\u908f\u8f2f\n        note over Widget: \ud83d\udcd0 Figma: 1.0.0 Homepage Load Code Tooltip\n\n        Widget-&gt;&gt;Storage: \u6aa2\u67e5 Device ID \u662f\u5426\u5df2\u95dc\u9589 Tooltip\n\n        alt \u9996\u6b21\u4f7f\u7528\uff08\u672a\u95dc\u9589\u904e\uff09\n            Storage--&gt;&gt;Widget: shouldShowTooltip = true\n            Widget-&gt;&gt;Tooltip: \u986f\u793a Tooltip\n            note over Tooltip: \ud83d\udca1 \"Insert a booking code from any provider\"\n\n            User-&gt;&gt;Tooltip: \u9ede\u64ca\u95dc\u9589\u6309\u9215 (\u2715)\n            Tooltip-&gt;&gt;Storage: \u5132\u5b58 Device ID\uff08\u6a19\u8a18\u5df2\u95dc\u9589\uff09\n            Tooltip--&gt;&gt;Widget: \u96b1\u85cf Tooltip\n            note over Widget: Tooltip \u4e0d\u518d\u986f\u793a\n\n        else \u5df2\u95dc\u9589\u904e\n            Storage--&gt;&gt;Widget: shouldShowTooltip = false\n            note over Widget: \u4e0d\u986f\u793a Tooltip\n        end\n    end\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#figma-frame","title":"Figma Frame \u5c0d\u61c9\u8868","text":"\u6d41\u7a0b\u968e\u6bb5 Figma Frame Node ID Tooltip \u986f\u793a 1.0.0 <code>Homepage Load Code Tooltip</code>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#2-codebase-level-sequence-diagram","title":"2\ufe0f\u20e3 Codebase-Level Sequence Diagram","text":"<p>\u6b64\u5716\u5c55\u793a Clean Architecture \u5404\u5c64\u4e4b\u9593\u7684\u547c\u53eb\u95dc\u4fc2\u3002</p> <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant Storage as TooltipStorage\n    participant UserDefaults as UserDefaults\n\n    UI-&gt;&gt;Feature: .onAppear\n\n    Feature-&gt;&gt;Storage: shouldShowTooltip\n    Storage-&gt;&gt;UserDefaults: bool(forKey: \"CodeConverter.TooltipDismissed\")\n\n    alt \u672a\u95dc\u9589\u904e\n        UserDefaults--&gt;&gt;Storage: false\n        Storage--&gt;&gt;Feature: shouldShowTooltip = true\n        Feature-&gt;&gt;Feature: state.isTooltipVisible = true\n        Feature--&gt;&gt;UI: State \u66f4\u65b0\n        UI-&gt;&gt;UI: \u986f\u793a TooltipView\n\n        Note over UI: \u7528\u6236\u9ede\u64ca\u95dc\u9589\n        UI-&gt;&gt;Feature: .tooltipDismissed\n        Feature-&gt;&gt;Storage: dismissTooltip()\n        Storage-&gt;&gt;UserDefaults: set(true, forKey: \"CodeConverter.TooltipDismissed\")\n        Feature-&gt;&gt;Feature: state.isTooltipVisible = false\n        Feature--&gt;&gt;UI: State \u66f4\u65b0\n        UI-&gt;&gt;UI: \u96b1\u85cf TooltipView\n\n    else \u5df2\u95dc\u9589\u904e\n        UserDefaults--&gt;&gt;Storage: true\n        Storage--&gt;&gt;Feature: shouldShowTooltip = false\n        Feature-&gt;&gt;Feature: state.isTooltipVisible = false\n        Feature--&gt;&gt;UI: State \u66f4\u65b0\n        Note over UI: \u4e0d\u986f\u793a TooltipView\n    end</code></pre> \ud83d\udcdd Mermaid \u8a9e\u6cd5 <pre><code>sequenceDiagram\n    participant UI as LoadCodeWidgetView\n    participant Feature as LoadCodeWidget.Feature\n    participant Storage as TooltipStorage\n    participant UserDefaults as UserDefaults\n\n    UI-&gt;&gt;Feature: .onAppear\n\n    Feature-&gt;&gt;Storage: shouldShowTooltip\n    Storage-&gt;&gt;UserDefaults: bool(forKey: \"CodeConverter.TooltipDismissed\")\n\n    alt \u672a\u95dc\u9589\u904e\n        UserDefaults--&gt;&gt;Storage: false\n        Storage--&gt;&gt;Feature: shouldShowTooltip = true\n        Feature-&gt;&gt;Feature: state.isTooltipVisible = true\n        Feature--&gt;&gt;UI: State \u66f4\u65b0\n        UI-&gt;&gt;UI: \u986f\u793a TooltipView\n\n        Note over UI: \u7528\u6236\u9ede\u64ca\u95dc\u9589\n        UI-&gt;&gt;Feature: .tooltipDismissed\n        Feature-&gt;&gt;Storage: dismissTooltip()\n        Storage-&gt;&gt;UserDefaults: set(true, forKey: \"CodeConverter.TooltipDismissed\")\n        Feature-&gt;&gt;Feature: state.isTooltipVisible = false\n        Feature--&gt;&gt;UI: State \u66f4\u65b0\n        UI-&gt;&gt;UI: \u96b1\u85cf TooltipView\n\n    else \u5df2\u95dc\u9589\u904e\n        UserDefaults--&gt;&gt;Storage: true\n        Storage--&gt;&gt;Feature: shouldShowTooltip = false\n        Feature-&gt;&gt;Feature: state.isTooltipVisible = false\n        Feature--&gt;&gt;UI: State \u66f4\u65b0\n        Note over UI: \u4e0d\u986f\u793a TooltipView\n    end\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#tooltip","title":"Tooltip \u884c\u70ba\u898f\u683c","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#_2","title":"\u986f\u793a\u898f\u5247","text":"\u9805\u76ee \u8aaa\u660e \u986f\u793a\u689d\u4ef6 \u529f\u80fd\u4e0a\u7dda\u5f8c\u9996\u6b21\u4f7f\u7528\uff0c\u4e14\u672a\u95dc\u9589\u904e \u986f\u793a\u4f4d\u7f6e Load Code Widget \u8f38\u5165\u6846\u4e0a\u65b9 \u8de8\u5165\u53e3\u540c\u6b65 \u4efb\u4e00\u5165\u53e3\u95dc\u9589\u5f8c\uff0c\u6240\u6709\u5165\u53e3\u7686\u4e0d\u518d\u986f\u793a"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#_3","title":"\u5132\u5b58\u6a5f\u5236","text":"\u9805\u76ee \u8aaa\u660e \u5132\u5b58\u4f4d\u7f6e UserDefaults (App Sandbox) Key <code>CodeConverter.TooltipDismissed</code> Value <code>Bool</code> (true = \u5df2\u95dc\u9589) \u8de8\u88dd\u7f6e\u540c\u6b65 \u4e0d\u540c\u6b65\uff08\u6bcf\u500b Device \u7368\u7acb\uff09 \u91cd\u88dd App \u6703\u91cd\u7f6e\uff08\u9996\u6b21\u5b89\u88dd\u986f\u793a Tooltip\uff09"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#_4","title":"\u5165\u53e3\u9ede\u5217\u8868","text":"\u5165\u53e3 \u8aaa\u660e \u9996\u9801 Widget Homepage \u7684 Load Code Section Code Center Load Code Tab Betslip Empty \u7a7a Betslip \u72c0\u614b"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#state","title":"State \u8b8a\u66f4","text":"Before After <code>isTooltipVisible = ?</code> <code>isTooltipVisible = !storage.isDismissed</code>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#code","title":"Code \u5be6\u4f5c\u53c3\u8003","text":""},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#tooltipstorage","title":"TooltipStorage","text":"<pre><code>struct TooltipStorage {\n    private let userDefaults: UserDefaults\n    private let key = \"CodeConverter.TooltipDismissed\"\n\n    init(userDefaults: UserDefaults = .standard) {\n        self.userDefaults = userDefaults\n    }\n\n    var shouldShowTooltip: Bool {\n        !userDefaults.bool(forKey: key)\n    }\n\n    func dismissTooltip() {\n        userDefaults.set(true, forKey: key)\n    }\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#state_1","title":"State","text":"<pre><code>@ObservableState\nstruct State: Equatable {\n    // ... \u5176\u4ed6\u5c6c\u6027\n\n    /// Tooltip \u662f\u5426\u986f\u793a\n    var isTooltipVisible: Bool = false\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#action","title":"Action","text":"<pre><code>enum Action: Equatable {\n    // ... \u5176\u4ed6 Action\n\n    /// Tooltip \u88ab\u95dc\u9589\n    case tooltipDismissed\n}\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#reducer","title":"Reducer","text":"<pre><code>case .onAppear:\n    state.isTooltipVisible = tooltipStorage.shouldShowTooltip\n    return .none\n\ncase .tooltipDismissed:\n    tooltipStorage.dismissTooltip()\n    state.isTooltipVisible = false\n    return .none\n</code></pre>"},{"location":"05_Module%20Sequence%20Diagram/Module%20Sequence%20Diagrams/04_tooltip_display_logic/#tooltipview","title":"TooltipView","text":"<pre><code>struct TooltipView: View {\n    let onDismiss: () -&gt; Void\n\n    var body: some View {\n        HStack {\n            Text(\"\ud83d\udca1 Insert a booking code from any provider\")\n                .font(.caption)\n                .foregroundColor(.white)\n\n            Spacer()\n\n            Button(action: onDismiss) {\n                Image(systemName: \"xmark\")\n                    .foregroundColor(.white.opacity(0.7))\n            }\n        }\n        .padding(.horizontal, 12)\n        .padding(.vertical, 8)\n        .background(Color.black.opacity(0.8))\n        .cornerRadius(8)\n    }\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/","title":"06_Feature State and Action (TCA)","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 LoadBookingCodeSectionFeature \u7684 State \u548c Action\u3002</p>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_feature_state_action.md Feature State \u548c Action \u5b9a\u7fa9"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/","title":"Feature State and Action (TCA)","text":""},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e Bookie \u76f8\u95dc State \u79fb\u9664 <code>selectedBookie</code>, <code>providerConfigs</code>, <code>isBookieSelectorPresented</code> Bookie \u76f8\u95dc Action \u79fb\u9664 <code>bookieDropdownTapped</code>, <code>bookieSelected</code>, <code>bookieSelectorDismissed</code>, <code>providerConfigLoaded</code> \u65b0\u589e Tooltip State/Action <code>isTooltipVisible</code>, <code>tooltipDismissed</code>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#loadcodewidgetfeature-loadbookingcodesectionfeature","title":"LoadCodeWidget.Feature\uff08\u64f4\u5c55\u81ea LoadBookingCodeSection.Feature\uff09","text":""},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#_1","title":"\u5fa9\u7528\u7b56\u7565","text":"<pre><code>// \u4fdd\u6301\u5411\u5f8c\u76f8\u5bb9\u7684\u65b9\u5f0f\uff1a\n// 1. State \u65b0\u589e\u5c6c\u6027\u90fd\u6709 default value\n// 2. Action \u65b0\u589e case \u4e0d\u5f71\u97ff\u65e2\u6709\u908f\u8f2f\n// 3. \u53ef\u9078\u64c7\u6027\u555f\u7528 Code Converter \u529f\u80fd\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#state","title":"State\uff08\u64f4\u5c55\uff09","text":"<pre><code>@ObservableState\nstruct State: Equatable {\n    // ========== \u539f\u6709\u5c6c\u6027\uff08\u4fdd\u6301\u76f8\u5bb9\uff09 ==========\n    var bookingCode: String = \"\"\n    var selectedCountry: Region = .current\n    var isLoading: Bool = false\n    var contentState: SectionContentState = .loaded\n    var availableCountries: [Region] = [.ghana, .nigeria]\n\n    // ========== \u65b0\u589e\u5c6c\u6027\uff08Code Converter\uff09 ==========\n\n    /// \u662f\u5426\u555f\u7528 Code Converter \u529f\u80fd\uff08\u5411\u5f8c\u76f8\u5bb9\u958b\u95dc\uff09\n    var enableCodeConverter: Bool = true\n\n    /// Widget \u8f38\u5165\u72c0\u614b\uff086 \u7a2e\u72c0\u614b\uff09\n    var inputState: WidgetInputState = .default\n\n    /// \u932f\u8aa4\u8a0a\u606f\n    var errorMessage: String?\n\n    /// \u8f49\u63db\u7d50\u679c\n    var convertResult: ConvertResult?\n\n    /// Tooltip \u662f\u5426\u986f\u793a\n    var isTooltipVisible: Bool = false\n\n    // ========== \u5ee2\u68c4\u5c6c\u6027 ==========\n    // \u274c var selectedBookie: SelectedBookie?       // \u5df2\u79fb\u9664\n    // \u274c var providerConfigs: [ProviderConfig] = [] // \u5df2\u79fb\u9664\n    // \u274c var isBookieSelectorPresented: Bool = false // \u5df2\u79fb\u9664\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#state_1","title":"State \u5c6c\u6027\u8aaa\u660e","text":"\u5c6c\u6027 \u985e\u578b \u539f\u6709/\u65b0\u589e \u9810\u8a2d\u503c \u8aaa\u660e <code>bookingCode</code> String \u2705 \u539f\u6709 <code>\"\"</code> \u8f38\u5165\u7684 Booking Code <code>selectedCountry</code> Region \u2705 \u539f\u6709 <code>.current</code> \u9078\u64c7\u7684\u570b\u5bb6\uff08\u539f\u6d41\u7a0b\u5099\u7528\uff09 <code>isLoading</code> Bool \u2705 \u539f\u6709 <code>false</code> Loading \u72c0\u614b <code>contentState</code> SectionContentState \u2705 \u539f\u6709 <code>.loaded</code> Section \u72c0\u614b <code>availableCountries</code> [Region] \u2705 \u539f\u6709 <code>[.ghana, .nigeria]</code> \u53ef\u7528\u570b\u5bb6 <code>enableCodeConverter</code> Bool \ud83c\udd95 \u65b0\u589e <code>true</code> \u662f\u5426\u555f\u7528 Code Converter <code>inputState</code> WidgetInputState \ud83c\udd95 \u65b0\u589e <code>.default</code> 6 \u7a2e\u8f38\u5165\u72c0\u614b <code>errorMessage</code> String? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u932f\u8aa4\u8a0a\u606f <code>convertResult</code> ConvertResult? \ud83c\udd95 \u65b0\u589e <code>nil</code> \u8f49\u63db\u7d50\u679c <code>isTooltipVisible</code> Bool \ud83c\udd95 \u65b0\u589e <code>false</code> Tooltip \u662f\u5426\u986f\u793a ~~<code>selectedBookie</code>~~ ~~SelectedBookie?~~ \u274c \u5ee2\u68c4 - ~~\u5df2\u9078 Bookie~~ ~~<code>providerConfigs</code>~~ ~~[ProviderConfig]~~ \u274c \u5ee2\u68c4 - ~~Provider \u8a2d\u5b9a~~ ~~<code>isBookieSelectorPresented</code>~~ ~~Bool~~ \u274c \u5ee2\u68c4 - ~~Sheet \u986f\u793a~~"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#action","title":"Action\uff08\u64f4\u5c55\uff09","text":"<pre><code>@CasePathable\nenum Action: Equatable {\n    // ========== \u539f\u6709 Action\uff08\u4fdd\u6301\u76f8\u5bb9\uff09 ==========\n    case onAppear\n    case bookingCodeChanged(String)\n    case countrySelected(Region)\n    case loadBookingCode\n    case bookingCodeLoadFailed(String)\n    case bookingCodeLoaded(LoadCodeModel.CodeResult)\n\n    // ========== \u65b0\u589e Action\uff08Code Converter\uff09 ==========\n\n    // UI Actions\n    case inputFocused\n    case inputBlurred\n    case clearButtonTapped\n\n    // Tooltip Actions\n    case tooltipDismissed\n\n    // Response Actions\n    case convertCodeCompleted(Result&lt;ConvertBookingCodeOutput, Error&gt;)\n\n    // Navigation Actions\n    case presentBetslip(shareCode: String, failCnt: Int)\n\n    // ========== \u5ee2\u68c4 Action ==========\n    // \u274c case bookieDropdownTapped\n    // \u274c case bookieSelectorDismissed\n    // \u274c case bookieSelected(provider: String, country: CountryCode)\n    // \u274c case providerConfigLoaded(Result&lt;[ProviderConfig], Error&gt;)\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#action_1","title":"Action \u5c0d\u7167\u8868","text":"Action \u539f\u6709/\u65b0\u589e \u89f8\u767c\u6642\u6a5f \u5c0d\u61c9 UseCase <code>.onAppear</code> \u2705 \u539f\u6709 \u9801\u9762\u51fa\u73fe - <code>.bookingCodeChanged</code> \u2705 \u539f\u6709 \u8f38\u5165\u8b8a\u66f4 - <code>.countrySelected</code> \u2705 \u539f\u6709 \u9078\u64c7\u570b\u5bb6\uff08\u539f\u6d41\u7a0b\uff09 - <code>.loadBookingCode</code> \u2705 \u539f\u6709 \u9ede\u64ca Load \u6309\u9215 ConvertBookingCodeUseCase <code>.bookingCodeLoadFailed</code> \u2705 \u539f\u6709 \u8f09\u5165\u5931\u6557\uff08\u539f\u6d41\u7a0b\uff09 - <code>.bookingCodeLoaded</code> \u2705 \u539f\u6709 \u8f09\u5165\u6210\u529f\uff08\u539f\u6d41\u7a0b\uff09 - <code>.inputFocused</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u805a\u7126 - <code>.inputBlurred</code> \ud83c\udd95 \u65b0\u589e \u8f38\u5165\u6846\u5931\u7126 - <code>.clearButtonTapped</code> \ud83c\udd95 \u65b0\u589e \u9ede\u64ca\u6e05\u9664\u6309\u9215 - <code>.tooltipDismissed</code> \ud83c\udd95 \u65b0\u589e \u95dc\u9589 Tooltip - <code>.convertCodeCompleted</code> \ud83c\udd95 \u65b0\u589e \u8f49\u63db\u5b8c\u6210 - <code>.presentBetslip</code> \ud83c\udd95 \u65b0\u589e \u8f09\u5165 Betslip - ~~<code>.bookieDropdownTapped</code>~~ \u274c \u5ee2\u68c4 ~~\u9ede\u64ca Bookie Dropdown~~ - ~~<code>.bookieSelectorDismissed</code>~~ \u274c \u5ee2\u68c4 ~~\u95dc\u9589 Sheet~~ - ~~<code>.bookieSelected</code>~~ \u274c \u5ee2\u68c4 ~~\u9078\u64c7 Bookie + Country~~ - ~~<code>.providerConfigLoaded</code>~~ \u274c \u5ee2\u68c4 ~~Config \u8f09\u5165\u5b8c\u6210~~ -"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#reducer","title":"Reducer\uff08\u64f4\u5c55\uff09","text":"<pre><code>@Reducer\nstruct Feature: Reducer {\n    typealias State = LoadCodeWidget.State\n    typealias Action = LoadCodeWidget.Action\n\n    @Dependency(\\.currentRegion) var currentRegion\n    @Dependency(\\.convertBookingCodeUseCase) var convertBookingCodeUseCase\n    @Dependency(\\.tooltipStorage) var tooltipStorage\n\n    private let manager: LoadCodeManager\n\n    init(manager: LoadCodeManager = .init()) {\n        self.manager = manager\n    }\n\n    var body: some ReducerOf&lt;Self&gt; {\n        Reduce { state, action in\n            switch action {\n            // ========== \u539f\u6709\u908f\u8f2f\uff08\u4fdd\u6301\u4e0d\u8b8a\uff09 ==========\n            case .onAppear:\n                if state.availableCountries.contains(currentRegion) {\n                    state.selectedCountry = currentRegion\n                } else {\n                    state.selectedCountry = state.availableCountries.first ?? .nigeria\n                }\n                // \u6aa2\u67e5\u662f\u5426\u986f\u793a Tooltip\n                if state.enableCodeConverter {\n                    state.isTooltipVisible = tooltipStorage.shouldShowTooltip\n                }\n                return .none\n\n            case .bookingCodeChanged(let rawCode):\n                let filteredCode = manager.filterBookingCode(rawCode)\n                state.bookingCode = filteredCode\n                // \u66f4\u65b0 inputState\n                if state.enableCodeConverter {\n                    state.inputState = filteredCode.isEmpty ? .focus : .typing\n                    state.errorMessage = nil // \u6e05\u9664\u932f\u8aa4\n                }\n                return .none\n\n            case .countrySelected(let country):\n                state.selectedCountry = country\n                return .none\n\n            case .loadBookingCode:\n                guard !state.bookingCode.isEmpty else {\n                    return .run { send in\n                        await send(.bookingCodeLoadFailed(\"Empty Code\"))\n                    }\n                }\n\n                // \u6839\u64da\u662f\u5426\u555f\u7528 Code Converter \u6c7a\u5b9a\u6d41\u7a0b\n                if state.enableCodeConverter {\n                    // Code Converter \u6d41\u7a0b\uff08\u7c21\u5316\u7248 - \u53ea\u9700 bookingCode\uff09\n                    state.inputState = .loading\n                    state.isLoading = true\n\n                    let input = ConvertBookingCodeInput(\n                        bookingCode: state.bookingCode\n                    )\n                    return .run { send in\n                        let result = await convertBookingCodeUseCase.execute(input)\n                        await send(.convertCodeCompleted(result))\n                    }\n                } else {\n                    // \u539f\u6709\u6d41\u7a0b\n                    state.isLoading = true\n                    state.contentState = .loaded\n\n                    return .run { [bookingCode = state.bookingCode, \n                                   country = state.selectedCountry] send in\n                        do {\n                            let result = try await manager.loadBookingCodeData(\n                                shareCode: bookingCode, \n                                countryCode: country.apiCountryCode\n                            )\n                            await send(.bookingCodeLoaded(result))\n                        } catch {\n                            await send(.bookingCodeLoadFailed(manager.mapErrorToMessage(error)))\n                        }\n                    }\n                }\n\n            case .bookingCodeLoadFailed(let message):\n                state.isLoading = false\n                if state.enableCodeConverter {\n                    state.inputState = .error(message: message)\n                    state.errorMessage = message\n                }\n                return .none\n\n            case .bookingCodeLoaded:\n                state.isLoading = false\n                state.bookingCode = \"\"\n                if state.enableCodeConverter {\n                    state.inputState = .default\n                }\n                return .none\n\n            // ========== \u65b0\u589e\u908f\u8f2f\uff08Code Converter\uff09 ==========\n            case .inputFocused:\n                state.inputState = .focus\n                return .none\n\n            case .inputBlurred:\n                if state.bookingCode.isEmpty {\n                    state.inputState = .default\n                } else {\n                    state.inputState = .filled\n                }\n                return .none\n\n            case .clearButtonTapped:\n                state.bookingCode = \"\"\n                state.inputState = .focus\n                state.errorMessage = nil\n                return .none\n\n            case .tooltipDismissed:\n                tooltipStorage.dismissTooltip()\n                state.isTooltipVisible = false\n                return .none\n\n            case let .convertCodeCompleted(.success(output)):\n                state.isLoading = false\n                state.inputState = .filled\n                state.convertResult = output.convertResult\n                state.bookingCode = \"\" // \u6e05\u7a7a\u8f38\u5165\n                return .send(.presentBetslip(\n                    shareCode: output.convertResult.shareCode,\n                    failCnt: output.convertResult.failCnt\n                ))\n\n            case let .convertCodeCompleted(.failure(error)):\n                state.isLoading = false\n                let message = (error as? CodeConverterError)?.localizedDescription ?? error.localizedDescription\n                state.inputState = .error(message: message)\n                state.errorMessage = message\n                return .none\n\n            case .presentBetslip:\n                // \u7531\u5916\u90e8\u8655\u7406 Betslip \u5c0e\u822a\n                return .none\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#computed-properties","title":"Computed Properties","text":"<pre><code>extension LoadCodeWidget.State {\n    /// Load \u6309\u9215\u662f\u5426\u555f\u7528\n    var isLoadButtonEnabled: Bool {\n        guard !bookingCode.isEmpty else { return false }\n        if enableCodeConverter {\n            return inputState.isLoadButtonEnabled\n        }\n        return true\n    }\n\n    /// \u662f\u5426\u986f\u793a\u6e05\u9664\u6309\u9215\n    var showClearButton: Bool {\n        !bookingCode.isEmpty &amp;&amp; (inputState == .typing || inputState == .filled || inputState.isError)\n    }\n\n    /// Loading \u63d0\u793a\u6587\u5b57\n    var loadingHintText: String? {\n        guard inputState == .loading else { return nil }\n        return \"Conversion may take up to 10 seconds, please stay here and wait for the result.\"\n    }\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#tooltipstorage-dependency","title":"TooltipStorage Dependency","text":"<pre><code>struct TooltipStorage {\n    private let userDefaults: UserDefaults\n    private let key = \"CodeConverter.TooltipDismissed\"\n\n    init(userDefaults: UserDefaults = .standard) {\n        self.userDefaults = userDefaults\n    }\n\n    var shouldShowTooltip: Bool {\n        !userDefaults.bool(forKey: key)\n    }\n\n    func dismissTooltip() {\n        userDefaults.set(true, forKey: key)\n    }\n}\n\n// TCA Dependency\nextension DependencyValues {\n    var tooltipStorage: TooltipStorage {\n        get { self[TooltipStorageKey.self] }\n        set { self[TooltipStorageKey.self] = newValue }\n    }\n}\n\nprivate enum TooltipStorageKey: DependencyKey {\n    static let liveValue = TooltipStorage()\n}\n</code></pre>"},{"location":"06_Feature%20State%20and%20Action%20%28TCA%29/01_feature_state_action/#_2","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>selectedBookie</code> State \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie <code>providerConfigs</code> State \u4e0d\u518d\u9700\u8981 Config \u8cc7\u6599 <code>isBookieSelectorPresented</code> State \u4e0d\u518d\u9700\u8981 Sheet <code>bookieDropdownTapped</code> Action \u4e0d\u518d\u9700\u8981 Dropdown <code>bookieSelected</code> Action \u4e0d\u518d\u9700\u8981\u9078\u64c7 <code>bookieSelectorDismissed</code> Action \u4e0d\u518d\u9700\u8981\u95dc\u9589 Sheet <code>providerConfigLoaded</code> Action \u4e0d\u518d\u9700\u8981\u8f09\u5165 Config <code>loadProviderConfigUseCase</code> Dependency API \u5df2\u5ee2\u68c4"},{"location":"07_UseCase%20Input%20and%20Output%20Model/","title":"07_UseCase Input and Output Model","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 UseCase \u7684 Input \u548c Output Model\u3002</p>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_usecase_input_output.md UseCase Input/Output Model \u5b9a\u7fa9"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/","title":"UseCase Input and Output Model","text":""},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e LoadProviderConfigUseCase \u5ee2\u68c4 Config API \u5df2\u5ee2\u68c4 ConvertBookingCodeInput \u7c21\u5316 \u53ea\u9700 <code>bookingCode</code>\uff0c\u79fb\u9664 <code>provider</code> \u548c <code>country</code>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#loadproviderconfigusecase","title":"~~LoadProviderConfigUseCase~~ \u274c \u5ee2\u68c4","text":"<pre><code>// \u274c \u5ee2\u68c4 - Config API \u5df2\u4e0d\u518d\u4f7f\u7528\n// struct LoadProviderConfigInput: Equatable { }\n// struct LoadProviderConfigOutput: Equatable {\n//     let providerConfigs: [ProviderConfig]\n// }\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#convertbookingcodeusecase","title":"ConvertBookingCodeUseCase","text":""},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#input-model","title":"Input Model","text":"<pre><code>struct ConvertBookingCodeInput: Equatable {\n    let bookingCode: String\n\n    // \u274c \u5df2\u79fb\u9664\n    // let provider: String\n    // let country: String\n}\n</code></pre> \u5c6c\u6027 \u985e\u578b \u8aaa\u660e <code>bookingCode</code> <code>String</code> \u4efb\u610f Booking Code\uff08BE \u81ea\u52d5\u8b58\u5225 Provider\uff09 ~~<code>provider</code>~~ ~~<code>String</code>~~ \u274c \u5df2\u79fb\u9664 ~~<code>country</code>~~ ~~<code>String</code>~~ \u274c \u5df2\u79fb\u9664"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#output-model","title":"Output Model","text":"<pre><code>struct ConvertBookingCodeOutput: Equatable {\n    let convertResult: ConvertResult\n    let liabilities: LiabilitiesResult\n}\n</code></pre> \u5c6c\u6027 \u985e\u578b \u8aaa\u660e <code>convertResult</code> <code>ConvertResult</code> \u8f49\u63db\u7d50\u679c\uff08shareCode, successCnt, failCnt\uff09 <code>liabilities</code> <code>LiabilitiesResult</code> Liabilities \u6aa2\u67e5\u7d50\u679c\uff08\u65e2\u6709\u6d41\u7a0b\uff09"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#usecase","title":"UseCase \u5b9a\u7fa9","text":"<pre><code>protocol ConvertBookingCodeUseCaseProtocol {\n    func execute(_ input: ConvertBookingCodeInput) async -&gt; Result&lt;ConvertBookingCodeOutput, Error&gt;\n}\n\nstruct ConvertBookingCodeUseCase: ConvertBookingCodeUseCaseProtocol {\n    let codeConverterRepository: CodeConverterRepositoryProtocol\n    let betslipRepository: BetslipRepositoryProtocol\n\n    func execute(_ input: ConvertBookingCodeInput) async -&gt; Result&lt;ConvertBookingCodeOutput, Error&gt; {\n        do {\n            // 1. \u8f49\u63db Booking Code\uff08\u53ea\u9700 bookingCode\uff09\n            let convertResult = try await codeConverterRepository.convertCode(\n                bookingCode: input.bookingCode\n            )\n\n            // \u6aa2\u67e5\u662f\u5426\u5168\u90e8\u5931\u6557\n            guard !convertResult.isAllFailed else {\n                throw CodeConverterError.allSelectionsFailed\n            }\n\n            // 2. \u6aa2\u67e5 Liabilities\uff08\u65e2\u6709\u6d41\u7a0b - \u4f7f\u7528\u8fd4\u56de\u7684 shareCode\uff09\n            let liabilities = try await betslipRepository.checkLiabilities(\n                shareCode: convertResult.shareCode\n            )\n\n            return .success(ConvertBookingCodeOutput(\n                convertResult: convertResult,\n                liabilities: liabilities\n            ))\n        } catch {\n            return .failure(error)\n        }\n    }\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#error-types","title":"Error Types","text":"<pre><code>enum CodeConverterError: Error, Equatable {\n    case invalidParameter\n    case codeNotFound\n    case allSelectionsFailed\n    case timeout\n    case internalError\n    case unknown\n\n    var localizedDescription: String {\n        switch self {\n        case .invalidParameter:\n            return \"Invalid parameter\"\n        case .codeNotFound:\n            return \"We couldn't find this booking code. Please check and try again.\"\n        case .allSelectionsFailed:\n            return \"All selections failed to convert\"\n        case .timeout:\n            return \"Request timeout. Please try again.\"\n        case .internalError:\n            return \"Internal error. Please try again later.\"\n        case .unknown:\n            return \"An unknown error occurred\"\n        }\n    }\n\n    static func from(bizCode: Int) -&gt; CodeConverterError {\n        switch bizCode {\n        case 10001: return .invalidParameter\n        case 10002: return .codeNotFound\n        case 10005: return .timeout\n        case 10006: return .internalError\n        default: return .unknown\n        }\n    }\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#error-cases","title":"\u5ee2\u68c4\u7684 Error Cases","text":"Error Case \u539f\u56e0 ~~<code>providerNotSupported</code>~~ \u4e0d\u518d\u9700\u8981 Provider \u9a57\u8b49 ~~<code>countryNotSupported</code>~~ \u4e0d\u518d\u9700\u8981 Country \u9a57\u8b49 ~~<code>codeNotFound(bookieName:)</code>~~ \u7c21\u5316\u70ba\u4e0d\u5e36 bookieName"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#dependency-injection","title":"Dependency Injection","text":"<pre><code>extension DependencyValues {\n    var convertBookingCodeUseCase: ConvertBookingCodeUseCaseProtocol {\n        get { self[ConvertBookingCodeUseCaseKey.self] }\n        set { self[ConvertBookingCodeUseCaseKey.self] = newValue }\n    }\n\n    // \u274c \u5ee2\u68c4\n    // var loadProviderConfigUseCase: LoadProviderConfigUseCaseProtocol { ... }\n}\n\nprivate enum ConvertBookingCodeUseCaseKey: DependencyKey {\n    static let liveValue: ConvertBookingCodeUseCaseProtocol = ConvertBookingCodeUseCase(\n        codeConverterRepository: CodeConverterRepository(),\n        betslipRepository: BetslipRepository()\n    )\n}\n</code></pre>"},{"location":"07_UseCase%20Input%20and%20Output%20Model/01_usecase_input_output/#_1","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>LoadProviderConfigUseCase</code> UseCase Config API \u5df2\u5ee2\u68c4 <code>LoadProviderConfigInput</code> Input Model \u5c0d\u61c9 UseCase \u5df2\u5ee2\u68c4 <code>LoadProviderConfigOutput</code> Output Model \u5c0d\u61c9 UseCase \u5df2\u5ee2\u68c4 <code>provider</code> \u53c3\u6578 Input Field BE \u81ea\u52d5\u8b58\u5225 <code>country</code> \u53c3\u6578 Input Field BE \u81ea\u52d5\u8b58\u5225 <code>providerNotSupported</code> Error Case \u7121\u9700\u9a57\u8b49 <code>countryNotSupported</code> Error Case \u7121\u9700\u9a57\u8b49"},{"location":"08_API%20Spec%20and%20Mapping/","title":"08_API Spec and Mapping","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter \u76f8\u95dc API \u898f\u683c\u53ca DTO \u2192 Domain Model Mapping\u3002</p>"},{"location":"08_API%20Spec%20and%20Mapping/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_api_spec.md API Endpoints \u898f\u683c 02_dto_mapping.md DTO \u2192 Domain Model Mapping"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/","title":"API Spec","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#be-2025-01","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e Config API \u5ee2\u68c4 ~~<code>GET /orders/converter/config/providerCountries</code>~~ \u4e0d\u518d\u4f7f\u7528 Convert API \u7c21\u5316 \u4e0d\u518d\u9700\u8981 <code>provider</code> \u548c <code>country</code> \u53c3\u6578\uff0c\u53ea\u9700 <code>bookingCode</code>"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api","title":"~~\u5ee2\u68c4 API~~","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#1-get-provider-country-config","title":"~~1. Get Provider Country Config~~ \u274c \u5ee2\u68c4","text":"\u9805\u76ee \u8aaa\u660e Method ~~<code>GET</code>~~ Endpoint ~~<code>/orders/converter/config/providerCountries</code>~~ \u72c0\u614b \u274c \u5df2\u5ee2\u68c4 - BE \u65b0\u8a2d\u8a08\u4e0d\u518d\u9700\u8981"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api_1","title":"\u65b0\u589e API","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#1-convert-code2code","title":"1. Convert Code2Code","text":"\u9805\u76ee \u8aaa\u660e Method <code>POST</code> Endpoint <code>/orders/converter/code</code> Description \u5c07\u4efb\u610f Booking Code \u8f49\u63db\u70ba Fcom Share Code \u6240\u5c6c Client CodeConverterClient \u6240\u5c6c Repository CodeConverterRepository \u6240\u5c6c UseCase ConvertBookingCodeUseCase"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#headers","title":"Headers","text":"Field Type Required Description <code>uid</code> String Optional User ID <code>OperId</code> String Optional Operator ID"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#request-body","title":"Request Body","text":"<pre><code>{\n  \"bookingCode\": \"3RA3FA\"\n}\n</code></pre> Field Type Required Description ~~<code>provider</code>~~ ~~String~~ \u274c ~~\u7af6\u54c1 Provider Code~~ \u5df2\u79fb\u9664 ~~<code>country</code>~~ ~~String~~ \u274c ~~Country Code~~ \u5df2\u79fb\u9664 <code>bookingCode</code> String \u2705 \u4efb\u610f Booking Code"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#response-success","title":"Response - Success","text":"<pre><code>{\n  \"bizCode\": 10000,\n  \"message\": \"SUCCESS\",\n  \"data\": {\n    \"shareCode\": \"ABC123\",\n    \"successCnt\": 5,\n    \"failCnt\": 1\n  }\n}\n</code></pre> Field Type Description <code>shareCode</code> String \u8f49\u63db\u5f8c\u7684 Fcom Share Code <code>successCnt</code> Int \u6210\u529f\u8f49\u63db\u7684 selection \u6578\u91cf <code>failCnt</code> Int \u5931\u6557\u7684 selection \u6578\u91cf"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api_2","title":"\u65e2\u6709 API\uff08\u5fa9\u7528\uff09","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#2-check-liabilities","title":"2. Check Liabilities","text":"\u9805\u76ee \u8aaa\u660e Method <code>GET</code> Endpoint <code>/bookingCode/{shareCode}/liabilities</code> Description \u6aa2\u67e5 Share Code \u7684 Liabilities \u6240\u5c6c Client BetslipClient\uff08\u65e2\u6709\uff09 \u6240\u5c6c Repository BetslipRepository\uff08\u65e2\u6709\uff09 \u5099\u8a3b Convert API \u6210\u529f\u5f8c\uff0c\u4f7f\u7528\u8fd4\u56de\u7684 shareCode \u547c\u53eb"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#3-get-share-order","title":"3. Get Share Order","text":"\u9805\u76ee \u8aaa\u660e Method <code>GET</code> Endpoint <code>/orders/share/{shareCode}</code> Description \u53d6\u5f97 Share Code \u5c0d\u61c9\u7684 Betslip Data \u6240\u5c6c Client BetslipClient\uff08\u65e2\u6709\uff09 \u6240\u5c6c Repository BetslipRepository\uff08\u65e2\u6709\uff09 \u5099\u8a3b Liabilities \u6aa2\u67e5\u5f8c\uff0c\u53d6\u5f97 Betslip \u5167\u5bb9"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#error-codes","title":"Error Codes","text":"bizCode message Description 10000 SUCCESS \u8acb\u6c42\u6210\u529f 10001 INVALID_PARAMETER \u53c3\u6578\u932f\u8aa4 10002 CODE_NOT_FOUND \u627e\u4e0d\u5230\u6307\u5b9a\u7684 Booking Code ~~10003~~ ~~PROVIDER_NOT_SUPPORTED~~ ~~\u4e0d\u652f\u63f4\u7684 Provider~~ \u5df2\u5ee2\u68c4 ~~10004~~ ~~COUNTRY_NOT_SUPPORTED~~ ~~\u4e0d\u652f\u63f4\u7684 Country~~ \u5df2\u5ee2\u68c4 10005 TIMEOUT \u8acb\u6c42\u903e\u6642 10006 INTERNAL_ERROR \u5167\u90e8\u932f\u8aa4"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#api_3","title":"API \u8abf\u7528\u9806\u5e8f","text":"\u9806\u5e8f API \u6642\u6a5f \u72c0\u614b ~~1~~ ~~GET <code>/orders/converter/config/providerCountries</code>~~ ~~\u9ede\u64ca Bookie Dropdown~~ \u274c \u5ee2\u68c4 1 POST <code>/orders/converter/code</code> \u9ede\u64ca Load \u6309\u9215 \u2705 2 GET <code>/bookingCode/{shareCode}/liabilities</code> \u8f49\u63db\u6210\u529f\u5f8c \u2705 \u65e2\u6709\u6d41\u7a0b 3 GET <code>/orders/share/{shareCode}</code> Liabilities \u6aa2\u67e5\u5f8c \u2705 \u65e2\u6709\u6d41\u7a0b"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#dto","title":"DTO \u5b9a\u7fa9","text":""},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#convertcoderequestdto","title":"ConvertCodeRequestDTO","text":"<pre><code>struct ConvertCodeRequestDTO: Encodable {\n    let bookingCode: String\n\n    // \u5df2\u79fb\u9664\n    // let provider: String\n    // let country: String\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#convertcoderesponsedto","title":"ConvertCodeResponseDTO","text":"<pre><code>struct ConvertCodeResponseDTO: Decodable {\n    let bizCode: Int\n    let message: String\n    let data: ConvertCodeDataDTO?\n}\n\nstruct ConvertCodeDataDTO: Decodable {\n    let shareCode: String\n    let successCnt: Int\n    let failCnt: Int\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/01_api_spec/#_1","title":"\u5ee2\u68c4\u9805\u76ee","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>GET /orders/converter/config/providerCountries</code> API BE \u65b0\u8a2d\u8a08\u4e0d\u518d\u9700\u8981\u9078\u64c7 Provider <code>ProviderCountryConfigDTO</code> DTO \u5c0d\u61c9 Config API \u5ee2\u68c4 <code>provider</code> \u53c3\u6578 Request Field BE \u6703\u81ea\u52d5\u8b58\u5225 <code>country</code> \u53c3\u6578 Request Field BE \u6703\u81ea\u52d5\u8b58\u5225 <code>PROVIDER_NOT_SUPPORTED</code> (10003) Error Code \u7121\u9700\u9a57\u8b49 Provider <code>COUNTRY_NOT_SUPPORTED</code> (10004) Error Code \u7121\u9700\u9a57\u8b49 Country"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/","title":"DTO \u2192 Domain Model Mapping","text":""},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#dto","title":"DTO \u5b9a\u7fa9","text":""},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#providercountryconfigdto","title":"ProviderCountryConfigDTO","text":"<pre><code>struct ProviderCountryConfigResponse: Decodable {\n    let bizCode: Int\n    let message: String\n    let data: [ProviderCountryConfigDTO]?\n}\n\nstruct ProviderCountryConfigDTO: Decodable {\n    let provider: String\n    let name: String\n    let countries: [String]\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#code2codedto","title":"Code2CodeDTO","text":"<pre><code>struct Code2CodeResponse: Decodable {\n    let bizCode: Int\n    let message: String\n    let innerMsg: String?\n    let data: Code2CodeDataDTO?\n}\n\nstruct Code2CodeDataDTO: Decodable {\n    let shareCode: String\n    let successCnt: Int\n    let failCnt: Int\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#code2coderequestdto","title":"Code2CodeRequestDTO","text":"<pre><code>struct Code2CodeRequestDTO: Encodable {\n    let provider: String\n    let country: String\n    let bookingCode: String\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#mapping","title":"Mapping \u898f\u5247","text":""},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#providercountryconfigdto-providerconfig","title":"ProviderCountryConfigDTO \u2192 ProviderConfig","text":"DTO \u6b04\u4f4d Domain Model \u6b04\u4f4d \u8f49\u63db\u908f\u8f2f <code>provider</code> <code>provider</code> \u76f4\u63a5\u5c0d\u61c9 <code>name</code> <code>name</code> \u76f4\u63a5\u5c0d\u61c9 <code>countries</code> <code>countries</code> String[] \u2192 [CountryCode]\uff0c\u904e\u6ffe\u7121\u6548\u503c <p>\u5be6\u4f5c\uff1a</p> <pre><code>extension ProviderConfig {\n    init(from dto: ProviderCountryConfigDTO) {\n        self.provider = dto.provider\n        self.name = dto.name\n        self.countries = dto.countries.compactMap { CountryCode(rawValue: $0) }\n    }\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#code2codedatadto-convertresult","title":"Code2CodeDataDTO \u2192 ConvertResult","text":"DTO \u6b04\u4f4d Domain Model \u6b04\u4f4d \u8f49\u63db\u908f\u8f2f <code>shareCode</code> <code>shareCode</code> \u76f4\u63a5\u5c0d\u61c9 <code>successCnt</code> <code>successCnt</code> \u76f4\u63a5\u5c0d\u61c9 <code>failCnt</code> <code>failCnt</code> \u76f4\u63a5\u5c0d\u61c9 <p>\u5be6\u4f5c\uff1a</p> <pre><code>extension ConvertResult {\n    init(from dto: Code2CodeDataDTO) {\n        self.shareCode = dto.shareCode\n        self.successCnt = dto.successCnt\n        self.failCnt = dto.failCnt\n    }\n}\n</code></pre>"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#repository-mapping","title":"Repository Mapping \u8cac\u4efb","text":"Repository DTO Domain Model CodeConverterRepository ProviderCountryConfigDTO ProviderConfig CodeConverterRepository Code2CodeDataDTO ConvertResult BetslipRepository LiabilitiesDTO Liabilities\uff08\u65e2\u6709\uff09 BetslipRepository BetslipDataDTO BetslipData\uff08\u65e2\u6709\uff09"},{"location":"08_API%20Spec%20and%20Mapping/02_dto_mapping/#repository","title":"Repository \u5be6\u4f5c","text":"<pre><code>protocol CodeConverterRepositoryProtocol {\n    func getProviderCountryConfig() async throws -&gt; [ProviderConfig]\n    func convertCode(provider: String, country: String, bookingCode: String) async throws -&gt; ConvertResult\n}\n\nstruct CodeConverterRepository: CodeConverterRepositoryProtocol {\n    let client: CodeConverterClient\n\n    init(client: CodeConverterClient = .live) {\n        self.client = client\n    }\n\n    func getProviderCountryConfig() async throws -&gt; [ProviderConfig] {\n        let response = try await client.fetchProviderCountries()\n\n        guard response.bizCode == 10000, let data = response.data else {\n            throw CodeConverterError.from(bizCode: response.bizCode)\n        }\n\n        return data.map { ProviderConfig(from: $0) }\n    }\n\n    func convertCode(provider: String, country: String, bookingCode: String) async throws -&gt; ConvertResult {\n        let request = Code2CodeRequestDTO(\n            provider: provider,\n            country: country,\n            bookingCode: bookingCode\n        )\n\n        let response = try await client.convertCode(request)\n\n        guard response.bizCode == 10000, let data = response.data else {\n            throw CodeConverterError.from(bizCode: response.bizCode, bookieName: provider)\n        }\n\n        return ConvertResult(from: data)\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/","title":"09_Error Handling","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter \u7684\u932f\u8aa4\u8655\u7406\u7b56\u7565\u3002</p>"},{"location":"09_Error%20Handling/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_error_handling.md \u932f\u8aa4\u5206\u985e\u8207\u8655\u7406\u7b56\u7565"},{"location":"09_Error%20Handling/01_error_handling/","title":"Error Handling","text":""},{"location":"09_Error%20Handling/01_error_handling/#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e \u79fb\u9664 Provider/Country \u932f\u8aa4 <code>unsupportedProvider</code>, <code>unsupportedCountry</code> \u5df2\u5ee2\u68c4 \u7c21\u5316 codeNotFound \u4e0d\u518d\u5e36 <code>bookieName</code> \u53c3\u6578"},{"location":"09_Error%20Handling/01_error_handling/#_1","title":"\u932f\u8aa4\u985e\u578b\u5b9a\u7fa9","text":"<pre><code>enum CodeConverterError: LocalizedError, Equatable {\n    /// \u53c3\u6578\u932f\u8aa4\n    case invalidParameter\n\n    /// \u627e\u4e0d\u5230 Booking Code\uff08\u5c0d\u61c9 bizCode: 10002\uff09\n    case codeNotFound\n\n    /// \u6240\u6709 selections \u90fd\u8f49\u63db\u5931\u6557\n    case allSelectionsFailed\n\n    /// \u7db2\u8def\u932f\u8aa4\n    case networkError(message: String)\n\n    /// \u8acb\u6c42\u903e\u6642\uff08\u5c0d\u61c9 bizCode: 10005\uff09\n    case timeout\n\n    /// \u4f3a\u670d\u5668\u932f\u8aa4\uff08\u5c0d\u61c9 bizCode: 10006\uff09\n    case internalError\n\n    /// \u672a\u77e5\u932f\u8aa4\n    case unknown\n\n    var errorDescription: String? {\n        switch self {\n        case .invalidParameter:\n            return \"Invalid parameter. Please try again.\"\n        case .codeNotFound:\n            return \"We couldn't find this booking code. Please check and try again.\"\n        case .allSelectionsFailed:\n            return \"All selections failed to convert. Please try a different code.\"\n        case .networkError(let message):\n            return message.isEmpty ? \"Network error. Please check your connection and try again.\" : message\n        case .timeout:\n            return \"Request timeout. Please try again.\"\n        case .internalError:\n            return \"Internal error. Please try again later.\"\n        case .unknown:\n            return \"An unexpected error occurred. Please try again.\"\n        }\n    }\n\n    static func from(bizCode: Int) -&gt; CodeConverterError {\n        switch bizCode {\n        case 10001: return .invalidParameter\n        case 10002: return .codeNotFound\n        case 10005: return .timeout\n        case 10006: return .internalError\n        default: return .unknown\n        }\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_2","title":"\u5ee2\u68c4\u7684\u932f\u8aa4\u985e\u578b","text":"<pre><code>// \u274c \u5ee2\u68c4 - \u4e0d\u518d\u9700\u8981\n// case unsupportedProvider\n// case unsupportedCountry\n// case codeNotFound(bookieName: String)  // \u7c21\u5316\u70ba\u4e0d\u5e36\u53c3\u6578\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#api-error-code","title":"API Error Code \u5c0d\u7167","text":"bizCode HTTP Status CodeConverterError UI \u986f\u793a 10001 400 <code>.invalidParameter</code> \u53c3\u6578\u932f\u8aa4 10002 200 <code>.codeNotFound</code> \u627e\u4e0d\u5230 Code\uff08\u7d05\u6846 + \u8a0a\u606f\uff09 ~~10003~~ ~~400~~ ~~<code>.unsupportedProvider</code>~~ \u274c \u5ee2\u68c4 ~~10004~~ ~~400~~ ~~<code>.unsupportedCountry</code>~~ \u274c \u5ee2\u68c4 10005 200 <code>.timeout</code> \u8acb\u6c42\u903e\u6642 10006 200 <code>.internalError</code> \u5167\u90e8\u932f\u8aa4 - 5xx <code>.internalError</code> \u4f3a\u670d\u5668\u932f\u8aa4 - timeout <code>.networkError</code> \u7db2\u8def\u932f\u8aa4"},{"location":"09_Error%20Handling/01_error_handling/#_3","title":"\u932f\u8aa4\u8655\u7406\u6d41\u7a0b","text":""},{"location":"09_Error%20Handling/01_error_handling/#1-code-not-found-bizcode-10002","title":"1. Code Not Found (bizCode: 10002)","text":"<pre><code>sequenceDiagram\n    participant API as API\n    participant Client as CodeConverterClient\n    participant Repo as CodeConverterRepository\n    participant UC as ConvertBookingCodeUseCase\n    participant Feature as LoadCodeWidget.Feature\n    participant UI as LoadCodeWidgetView\n\n    API--&gt;&gt;Client: {bizCode: 10002, message: \"CODE_NOT_FOUND\"}\n    Client--&gt;&gt;Repo: throw CodeConverterError.codeNotFound\n\n    Note over Repo: \u8f49\u63db\u70ba Domain Error\n    Repo--&gt;&gt;UC: throw CodeConverterError.codeNotFound\n\n    UC--&gt;&gt;Feature: .failure(CodeConverterError.codeNotFound)\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"We couldn't find...\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#2-partial-failure","title":"2. Partial Failure (\u6210\u529f\u4f46\u90e8\u5206\u5931\u6557)","text":"<pre><code>sequenceDiagram\n    participant API as API\n    participant Feature as LoadCodeWidget.Feature\n    participant UI as LoadCodeWidgetView\n    participant Toast as PartialErrorToast\n    participant Betslip as BetslipPage\n\n    API--&gt;&gt;Feature: {bizCode: 10000, data: {failCnt: 2, successCnt: 5}}\n\n    Feature-&gt;&gt;Feature: state.convertResult = result\n    Feature-&gt;&gt;Feature: state.inputState = .filled\n\n    Feature--&gt;&gt;UI: .presentBetslip(shareCode, failCnt: 2)\n\n    Note over UI: failCnt &gt; 0\n\n    UI-&gt;&gt;Toast: \u986f\u793a \"2 selections failed to convert\"\n    UI-&gt;&gt;Betslip: \u5c0e\u822a\uff08\u53ea\u8f09\u5165\u6210\u529f\u7684 selections\uff09</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#3-all-selections-failed","title":"3. All Selections Failed","text":"<pre><code>sequenceDiagram\n    participant Feature as LoadCodeWidget.Feature\n    participant UI as LoadCodeWidgetView\n\n    Note over Feature: convertResult.isAllFailed == true\n\n    Feature-&gt;&gt;Feature: state.inputState = .error(message)\n    Feature-&gt;&gt;Feature: state.errorMessage = \"All selections failed...\"\n\n    Feature--&gt;&gt;UI: State \u66f4\u65b0\n\n    Note over UI: \u7d05\u8272\u908a\u6846 + \u932f\u8aa4\u8a0a\u606f&lt;br/&gt;\u4e0d\u5c0e\u822a\u81f3 Betslip</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#ui","title":"UI \u932f\u8aa4\u72c0\u614b","text":""},{"location":"09_Error%20Handling/01_error_handling/#inputstate-errormessage","title":"inputState == .error(message)","text":"\u5143\u4ef6 \u8b8a\u5316 \u8f38\u5165\u6846\u908a\u6846 \u7d05\u8272 (#fb4d3d) \u6e05\u9664\u6309\u9215 \u986f\u793a \u2297 Load \u6309\u9215 \u7da0\u8272\uff08\u53ef\u91cd\u8a66\uff09 \u932f\u8aa4\u8a0a\u606f \u8f38\u5165\u6846\u4e0b\u65b9\u7d05\u8272\u6587\u5b57"},{"location":"09_Error%20Handling/01_error_handling/#_4","title":"\u8996\u89ba\u898f\u683c","text":"<pre><code>// \u932f\u8aa4\u908a\u6846\n.overlay(\n    RoundedRectangle(cornerRadius: 10)\n        .stroke(Color.warningPrimary, lineWidth: 1)\n)\n\n// \u932f\u8aa4\u8a0a\u606f\nText(errorMessage)\n    .font(.system(size: 12))\n    .foregroundColor(.warningPrimary)\n    .padding(.top, 8)\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_5","title":"\u932f\u8aa4\u6062\u5fa9","text":""},{"location":"09_Error%20Handling/01_error_handling/#_6","title":"\u7528\u6236\u64cd\u4f5c \u2192 \u6e05\u9664\u932f\u8aa4","text":"\u7528\u6236\u64cd\u4f5c \u7d50\u679c \u9ede\u64ca\u8f38\u5165\u6846 <code>inputState = .focus</code>\uff0c\u6e05\u9664 errorMessage \u4fee\u6539\u8f38\u5165 <code>inputState = .typing</code>\uff0c\u6e05\u9664 errorMessage \u9ede\u64ca\u6e05\u9664\u6309\u9215 \u6e05\u9664\u8f38\u5165 + errorMessage\uff0c<code>inputState = .focus</code>"},{"location":"09_Error%20Handling/01_error_handling/#reducer","title":"Reducer \u5be6\u4f5c","text":"<pre><code>case .bookingCodeChanged(let rawCode):\n    let filteredCode = manager.filterBookingCode(rawCode)\n    state.bookingCode = filteredCode\n\n    // \u6e05\u9664\u932f\u8aa4\u72c0\u614b\n    if state.inputState.isError {\n        state.inputState = filteredCode.isEmpty ? .focus : .typing\n        state.errorMessage = nil\n    } else {\n        state.inputState = filteredCode.isEmpty ? .focus : .typing\n    }\n    return .none\n\ncase .clearButtonTapped:\n    state.bookingCode = \"\"\n    state.inputState = .focus\n    state.errorMessage = nil  // \u6e05\u9664\u932f\u8aa4\n    return .none\n\ncase .inputFocused:\n    if state.inputState.isError {\n        // \u805a\u7126\u6642\u4e0d\u6e05\u9664\u932f\u8aa4\uff0c\u8b93\u7528\u6236\u770b\u5230\u8a0a\u606f\n    } else {\n        state.inputState = .focus\n    }\n    return .none\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#partial-error-toast","title":"Partial Error Toast","text":""},{"location":"09_Error%20Handling/01_error_handling/#_7","title":"\u986f\u793a\u6642\u6a5f","text":"<p>\u7576 <code>convertResult.failCnt &gt; 0 &amp;&amp; convertResult.successCnt &gt; 0</code> \u6642\u986f\u793a\u3002</p>"},{"location":"09_Error%20Handling/01_error_handling/#toast","title":"Toast \u898f\u683c","text":"<pre><code>struct PartialErrorToast: View {\n    let failedCount: Int\n\n    var body: some View {\n        HStack(spacing: 4) {\n            Image(\"icon/exclamation/2\")\n                .resizable()\n                .frame(width: 12, height: 12)\n                .foregroundColor(.white)\n\n            Text(\"\\(failedCount) selection\\(failedCount &gt; 1 ? \"s\" : \"\") failed to convert\")\n                .font(.system(size: 12))\n                .foregroundColor(.white)\n        }\n        .padding(.horizontal, 16)\n        .padding(.vertical, 12)\n        .background(\n            RoundedRectangle(cornerRadius: 10)\n                .fill(Color.warningPrimary)\n        )\n        .shadow(color: Color.black.opacity(0.25), radius: 12, x: 0, y: 4)\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_8","title":"\u986f\u793a\u908f\u8f2f","text":"<pre><code>// \u5728 LoadCodeWidgetView \u6216 Parent View \u4e2d\n.toast(isPresenting: $showPartialErrorToast) {\n    PartialErrorToast(failedCount: store.convertResult?.failCnt ?? 0)\n}\n\n// \u6536\u5230 .presentBetslip \u6642\ncase let .presentBetslip(shareCode, failCnt):\n    if failCnt &gt; 0 {\n        state.showPartialErrorToast = true\n    }\n    // \u5c0e\u822a\u81f3 Betslip\n    return .none\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_9","title":"\u932f\u8aa4\u65e5\u8a8c","text":""},{"location":"09_Error%20Handling/01_error_handling/#analytics-event","title":"Analytics Event","text":"<pre><code>struct CodeConverterErrorEvent: AnalyticsEvent {\n    let errorType: String\n    let errorCode: String?\n    let bookingCode: String  // \u5df2\u906e\u853d\u654f\u611f\u8cc7\u8a0a\n\n    static func from(error: CodeConverterError, bookingCode: String) -&gt; Self {\n        Self(\n            errorType: error.analyticsType,\n            errorCode: error.analyticsCode,\n            bookingCode: String(bookingCode.prefix(3)) + \"***\"  // \u906e\u853d\n        )\n    }\n}\n\nextension CodeConverterError {\n    var analyticsType: String {\n        switch self {\n        case .invalidParameter: return \"invalid_parameter\"\n        case .codeNotFound: return \"code_not_found\"\n        case .allSelectionsFailed: return \"all_failed\"\n        case .networkError: return \"network_error\"\n        case .timeout: return \"timeout\"\n        case .internalError: return \"internal_error\"\n        case .unknown: return \"unknown\"\n        }\n    }\n\n    var analyticsCode: String? {\n        switch self {\n        case .invalidParameter: return \"10001\"\n        case .codeNotFound: return \"10002\"\n        case .timeout: return \"10005\"\n        case .internalError: return \"10006\"\n        default: return nil\n        }\n    }\n}\n</code></pre>"},{"location":"09_Error%20Handling/01_error_handling/#_10","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 <code>unsupportedProvider</code> Error Case \u4e0d\u518d\u9700\u8981 Provider \u9a57\u8b49 <code>unsupportedCountry</code> Error Case \u4e0d\u518d\u9700\u8981 Country \u9a57\u8b49 <code>codeNotFound(bookieName:)</code> Error Case \u7c21\u5316\u70ba\u4e0d\u5e36 bookieName Error Code 10003 API Code Provider \u9a57\u8b49\u5df2\u79fb\u9664 Error Code 10004 API Code Country \u9a57\u8b49\u5df2\u79fb\u9664"},{"location":"10_Test%20Scenarios/","title":"10_Test Scenarios","text":"<p>\u672c\u7ae0\u7bc0\u5b9a\u7fa9 Code Converter \u7684\u6e2c\u8a66\u6848\u4f8b\u3002</p>"},{"location":"10_Test%20Scenarios/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_test_scenarios.md UseCase \u6e2c\u8a66\u6848\u4f8b"},{"location":"10_Test%20Scenarios/01_test_scenarios/","title":"Test Scenarios","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e \u79fb\u9664 Bookie \u76f8\u95dc\u6e2c\u8a66 <code>SelectedBookie</code>, <code>bookieDropdownTapped</code>, <code>bookieSelected</code> \u6e2c\u8a66\u5df2\u79fb\u9664 \u79fb\u9664 Config \u76f8\u95dc\u6e2c\u8a66 <code>LoadProviderConfig</code> \u6e2c\u8a66\u5df2\u79fb\u9664 \u65b0\u589e Tooltip \u6e2c\u8a66 \u65b0\u589e Tooltip \u986f\u793a\u908f\u8f2f\u6e2c\u8a66"},{"location":"10_Test%20Scenarios/01_test_scenarios/#_1","title":"\u6e2c\u8a66\u5206\u985e","text":"\u985e\u5225 \u7bc4\u570d \u5de5\u5177 Unit Test UseCase, Repository, Domain Model XCTest Integration Test Feature (TCA), API Client XCTest + TCA TestStore UI Test View \u4ea4\u4e92 XCUITest"},{"location":"10_Test%20Scenarios/01_test_scenarios/#unit-tests","title":"Unit Tests","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#1-widgetinputstate-tests","title":"1. WidgetInputState Tests","text":"<pre><code>class WidgetInputStateTests: XCTestCase {\n\n    func test_default_state_properties() {\n        let state = WidgetInputState.default\n\n        XCTAssertFalse(state.showFocusBorder)\n        XCTAssertFalse(state.showErrorBorder)\n        XCTAssertFalse(state.showClearButton)\n        XCTAssertFalse(state.isLoadButtonEnabled)\n    }\n\n    func test_focus_state_shows_border() {\n        let state = WidgetInputState.focus\n\n        XCTAssertTrue(state.showFocusBorder)\n        XCTAssertFalse(state.showErrorBorder)\n    }\n\n    func test_typing_state_enables_load_button() {\n        let state = WidgetInputState.typing\n\n        XCTAssertTrue(state.showFocusBorder)\n        XCTAssertTrue(state.showClearButton)\n        XCTAssertTrue(state.isLoadButtonEnabled)\n    }\n\n    func test_error_state_shows_red_border() {\n        let state = WidgetInputState.error(message: \"Error message\")\n\n        XCTAssertFalse(state.showFocusBorder)\n        XCTAssertTrue(state.showErrorBorder)\n        XCTAssertTrue(state.showClearButton)\n        XCTAssertEqual(state.errorMessage, \"Error message\")\n    }\n\n    func test_loading_state_disables_interactions() {\n        let state = WidgetInputState.loading\n\n        XCTAssertFalse(state.showClearButton)\n        XCTAssertFalse(state.isLoadButtonEnabled)\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#2-convertresult-tests","title":"2. ConvertResult Tests","text":"<pre><code>class ConvertResultTests: XCTestCase {\n\n    func test_hasPartialFailure_when_some_failed() {\n        let result = ConvertResult(\n            shareCode: \"ABC123\",\n            successCnt: 5,\n            failCnt: 2\n        )\n\n        XCTAssertTrue(result.hasPartialFailure)\n        XCTAssertFalse(result.isAllFailed)\n    }\n\n    func test_isAllFailed_when_all_failed() {\n        let result = ConvertResult(\n            shareCode: \"ABC123\",\n            successCnt: 0,\n            failCnt: 5\n        )\n\n        XCTAssertTrue(result.isAllFailed)\n        XCTAssertFalse(result.hasPartialFailure)\n    }\n\n    func test_success_when_no_failures() {\n        let result = ConvertResult(\n            shareCode: \"ABC123\",\n            successCnt: 5,\n            failCnt: 0\n        )\n\n        XCTAssertFalse(result.hasPartialFailure)\n        XCTAssertFalse(result.isAllFailed)\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#3-tooltipstorage-tests","title":"3. TooltipStorage Tests","text":"<pre><code>class TooltipStorageTests: XCTestCase {\n\n    var userDefaults: UserDefaults!\n    var storage: TooltipStorage!\n\n    override func setUp() {\n        super.setUp()\n        userDefaults = UserDefaults(suiteName: \"test\")\n        userDefaults.removePersistentDomain(forName: \"test\")\n        storage = TooltipStorage(userDefaults: userDefaults)\n    }\n\n    func test_shouldShowTooltip_returns_true_initially() {\n        XCTAssertTrue(storage.shouldShowTooltip)\n    }\n\n    func test_dismissTooltip_sets_flag() {\n        storage.dismissTooltip()\n\n        XCTAssertFalse(storage.shouldShowTooltip)\n    }\n\n    func test_shouldShowTooltip_persists_after_dismiss() {\n        storage.dismissTooltip()\n\n        // \u91cd\u65b0\u5275\u5efa storage \u6a21\u64ec app \u91cd\u555f\n        let newStorage = TooltipStorage(userDefaults: userDefaults)\n\n        XCTAssertFalse(newStorage.shouldShowTooltip)\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#tca-feature-tests","title":"TCA Feature Tests","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#1-happy-path-convert-booking-code","title":"1. Happy Path: Convert Booking Code","text":"<pre><code>@MainActor\nclass LoadCodeWidgetFeatureTests: XCTestCase {\n\n    func test_loadBookingCode_converts_and_presents_betslip() async {\n        let mockOutput = ConvertBookingCodeOutput(\n            convertResult: ConvertResult(shareCode: \"FCOM123\", successCnt: 5, failCnt: 0),\n            liabilities: .mock\n        )\n\n        let store = TestStore(initialState: LoadCodeWidget.State(\n            bookingCode: \"3RA3FA\",\n            enableCodeConverter: true\n        )) {\n            LoadCodeWidget.Feature()\n        } withDependencies: {\n            $0.convertBookingCodeUseCase = .init { _ in .success(mockOutput) }\n        }\n\n        await store.send(.loadBookingCode) {\n            $0.inputState = .loading\n            $0.isLoading = true\n        }\n\n        await store.receive(.convertCodeCompleted(.success(mockOutput))) {\n            $0.isLoading = false\n            $0.inputState = .filled\n            $0.bookingCode = \"\"\n            $0.convertResult = mockOutput.convertResult\n        }\n\n        await store.receive(.presentBetslip(shareCode: \"FCOM123\", failCnt: 0))\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#2-partial-success-shows-toast","title":"2. Partial Success: Shows Toast","text":"<pre><code>func test_loadBookingCode_partial_success_shows_toast() async {\n    let mockOutput = ConvertBookingCodeOutput(\n        convertResult: ConvertResult(shareCode: \"FCOM123\", successCnt: 3, failCnt: 2),\n        liabilities: .mock\n    )\n\n    let store = TestStore(initialState: LoadCodeWidget.State(\n        bookingCode: \"3RA3FA\",\n        enableCodeConverter: true\n    )) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.convertBookingCodeUseCase = .init { _ in .success(mockOutput) }\n    }\n\n    await store.send(.loadBookingCode) {\n        $0.inputState = .loading\n        $0.isLoading = true\n    }\n\n    await store.receive(.convertCodeCompleted(.success(mockOutput))) {\n        $0.isLoading = false\n        $0.inputState = .filled\n        $0.bookingCode = \"\"\n        $0.convertResult = mockOutput.convertResult\n    }\n\n    // failCnt &gt; 0\uff0c\u61c9\u986f\u793a Toast\n    await store.receive(.presentBetslip(shareCode: \"FCOM123\", failCnt: 2))\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#3-error-code-not-found","title":"3. Error: Code Not Found","text":"<pre><code>func test_loadBookingCode_codeNotFound_shows_error() async {\n    let store = TestStore(initialState: LoadCodeWidget.State(\n        bookingCode: \"INVALID\",\n        enableCodeConverter: true\n    )) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.convertBookingCodeUseCase = .init { _ in\n            .failure(CodeConverterError.codeNotFound)\n        }\n    }\n\n    await store.send(.loadBookingCode) {\n        $0.inputState = .loading\n        $0.isLoading = true\n    }\n\n    await store.receive(.convertCodeCompleted(.failure(CodeConverterError.codeNotFound))) {\n        $0.isLoading = false\n        $0.inputState = .error(message: \"We couldn't find this booking code. Please check and try again.\")\n        $0.errorMessage = \"We couldn't find this booking code. Please check and try again.\"\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#4-input-state-transitions","title":"4. Input State Transitions","text":"<pre><code>func test_inputState_transitions() async {\n    let store = TestStore(initialState: LoadCodeWidget.State(enableCodeConverter: true)) {\n        LoadCodeWidget.Feature()\n    }\n\n    // Default \u2192 Focus\n    await store.send(.inputFocused) {\n        $0.inputState = .focus\n    }\n\n    // Focus \u2192 Typing (when text entered)\n    await store.send(.bookingCodeChanged(\"3RA\")) {\n        $0.bookingCode = \"3RA\"\n        $0.inputState = .typing\n    }\n\n    // Typing \u2192 Focus (when cleared)\n    await store.send(.clearButtonTapped) {\n        $0.bookingCode = \"\"\n        $0.inputState = .focus\n        $0.errorMessage = nil\n    }\n\n    // Focus \u2192 Default (when blurred with no text)\n    await store.send(.inputBlurred) {\n        $0.inputState = .default\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#5-tooltip-tests","title":"5. Tooltip Tests","text":"<pre><code>func test_onAppear_shows_tooltip_if_not_dismissed() async {\n    let store = TestStore(initialState: LoadCodeWidget.State(enableCodeConverter: true)) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.tooltipStorage = TooltipStorage(shouldShowTooltip: true)\n    }\n\n    await store.send(.onAppear) {\n        $0.isTooltipVisible = true\n    }\n}\n\nfunc test_onAppear_hides_tooltip_if_dismissed() async {\n    let store = TestStore(initialState: LoadCodeWidget.State(enableCodeConverter: true)) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.tooltipStorage = TooltipStorage(shouldShowTooltip: false)\n    }\n\n    await store.send(.onAppear) {\n        $0.isTooltipVisible = false\n    }\n}\n\nfunc test_tooltipDismissed_hides_tooltip_and_persists() async {\n    var dismissCalled = false\n\n    let store = TestStore(initialState: LoadCodeWidget.State(\n        enableCodeConverter: true,\n        isTooltipVisible: true\n    )) {\n        LoadCodeWidget.Feature()\n    } withDependencies: {\n        $0.tooltipStorage = TooltipStorage(\n            shouldShowTooltip: true,\n            onDismiss: { dismissCalled = true }\n        )\n    }\n\n    await store.send(.tooltipDismissed) {\n        $0.isTooltipVisible = false\n    }\n\n    XCTAssertTrue(dismissCalled)\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#ui-tests","title":"UI Tests","text":""},{"location":"10_Test%20Scenarios/01_test_scenarios/#1-input-field-focus","title":"1. Input Field Focus","text":"<pre><code>func test_input_field_shows_green_border_when_focused() {\n    let app = XCUIApplication()\n    app.launch()\n\n    let inputField = app.textFields[\"bookingCodeInput\"]\n    inputField.tap()\n\n    // \u9a57\u8b49\u7da0\u8272\u908a\u6846\u5b58\u5728\uff08\u900f\u904e accessibility identifier\uff09\n    XCTAssertTrue(inputField.otherElements[\"focusBorder\"].exists)\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#2-clear-button","title":"2. Clear Button","text":"<pre><code>func test_clear_button_clears_input() {\n    let app = XCUIApplication()\n    app.launch()\n\n    let inputField = app.textFields[\"bookingCodeInput\"]\n    inputField.tap()\n    inputField.typeText(\"3RA3FA\")\n\n    let clearButton = app.buttons[\"clearButton\"]\n    XCTAssertTrue(clearButton.exists)\n\n    clearButton.tap()\n\n    XCTAssertEqual(inputField.value as? String, \"\")\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#3-tooltip","title":"3. Tooltip","text":"<pre><code>func test_tooltip_shows_on_first_launch() {\n    let app = XCUIApplication()\n    app.launchArguments.append(\"--reset-tooltip\")\n    app.launch()\n\n    let tooltip = app.staticTexts[\"Insert a booking code from any provider\"]\n    XCTAssertTrue(tooltip.waitForExistence(timeout: 2))\n\n    // \u9ede\u64ca\u95dc\u9589\n    app.buttons[\"tooltipCloseButton\"].tap()\n\n    XCTAssertFalse(tooltip.exists)\n}\n\nfunc test_tooltip_does_not_show_after_dismissed() {\n    let app = XCUIApplication()\n    // \u4e0d\u91cd\u7f6e tooltip\n    app.launch()\n\n    let tooltip = app.staticTexts[\"Insert a booking code from any provider\"]\n    XCTAssertFalse(tooltip.exists)\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#test-data-mocks","title":"Test Data Mocks","text":"<pre><code>extension ConvertResult {\n    static func mock(\n        shareCode: String = \"ABC123\",\n        successCnt: Int = 5,\n        failCnt: Int = 0\n    ) -&gt; Self {\n        Self(\n            shareCode: shareCode,\n            successCnt: successCnt,\n            failCnt: failCnt\n        )\n    }\n}\n\nextension LiabilitiesResult {\n    static var mock: Self {\n        Self(isValid: true, liabilities: [])\n    }\n}\n\nextension TooltipStorage {\n    init(shouldShowTooltip: Bool, onDismiss: @escaping () -&gt; Void = {}) {\n        self._shouldShowTooltip = shouldShowTooltip\n        self._onDismiss = onDismiss\n    }\n}\n</code></pre>"},{"location":"10_Test%20Scenarios/01_test_scenarios/#_2","title":"\u5ee2\u68c4\u7684\u6e2c\u8a66","text":"\u6e2c\u8a66 \u539f\u56e0 <code>SelectedBookieTests</code> <code>SelectedBookie</code> \u5df2\u5ee2\u68c4 <code>test_bookieDropdownTapped_loads_config</code> Bookie Dropdown \u5df2\u79fb\u9664 <code>test_bookieSelected_updates_state</code> Bookie \u9078\u64c7\u5df2\u79fb\u9664 <code>LoadProviderConfigUseCaseTests</code> Config API \u5df2\u5ee2\u68c4"},{"location":"11_Risks%20and%20Questions/","title":"11_Risks and Questions","text":"<p>\u672c\u7ae0\u7bc0\u8a18\u9304\u5f85\u78ba\u8a8d\u4e8b\u9805\u8207\u6f5b\u5728\u98a8\u96aa\u3002</p>"},{"location":"11_Risks%20and%20Questions/#_1","title":"\u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_risks_and_questions.md \u5f85\u78ba\u8a8d\u4e8b\u9805\u8207\u98a8\u96aa\u5217\u8868"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/","title":"Risks and Questions","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#be-2025-01-14","title":"\u26a0\ufe0f BE \u65b0\u8a2d\u8a08\u66f4\u65b0 (2025-01-14)","text":"\u8b8a\u66f4\u9805\u76ee \u8aaa\u660e \u79fb\u9664 Config API \u76f8\u95dc\u554f\u984c Provider Config API \u5df2\u5ee2\u68c4 \u79fb\u9664 Bookie \u9078\u64c7\u76f8\u95dc\u554f\u984c \u4e0d\u518d\u9700\u8981\u9078\u64c7 Bookie/Country \u65b0\u589e Tooltip \u76f8\u95dc\u554f\u984c \u65b0\u589e\u4e00\u6b21\u6027 Tooltip \u529f\u80fd"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_1","title":"\u5f85\u78ba\u8a8d\u4e8b\u9805","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#1","title":"1. \u5411\u5f8c\u76f8\u5bb9\u6027","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 <code>LoadCodeManager</code> \u662f\u5426\u9700\u8981\u4fee\u6539\uff1f \u73fe\u6709 <code>LoadBookingCodeSection.Feature</code> \u4f9d\u8cf4 <code>LoadCodeManager</code> \u5982\u9700\u4fee\u6539\u53ef\u80fd\u5f71\u97ff\u5176\u4ed6\u4f7f\u7528\u8005 \u4fdd\u6301 <code>LoadCodeManager</code> \u4e0d\u8b8a\uff0c\u65b0\u908f\u8f2f\u8d70 UseCase <code>enableCodeConverter</code> \u9810\u8a2d\u503c\uff1f \u6c7a\u5b9a\u65b0\u529f\u80fd\u7684\u555f\u7528\u7b56\u7565 \u5f71\u97ff rollout \u8a08\u756b \u5efa\u8b70\u9810\u8a2d <code>false</code>\uff0c\u9010\u6b65\u958b\u555f"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#2-api","title":"2. API \u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 <code>POST /orders/converter/code</code> \u8fd4\u56de\u7684 <code>shareCode</code> \u662f\u5426\u53ea\u5305\u542b\u6210\u529f\u7684 selections\uff1f \u90e8\u5206\u5931\u6557\u6642\u9700\u8981\u77e5\u9053\u5982\u4f55\u8f09\u5165 Betslip \u5f71\u97ff Betslip \u986f\u793a \u8207\u5f8c\u7aef\u78ba\u8a8d BE \u5982\u4f55\u8b58\u5225 Provider\uff1f \u65b0\u8a2d\u8a08\u4e0d\u9700\u50b3\u5165 provider/country \u9700\u78ba\u8a8d\u8b58\u5225\u908f\u8f2f \u8207\u5f8c\u7aef\u78ba\u8a8d API \u6700\u9577\u7b49\u5f85\u6642\u9593\uff1f \u8f49\u63db\u53ef\u80fd\u9700\u8981\u8f03\u9577\u6642\u9593 \u5f71\u97ff Timeout \u8a2d\u7f6e \u5efa\u8b70 30 \u79d2 timeout"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#3-uiux","title":"3. UI/UX \u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 Partial Failure Toast \u986f\u793a\u6642\u9577\uff1f \u9700\u8981\u8b93\u7528\u6236\u6ce8\u610f\u5230\u90e8\u5206\u5931\u6557 \u5f71\u97ff\u7528\u6236\u611f\u77e5 \u5efa\u8b70 3 \u79d2\u81ea\u52d5\u6d88\u5931 Tooltip \u5167\u5bb9\uff1f \u9700\u78ba\u8a8d\u8aaa\u660e\u6587\u5b57 \u5f71\u97ff\u7528\u6236\u7406\u89e3 \u8207 UED \u78ba\u8a8d\u6700\u7d42\u6587\u6848 Tooltip \u6a23\u5f0f\u898f\u683c\uff1f Figma \u8a2d\u8a08\u7a3f\u5f85\u88dc \u5f71\u97ff UI \u5be6\u4f5c \u7b49\u5f85\u8a2d\u8a08\u7a3f\u66f4\u65b0"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#4-tooltip","title":"4. Tooltip \u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 Device ID \u53d6\u5f97\u65b9\u5f0f\uff1f \u9700\u8981\u5224\u65b7\u662f\u5426\u540c\u4e00\u88dd\u7f6e \u5f71\u97ff Tooltip \u6301\u4e45\u5316 \u4f7f\u7528 <code>identifierForVendor</code> \u6216 UserDefaults \u8de8 App \u7248\u672c\u884c\u70ba\uff1f \u7528\u6236\u66f4\u65b0 App \u5f8c\u662f\u5426\u91cd\u65b0\u986f\u793a\uff1f \u5f71\u97ff\u7528\u6236\u9ad4\u9a57 UserDefaults \u6703\u4fdd\u7559\uff0c\u4e0d\u6703\u91cd\u65b0\u986f\u793a \u91cd\u88dd App \u884c\u70ba\uff1f \u7528\u6236\u91cd\u88dd\u5f8c\u662f\u5426\u91cd\u65b0\u986f\u793a\uff1f \u5f71\u97ff\u7528\u6236\u9ad4\u9a57 UserDefaults \u6703\u91cd\u7f6e\uff0c\u6703\u91cd\u65b0\u986f\u793a"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#5","title":"5. \u6548\u80fd\u76f8\u95dc","text":"\u554f\u984c \u80cc\u666f \u5f71\u97ff \u5efa\u8b70 \u8f49\u63db API \u6700\u9577\u8017\u6642\uff1f PRD \u63d0\u5230\u53ef\u80fd\u9700\u8981 10 \u79d2 \u5f71\u97ff Loading \u63d0\u793a \u986f\u793a \"Conversion may take up to 10 seconds\" \u63d0\u793a Timeout \u8a2d\u7f6e\uff1f \u9700\u8981\u5408\u7406\u7684\u8d85\u6642\u6642\u9593 \u5f71\u97ff\u932f\u8aa4\u8655\u7406 \u5efa\u8b70 30 \u79d2 timeout"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_2","title":"\u98a8\u96aa\u8a55\u4f30","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_3","title":"\u9ad8\u98a8\u96aa","text":"\u98a8\u96aa \u63cf\u8ff0 \u7de9\u89e3\u63aa\u65bd \u539f\u6709\u529f\u80fd regression \u64f4\u5c55 <code>LoadBookingCodeSectionView</code> \u53ef\u80fd\u5f71\u97ff\u9996\u9801 Widget \u5b8c\u6574\u7684\u55ae\u5143\u6e2c\u8a66 + <code>enableCodeConverter = false</code> \u6642\u5b8c\u5168\u8d70\u539f\u6709\u908f\u8f2f API \u683c\u5f0f\u4e0d\u5339\u914d DTO \u5b9a\u7fa9\u8207\u5be6\u969b API \u4e0d\u7b26 \u8207\u5f8c\u7aef\u540c\u6b65 API \u6587\u6a94\uff0c\u589e\u52a0 Response \u9a57\u8b49"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_4","title":"\u4e2d\u98a8\u96aa","text":"\u98a8\u96aa \u63cf\u8ff0 \u7de9\u89e3\u63aa\u65bd Betslip \u5c0e\u822a\u5931\u6557 \u8f49\u63db\u6210\u529f\u4f46 Betslip \u8f09\u5165\u5931\u6557 \u589e\u52a0\u932f\u8aa4\u8655\u7406\uff0c\u56de\u6efe\u5230 Error \u72c0\u614b Tooltip \u8de8\u5165\u53e3\u540c\u6b65 \u591a\u500b\u5165\u53e3\u9700\u8981\u540c\u6b65 Tooltip \u72c0\u614b \u4f7f\u7528\u7d71\u4e00\u7684 TooltipStorage"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_5","title":"\u4f4e\u98a8\u96aa","text":"\u98a8\u96aa \u63cf\u8ff0 \u7de9\u89e3\u63aa\u65bd UI \u72c0\u614b\u4e0d\u4e00\u81f4 \u5feb\u901f\u64cd\u4f5c\u53ef\u80fd\u5c0e\u81f4\u72c0\u614b\u6df7\u4e82 TCA \u4fdd\u8b49\u72c0\u614b\u4e00\u81f4\u6027 \u9577\u6642\u9593 Loading \u7528\u6236\u53ef\u80fd\u96e2\u958b\u9801\u9762 \u63d0\u793a\u6587\u5b57 + \u8003\u616e\u80cc\u666f\u8655\u7406"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_6","title":"\u4f9d\u8cf4\u9805","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_7","title":"\u5916\u90e8\u4f9d\u8cf4","text":"\u4f9d\u8cf4 \u72c0\u614b \u8ca0\u8cac\u5718\u968a \u5099\u8a3b <code>POST /orders/converter/code</code> \u2705 \u5df2\u78ba\u8a8d Backend \u53ea\u9700 bookingCode \u53c3\u6578 ~~<code>GET /orders/converter/config/providerCountries</code>~~ \u274c \u5ee2\u68c4 Backend \u4e0d\u518d\u9700\u8981 Figma \u8a2d\u8a08\u7a3f \u26a0\ufe0f \u5f85\u66f4\u65b0 Design Tooltip \u8a2d\u8a08\u5f85\u88dc"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_8","title":"\u5167\u90e8\u4f9d\u8cf4","text":"\u4f9d\u8cf4 \u72c0\u614b \u5099\u8a3b <code>BetslipRepository</code> \u2705 \u65e2\u6709 \u7528\u65bc Liabilities \u6aa2\u67e5 <code>LoadCodeManager</code> \u2705 \u65e2\u6709 \u4fdd\u6301\u4e0d\u8b8a\uff0c\u5411\u5f8c\u76f8\u5bb9 <code>UserDefaults</code> \u2705 \u65e2\u6709 \u7528\u65bc Tooltip \u72c0\u614b\u5132\u5b58"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_9","title":"\u958b\u653e\u6027\u554f\u984c","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_10","title":"\u7522\u54c1\u5c64\u9762","text":"<ol> <li>Feature Flag \u7b56\u7565\uff1aCode Converter \u529f\u80fd\u662f\u5426\u9700\u8981 Remote Config \u63a7\u5236\u958b\u95dc\uff1f</li> <li>\u7528\u6236\u5206\u7fa4\uff1a\u662f\u5426\u53ea\u5c0d\u7279\u5b9a\u570b\u5bb6/\u7528\u6236\u958b\u653e\uff1f</li> <li>Analytics\uff1a\u9700\u8981\u8ffd\u8e64\u54ea\u4e9b GA Events\uff1f</li> </ol>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_11","title":"\u6280\u8853\u5c64\u9762","text":"<ol> <li>\u96e2\u7dda\u652f\u63f4\uff1a\u96e2\u7dda\u6642\u662f\u5426\u9700\u8981 graceful degradation\uff1f</li> <li>\u6df1\u9023\u7d50\uff1a\u662f\u5426\u9700\u8981\u652f\u63f4\u6df1\u9023\u7d50\u76f4\u63a5\u5e36\u5165 Booking Code\uff1f</li> <li>Tooltip \u52d5\u756b\uff1a\u662f\u5426\u9700\u8981\u5165\u5834/\u51fa\u5834\u52d5\u756b\uff1f</li> </ol>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_12","title":"\u5f8c\u7e8c\u8fed\u4ee3\u8003\u91cf","text":""},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#phase-2-ocr2code","title":"Phase 2: OCR2Code\uff08\u9810\u7559\uff09","text":"<ul> <li>\u9700\u8981\u589e\u52a0\u76f8\u6a5f/\u5716\u7247\u9078\u64c7\u529f\u80fd</li> <li>\u53ef\u80fd\u9700\u8981\u65b0\u7684 UI \u5165\u53e3</li> <li>UseCase \u53ef\u5fa9\u7528\uff0c\u53ea\u9700\u65b0\u589e OCR \u524d\u8655\u7406</li> </ul>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#phase-3-prompt2code","title":"Phase 3: Prompt2Code\uff08\u9810\u7559\uff09","text":"<ul> <li>\u9700\u8981\u6574\u5408 LLM/AI \u670d\u52d9</li> <li>\u53ef\u80fd\u9700\u8981\u5c0d\u8a71\u5f0f UI</li> <li>\u8003\u616e Streaming Response</li> </ul>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#checklist","title":"Checklist\uff08\u958b\u767c\u524d\u78ba\u8a8d\uff09","text":"<ul> <li> \u8207\u5f8c\u7aef\u78ba\u8a8d API Response \u5b8c\u6574\u683c\u5f0f</li> <li> \u78ba\u8a8d\u4e0d\u518d\u9700\u8981 Provider/Country \u9078\u64c7</li> <li> \u8207\u8a2d\u8a08\u78ba\u8a8d Tooltip \u6a23\u5f0f\u898f\u683c</li> <li> \u78ba\u8a8d Feature Flag \u9700\u6c42</li> <li> \u78ba\u8a8d Analytics Events \u6e05\u55ae</li> <li> \u78ba\u8a8d Timeout \u8207\u91cd\u8a66\u7b56\u7565</li> </ul>"},{"location":"11_Risks%20and%20Questions/01_risks_and_questions/#_13","title":"\u5ee2\u68c4\u9805\u76ee\u6e05\u55ae","text":"\u9805\u76ee \u985e\u578b \u539f\u56e0 Config API \u76f8\u95dc\u554f\u984c \u5f85\u78ba\u8a8d\u4e8b\u9805 API \u5df2\u5ee2\u68c4 Bookie \u9078\u64c7\u4ea4\u4e92\u554f\u984c \u5f85\u78ba\u8a8d\u4e8b\u9805 \u4e0d\u518d\u9700\u8981\u9078\u64c7 Provider Config \u7de9\u5b58\u554f\u984c \u5f85\u78ba\u8a8d\u4e8b\u9805 \u4e0d\u518d\u9700\u8981 Config \u591a\u570b\u5bb6 Bookie UI \u554f\u984c \u5f85\u78ba\u8a8d\u4e8b\u9805 \u4e0d\u518d\u9700\u8981\u9078\u64c7\u570b\u5bb6"},{"location":"12_Sprint%20Plan/","title":"12. Sprint Plan","text":"<p>\u6b64\u8cc7\u6599\u593e\u5305\u542b Code Converter Phase 1 \u7684 Sprint \u898f\u5283\u6587\u4ef6\u3002</p>"},{"location":"12_Sprint%20Plan/#_1","title":"\ud83d\udcc4 \u6587\u4ef6\u5217\u8868","text":"\u6587\u4ef6 \u8aaa\u660e 01_5day_sprint_plan.md 5 \u5929 Sprint \u8a73\u7d30\u898f\u5283\uff0c\u5305\u542b\u6240\u6709 Jira Tickets"},{"location":"12_Sprint%20Plan/#sprint","title":"\ud83c\udfaf Sprint \u76ee\u6a19","text":"<ul> <li>\u671f\u9593: 2025-01-07 ~ 2025-01-13 (5 \u5de5\u4f5c\u5929)</li> <li>\u76ee\u6a19: \u5b8c\u6210 Code Converter Phase 1 (Code2Code) \u6838\u5fc3\u529f\u80fd</li> </ul>"},{"location":"12_Sprint%20Plan/#_2","title":"\ud83d\udcca \u6bcf\u65e5\u4e3b\u984c","text":"Day \u4e3b\u984c Day 1 \u57fa\u790e\u67b6\u69cb + UI \u9aa8\u67b6 Day 2 Bookie Selector + Config API Day 3 Convert API \u6574\u5408 Day 4 Betslip \u4e32\u63a5 + \u7d50\u679c\u986f\u793a Day 5 \u932f\u8aa4\u8655\u7406 + \u6e2c\u8a66 + Polish"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/","title":"Code Converter Phase 1 - 5 Day Sprint Plan","text":"<p>Sprint \u671f\u9593: 2025-01-15 (\u9031\u4e09) ~ 2025-01-21 (\u9031\u4e8c\uff0c\u8df3\u904e\u9031\u672b) Epic: FOOTBALL-9161 - Booking Code Converter \u958b\u767c\u8005: @Reed Hsin \u6700\u5f8c\u66f4\u65b0: 2025-01-14</p> <p>BE \u65b0\u8a2d\u8a08\u66f4\u65b0\uff1a - \u4e0d\u518d\u9700\u8981 Provider/Country \u9078\u64c7 - Config API \u5df2\u5ee2\u68c4 - Convert API \u53ea\u9700\u50b3\u5165 <code>bookingCode</code> - \u65b0\u589e\u4e00\u6b21\u6027 Tooltip \u986f\u793a\u908f\u8f2f</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#sprint","title":"\ud83d\udcca Sprint \u7e3d\u89bd","text":"Day \u65e5\u671f \u4e3b\u984c Story Points Day 1 01/15 (\u4e09) \u57fa\u790e\u67b6\u69cb + UI \u9aa8\u67b6 5 Day 2 01/16 (\u56db) Convert API \u6574\u5408 5 Day 3 01/17 (\u4e94) Betslip \u4e32\u63a5 + \u7d50\u679c\u986f\u793a 5 Day 4 01/20 (\u4e00) Tooltip + \u932f\u8aa4\u8655\u7406 5 Day 5 01/21 (\u4e8c) \u6e2c\u8a66 + Polish 5 <p>Total: 25 Story Points</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#jira-tickets","title":"\ud83d\udccb Jira Tickets \u8a73\u7d30\u898f\u5283","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-1-ui-0115","title":"Day 1: \u57fa\u790e\u67b6\u69cb + UI \u9aa8\u67b6 (01/15)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-module","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Module \u67b6\u69cb\u8a2d\u5b9a","text":"<p>Type: Task Story Points: 1 Labels: <code>architecture</code>, <code>setup</code></p> <p>Description: \u8a2d\u5b9a Code Converter \u529f\u80fd\u7684 Module \u67b6\u69cb\uff0c\u5305\u542b\u8cc7\u6599\u593e\u7d50\u69cb\u548c\u57fa\u672c\u6a94\u6848\u3002</p> <p>Acceptance Criteria: - [ ] \u5efa\u7acb <code>CodeConverter/</code> \u8cc7\u6599\u593e\u7d50\u69cb   - <code>Feature/</code>   - <code>View/</code>   - <code>UseCase/</code>   - <code>Repository/</code>   - <code>Client/</code>   - <code>Model/</code> - [ ] \u5efa\u7acb <code>CodeConverterAPI.swift</code> \u6a94\u6848 (\u7a7a\u6bbc) - [ ] \u5efa\u7acb <code>CodeConverterClient.swift</code> \u6a94\u6848 (\u7a7a\u6bbc)</p> <p>Reference: - TDD: <code>02_Architecture/01_clean_architecture_diagram.md</code> - TDD: <code>03_Module Responsibility/01_module_responsibility.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-loadbookingcodesectionview-ui","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - LoadBookingCodeSectionView \u57fa\u790e UI","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>view</code></p> <p>Description: \u5be6\u4f5c Load Code Widget \u7684\u4e3b\u8981\u5bb9\u5668\u8996\u5716\uff08\u7c21\u5316\u7248\uff0c\u7121 Bookie Dropdown\uff09\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>LoadBookingCodeSectionView</code> \u4e3b\u8996\u5716   - \u5305\u542b <code>BookingCodeInputView</code>   - \u80cc\u666f\u8272: <code>Color.backgroundType1Tertiary</code>   - CornerRadius: 10   - Padding: 8 - [ ] \u5be6\u4f5c\u5e95\u90e8\u932f\u8aa4\u8a0a\u606f\u5340\u57df - [ ] SwiftUI Preview \u53ef\u6b63\u5e38\u986f\u793a</p> <p>Figma Reference: - Node: <code>26769-88873</code> (Default State) - Node: <code>26342-46244</code> (Component Set)</p> <p>Reference: - TDD: <code>05_Module Sequence Diagram/LoadBookingCodeSection/01_view_implementation.md</code> - TDD: <code>05_Module Sequence Diagram/LoadBookingCodeSection/02_view_design_specs.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-bookingcodeinputview","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - BookingCodeInputView","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>view</code>, <code>component</code></p> <p>Description: \u5be6\u4f5c Booking Code \u8f38\u5165\u6b04\u4f4d\u5143\u4ef6\u3002</p> <p>Acceptance Criteria: - [ ] \u652f\u63f4\u4ee5\u4e0b\u72c0\u614b:   - Default (placeholder \u986f\u793a)   - Focus (\u7de8\u8f2f\u4e2d)   - Typing (\u8f38\u5165\u4e2d)   - Filled (\u5df2\u586b\u5beb)   - Loading (API \u8acb\u6c42\u4e2d)   - Error (\u986f\u793a\u932f\u8aa4) - [ ] \u53f3\u5074 \"Load\" \u6309\u9215   - \u555f\u7528\u6642: <code>Color.brandSecondary</code>   - \u505c\u7528\u6642: <code>Color.brandSecondaryDisable</code> - [ ] \u6e05\u9664\u6309\u9215 (Typing/Filled \u72c0\u614b) - [ ] \u5b57\u578b: <code>Font.b1_m</code></p> <p>Figma Reference: - Node: <code>26769-88873</code> (Default) - Node: <code>26769-88868</code> (Focus) - Node: <code>26769-88869</code> (Typing) - Node: <code>26769-88870</code> (Filled) - Node: <code>26769-88872</code> (Loading) - Node: <code>26769-88871</code> (Error)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-2-convert-api-0116","title":"Day 2: Convert API \u6574\u5408 (01/16)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-convertbookingcodeusecase","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - ConvertBookingCodeUseCase","text":"<p>Type: Story Story Points: 1 Labels: <code>usecase</code>, <code>domain</code></p> <p>Description: \u5be6\u4f5c\u8f49\u63db Booking Code \u7684 UseCase\uff08\u7c21\u5316\u7248\uff09\u3002</p> <p>Acceptance Criteria: - [ ] Input: <code>ConvertBookingCodeInput</code> (\u53ea\u9700 <code>bookingCode</code>) - [ ] Output: <code>ConvertBookingCodeOutput</code> (shareCode, successCnt, failCnt) - [ ] \u8abf\u7528 <code>CodeConverterRepository.convertCode()</code> - [ ] \u932f\u8aa4\u8655\u7406</p> <p>API Reference: - <code>POST /orders/converter/code</code> - Request: <code>{ bookingCode }</code></p> <p>Reference: - TDD: <code>07_UseCase Input and Output Model/01_usecase_input_output.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-codeconverterrepository","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - CodeConverterRepository","text":"<p>Type: Story Story Points: 1 Labels: <code>repository</code>, <code>data</code></p> <p>Description: \u5be6\u4f5c Repository \u5c64\u7684 Convert API \u547c\u53eb\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>convertCode(bookingCode:)</code> \u65b9\u6cd5 - [ ] DTO to Domain Model \u8f49\u63db - [ ] \u932f\u8aa4\u8655\u7406\u8207\u56de\u50b3</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-codeconverterclient","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - CodeConverterClient","text":"<p>Type: Story Story Points: 1 Labels: <code>client</code>, <code>network</code></p> <p>Description: \u5be6\u4f5c Client \u5c64\u7684 Convert API \u7db2\u8def\u8acb\u6c42\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>convertCode(request:)</code> \u65b9\u6cd5 - [ ] Method: <code>POST</code> - [ ] Endpoint: <code>/orders/converter/code</code> - [ ] Request Body: <code>{ bookingCode }</code> - [ ] Response DTO: <code>Code2CodeResponse</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-tca-feature","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - TCA Feature \u6574\u5408","text":"<p>Type: Story Story Points: 2 Labels: <code>tca</code>, <code>feature</code></p> <p>Description: \u6574\u5408 TCA Feature State \u548c Action\uff08\u7c21\u5316\u7248\uff09\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>LoadBookingCodeSection.Feature.State</code> \u65b0\u589e\u5c6c\u6027   - <code>bookingCode: String</code>   - <code>conversionState: ConversionState</code>   - <code>isTooltipVisible: Bool</code>   - <code>hasTooltipBeenDismissed: Bool</code> - [ ] \u5be6\u4f5c <code>LoadBookingCodeSection.Feature.Action</code> \u65b0\u589e\u9805\u76ee   - <code>.bookingCodeChanged(String)</code>   - <code>.clearButtonTapped</code>   - <code>.loadButtonTapped</code>   - <code>.convertResponse(Result&lt;...&gt;)</code>   - <code>.tooltipDismissed</code> - [ ] Reducer \u908f\u8f2f\u5be6\u4f5c</p> <p>Reference: - TDD: <code>06_Feature State and Action (TCA)/01_feature_state_action.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-3-betslip-0117","title":"Day 3: Betslip \u4e32\u63a5 + \u7d50\u679c\u986f\u793a (01/17)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-betslip","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Betslip \u6d41\u7a0b\u4e32\u63a5","text":"<p>Type: Story Story Points: 2 Labels: <code>integration</code>, <code>betslip</code></p> <p>Description: \u5c07\u8f49\u63db\u6210\u529f\u5f8c\u7684 shareCode \u4e32\u63a5\u5230\u65e2\u6709 Betslip \u6d41\u7a0b\u3002</p> <p>Acceptance Criteria: - [ ] Convert API \u6210\u529f\u5f8c:   1. \u8a18\u9304 <code>failCnt</code> \u7528\u65bc\u5f8c\u7e8c Toast \u986f\u793a   2. \u547c\u53eb <code>GET /bookingCode/[shareCode]/liabilities</code> [\u65e2\u6709\u6d41\u7a0b]   3. \u547c\u53eb <code>GET /orders/share/[shareCode]</code> [\u65e2\u6709\u6d41\u7a0b]   4. Pop up Betslip \u4e26\u986f\u793a\u8f49\u63db\u7d50\u679c - [ ] \u4f7f\u7528\u65e2\u6709\u7684 <code>BetslipRepository</code> / <code>BetslipClient</code> - [ ] \u932f\u8aa4\u6642\u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI</p> <p>Reference: - TDD: <code>01_Integrated Service-Level Sequence Diagram/01_full_integration_flow.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-partialerrortoast","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - PartialErrorToast","text":"<p>Type: Story Story Points: 1 Labels: <code>ui</code>, <code>component</code>, <code>toast</code></p> <p>Description: \u5be6\u4f5c\u90e8\u5206\u8f49\u63db\u5931\u6557\u7684 Toast \u63d0\u793a\u3002</p> <p>Acceptance Criteria: - [ ] \u7576 <code>failCnt &gt; 0</code> \u6642\u986f\u793a - [ ] \u986f\u793a\u5931\u6557\u6578\u91cf: \"X selections failed to convert\" - [ ] \u81ea\u52d5\u6d88\u5931 (3 \u79d2) - [ ] \u5e95\u90e8\u986f\u793a\uff0c\u4e0d\u906e\u64cb Betslip \u5167\u5bb9</p> <p>Figma Reference: - Node: <code>26428-71769</code> (Partial)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-ui","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - \u8f49\u63db\u7d50\u679c UI \u72c0\u614b","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>state</code></p> <p>Description: \u5be6\u4f5c\u8f49\u63db\u7d50\u679c\u7684\u5404\u7a2e UI \u72c0\u614b\u3002</p> <p>Acceptance Criteria: - [ ] \u5b8c\u5168\u6210\u529f: Betslip \u6b63\u5e38\u986f\u793a\u6240\u6709 selections - [ ] \u90e8\u5206\u6210\u529f: Betslip \u986f\u793a + PartialErrorToast - [ ] \u5b8c\u5168\u5931\u6557: \u986f\u793a 1.0.6 Error UI</p> <p>Figma Reference: - Node: <code>26428-71768</code> (Success) - Node: <code>26428-71769</code> (Partial) - Node: <code>26769-88871</code> (Error)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-4-tooltip-0120","title":"Day 4: Tooltip + \u932f\u8aa4\u8655\u7406 (01/20)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-tooltip","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Tooltip \u5143\u4ef6","text":"<p>Type: Story Story Points: 2 Labels: <code>ui</code>, <code>component</code>, <code>tooltip</code></p> <p>Description: \u5be6\u4f5c\u4e00\u6b21\u6027\u8aaa\u660e Tooltip\u3002</p> <p>Acceptance Criteria: - [ ] \u9996\u6b21\u958b\u555f\u5305\u542b Widget \u7684\u9801\u9762\u6642\u986f\u793a - [ ] \u9ede\u64ca\u95dc\u9589\u5f8c\u6c38\u4e45\u4e0d\u518d\u986f\u793a - [ ] \u4ee5 Device ID \u8a18\u9304\u986f\u793a\u72c0\u614b\uff08\u4f7f\u7528 UserDefaults\uff09 - [ ] \u8de8\u9801\u9762\u540c\u6b65\uff08\u4efb\u4e00\u9801\u9762\u95dc\u9589\u5f8c\uff0c\u5176\u4ed6\u9801\u9762\u4e5f\u4e0d\u518d\u986f\u793a\uff09 - [ ] Tooltip \u6307\u5411 Load Code Widget</p> <p>Reference: - TDD: <code>05_Module Sequence Diagram/Module Sequence Diagrams/04_tooltip_display_logic.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - \u5b8c\u6574\u932f\u8aa4\u8655\u7406","text":"<p>Type: Story Story Points: 2 Labels: <code>error-handling</code></p> <p>Description: \u5be6\u4f5c\u5b8c\u6574\u7684\u932f\u8aa4\u8655\u7406\u908f\u8f2f\u3002</p> <p>Acceptance Criteria: - [ ] Convert API \u5931\u6557: \u986f\u793a API \u932f\u8aa4\u8a0a\u606f (1.0.6 Error)   - CODE_NOT_FOUND: \"We couldn't find this booking code\"   - TIMEOUT: \"Request timed out\"   - INTERNAL_ERROR: \u901a\u7528\u932f\u8aa4\u8a0a\u606f - [ ] Liabilities API \u5931\u6557: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI - [ ] Betslip API \u5931\u6557: \u6309\u7167 Betslip \u65e2\u6709\u6d41\u7a0b\u986f\u793a\u932f\u8aa4 UI - [ ] \u7db2\u8def\u932f\u8aa4\u8655\u7406</p> <p>Reference: - TDD: <code>09_Error Handling/01_error_handling.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-tooltipstorageclient","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - TooltipStorageClient","text":"<p>Type: Task Story Points: 1 Labels: <code>client</code>, <code>storage</code></p> <p>Description: \u5be6\u4f5c Tooltip \u986f\u793a\u72c0\u614b\u7684\u672c\u5730\u5132\u5b58\u3002</p> <p>Acceptance Criteria: - [ ] \u5be6\u4f5c <code>TooltipStorageClient</code> \u4f7f\u7528 UserDefaults - [ ] \u5132\u5b58 key: \u4ee5 Device ID \u70ba\u57fa\u790e - [ ] \u652f\u63f4 <code>hasBeenDismissed()</code> \u8b80\u53d6 - [ ] \u652f\u63f4 <code>setDismissed()</code> \u5beb\u5165</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#day-5-polish-0121","title":"Day 5: \u6e2c\u8a66 + Polish (01/21)","text":""},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-unit-tests","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Unit Tests","text":"<p>Type: Task Story Points: 2 Labels: <code>testing</code>, <code>unit-test</code></p> <p>Description: \u64b0\u5beb\u6838\u5fc3\u908f\u8f2f\u7684 Unit Tests\u3002</p> <p>Acceptance Criteria: - [ ] <code>ConvertBookingCodeUseCase</code> tests   - \u6210\u529f\u8f49\u63db   - \u90e8\u5206\u8f49\u63db   - \u8f49\u63db\u5931\u6557   - \u7db2\u8def\u932f\u8aa4 - [ ] <code>LoadBookingCodeSection.Feature</code> reducer tests   - \u8f38\u5165\u8b8a\u66f4   - \u8f49\u63db\u6210\u529f/\u90e8\u5206\u6210\u529f/\u5931\u6557   - Tooltip \u908f\u8f2f - [ ] <code>TooltipStorageClient</code> tests</p> <p>Reference: - TDD: <code>10_Test Scenarios/01_test_scenarios.md</code></p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-ui-polish-review","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - UI Polish &amp; Review","text":"<p>Type: Task Story Points: 2 Labels: <code>polish</code>, <code>review</code></p> <p>Description: \u6700\u7d42 UI \u8abf\u6574\u548c\u7a0b\u5f0f\u78bc Review\u3002</p> <p>Acceptance Criteria: - [ ] \u5c0d\u7167 Figma \u6aa2\u67e5\u6240\u6709 UI \u72c0\u614b - [ ] \u52d5\u756b\u548c\u8f49\u5834\u6548\u679c - [ ] Loading \u72c0\u614b\u7684\u63d0\u793a\u6587\u5b57 - [ ] Error \u72c0\u614b\u7684\u7d05\u8272\u908a\u6846\u548c\u932f\u8aa4\u8a0a\u606f - [ ] Code Review \u4fee\u6539 - [ ] \u6587\u4ef6\u66f4\u65b0 (\u5982\u6709\u9700\u8981)</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#football-xxxx-ios-code-converter-integration-testing","title":"\ud83c\udfab FOOTBALL-XXXX: [iOS] Code Converter - Integration Testing","text":"<p>Type: Task Story Points: 1 Labels: <code>testing</code>, <code>integration</code></p> <p>Description: \u6574\u5408\u6e2c\u8a66\u78ba\u4fdd\u5b8c\u6574\u6d41\u7a0b\u6b63\u5e38\u904b\u4f5c\u3002</p> <p>Acceptance Criteria: - [ ] \u5b8c\u6574\u8f49\u63db\u6d41\u7a0b E2E \u6e2c\u8a66 - [ ] \u8207 Betslip \u65e2\u6709\u6d41\u7a0b\u6574\u5408\u6e2c\u8a66 - [ ] Tooltip \u986f\u793a\u908f\u8f2f\u6e2c\u8a66 - [ ] \u932f\u8aa4\u8655\u7406\u6d41\u7a0b\u6e2c\u8a66</p>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#sprint-burndown","title":"\ud83d\udcca Sprint Burndown \u8ffd\u8e64","text":"Day \u5b8c\u6210 Tickets \u7d2f\u8a08 SP \u5269\u9918 SP Day 1 25 Day 2 Day 3 Day 4 Day 5 0"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#_1","title":"\ud83d\udea8 \u98a8\u96aa\u8207\u963b\u585e","text":"\u98a8\u96aa \u5f71\u97ff \u7de9\u89e3\u63aa\u65bd BE API \u5c1a\u672a\u5b8c\u6210 \u7121\u6cd5\u9032\u884c\u6574\u5408\u6e2c\u8a66 \u4f7f\u7528 Mock Data \u958b\u767c Figma Tooltip \u8a2d\u8a08\u4e0d\u660e\u78ba UI \u5be6\u4f5c\u5ef6\u9072 \u63d0\u524d\u8207 UED \u78ba\u8a8d \u65e2\u6709 Betslip \u6d41\u7a0b\u4e0d\u719f\u6089 \u6574\u5408\u56f0\u96e3 Day 3 \u524d\u5148\u7814\u7a76\u65e2\u6709\u7a0b\u5f0f\u78bc Device ID \u53d6\u5f97\u65b9\u5f0f Tooltip \u5132\u5b58\u908f\u8f2f \u78ba\u8a8d\u4f7f\u7528 <code>identifierForVendor</code>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#daily-standup-template","title":"\ud83d\udcdd Daily Standup Template","text":"<pre><code>### [\u65e5\u671f] Standup\n\n**\u6628\u5929\u5b8c\u6210:**\n- \n\n**\u4eca\u5929\u8a08\u5283:**\n- \n\n**\u963b\u585e:**\n- \u7121 / \u6709: [\u63cf\u8ff0]\n</code></pre>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#_2","title":"\ud83d\udd17 \u76f8\u95dc\u9023\u7d50","text":"<ul> <li>Epic: FOOTBALL-9161</li> <li>Figma: Code-Converter</li> <li>PRD: <code>PRDs/01_PRD/01_06/Fcom_PRD_Booking_Code_Converter_01_06_zh-TW.md</code></li> <li>API Doc: <code>Docs/API_Doc/Code_Converter_API_Doc.md</code></li> </ul>"},{"location":"12_Sprint%20Plan/01_5day_sprint_plan/#_3","title":"\ud83d\udccb \u8b8a\u66f4\u8a18\u9304","text":"\u65e5\u671f \u8b8a\u66f4\u5167\u5bb9 2025-01-14 BE \u65b0\u8a2d\u8a08\u66f4\u65b0\uff1a\u79fb\u9664 Bookie Selector\u3001Config API\uff1b\u7c21\u5316 Convert API\uff1b\u65b0\u589e Tooltip 2025-01-07 \u521d\u7248\u5efa\u7acb"}]}